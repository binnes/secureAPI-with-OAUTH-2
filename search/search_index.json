{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Authentication Test API","text":"<p>Welcome to the Authentication Test API documentation. This is a RESTful API server providing user schedule management with OAuth 2.0 authentication via Keycloak.</p>"},{"location":"#overview","title":"Overview","text":"<p>The Authentication Test API is a production-ready Java application built with:</p> <ul> <li>Java 21 - Modern Java features and performance</li> <li>OpenLiberty 24.0.0.1 - Lightweight, cloud-native application server</li> <li>Jakarta EE 10 - Enterprise Java standards</li> <li>MicroProfile 6.1 - Microservices-optimized APIs</li> <li>Keycloak OAuth 2.0 - Industry-standard authentication</li> </ul>"},{"location":"#key-features","title":"Key Features","text":"<p>\u2705 Health Check Endpoint - Public endpoint for monitoring server status \u2705 Secured Schedule API - JWT-protected user schedule management \u2705 Role-Based Access Control - Fine-grained authorization with Keycloak roles \u2705 OpenAPI 3.0 Documentation - Interactive API documentation with Swagger UI \u2705 Comprehensive Error Handling - Consistent error responses across all endpoints \u2705 Container Support - Ready for deployment with Podman or Docker \u2705 Production Ready - Logging, monitoring, and security best practices</p>"},{"location":"#quick-links","title":"Quick Links","text":"<ul> <li>Quick Start Guide - Get up and running in minutes</li> <li>Building with Maven - Build and package the application</li> <li>Keycloak Setup - Configure authentication</li> <li>SSL Certificates - Configure self-signed certificates</li> <li>Groups Mapper - Configure role-based authorization</li> <li>API Reference - Complete API documentation</li> <li>OpenAPI Export - Export spec for Orchestrate</li> <li>watsonx Orchestrate Setup - Set up IBM watsonx Orchestrate</li> <li>Troubleshooting - Solutions to common problems</li> </ul>"},{"location":"#architecture","title":"Architecture","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   Client    \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25b6\u2502  Authentication  \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25b6\u2502  Keycloak   \u2502\n\u2502 Application \u2502         \u2502    Test API      \u2502         \u2502   Server    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                               \u2502\n                               \u2502 JWT Validation\n                               \u2502\n                        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                        \u2502  Schedule   \u2502\n                        \u2502   Service   \u2502\n                        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"#api-endpoints","title":"API Endpoints","text":""},{"location":"#public-endpoints","title":"Public Endpoints","text":"<ul> <li><code>GET /api/v1/hello</code> - Health check and server information</li> </ul>"},{"location":"#protected-endpoints","title":"Protected Endpoints","text":"<ul> <li><code>GET /api/v1/schedule</code> - Retrieve user schedule (requires JWT token and <code>schedule-user</code> role)</li> </ul>"},{"location":"#technology-stack","title":"Technology Stack","text":"Component Technology Version Language Java 21+ Application Server OpenLiberty 24.0.0.1 Framework Jakarta EE 10 Microservices MicroProfile 6.1 Build Tool Maven 3.9+ Authentication Keycloak Latest Container Runtime Podman/Docker Latest"},{"location":"#getting-started","title":"Getting Started","text":"<p>To get started with the Authentication Test API:</p> <ol> <li>Check Prerequisites - Ensure you have the required tools</li> <li>Build the Application - Compile and package the API</li> <li>Configure SSL Certificates - Setup trust for self-signed certificates (if needed)</li> <li>Setup Keycloak - Configure authentication server</li> <li>Realm Configuration</li> <li>Client Configuration</li> <li>User Management</li> <li>Groups Claim Mapper</li> <li>Run the Server - Start the API server</li> <li>Test the API - Make your first API calls</li> </ol>"},{"location":"#support","title":"Support","text":"<p>For issues, questions, or contributions:</p> <ul> <li>\ud83d\udce7 Email: support@example.com</li> <li>\ud83d\udc1b Issues: GitHub Issues</li> <li>\ud83d\udcd6 Documentation: This site</li> </ul>"},{"location":"#license","title":"License","text":"<p>This project is licensed under the Apache License 2.0. See the LICENSE file for details.</p>"},{"location":"api/authentication/","title":"Authentication","text":"<p>Guide to authenticating with the Authentication Test API using OAuth 2.0 and JWT tokens.</p>"},{"location":"api/authentication/#overview","title":"Overview","text":"<p>The API uses OAuth 2.0 with JWT (JSON Web Tokens) for authentication via Keycloak.</p>"},{"location":"api/authentication/#getting-a-token","title":"Getting a Token","text":""},{"location":"api/authentication/#using-password-grant","title":"Using Password Grant","text":"<pre><code>curl -X POST http://localhost:8080/realms/secure-test/protocol/openid-connect/token \\\n  -H \"Content-Type: application/x-www-form-urlencoded\" \\\n  -d \"client_id=authentication-test-api\" \\\n  -d \"client_secret=YOUR_CLIENT_SECRET\" \\\n  -d \"grant_type=password\" \\\n  -d \"username=testuser1\" \\\n  -d \"password=password123\"\n</code></pre> <p>Response: <pre><code>{\n  \"access_token\": \"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9...\",\n  \"expires_in\": 300,\n  \"refresh_token\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\",\n  \"token_type\": \"Bearer\"\n}\n</code></pre></p>"},{"location":"api/authentication/#using-the-token","title":"Using the Token","text":"<p>Include the access token in the Authorization header:</p> <pre><code>curl http://localhost:9080/api/v1/schedule \\\n  -H \"Authorization: Bearer YOUR_ACCESS_TOKEN\"\n</code></pre>"},{"location":"api/authentication/#token-structure","title":"Token Structure","text":"<p>JWT tokens contain: - <code>sub</code>: User ID - <code>preferred_username</code>: Username - <code>realm_access.roles</code>: User roles - <code>exp</code>: Expiration time - <code>iss</code>: Issuer (Keycloak)</p>"},{"location":"api/authentication/#next-steps","title":"Next Steps","text":"<ul> <li>API Endpoints</li> <li>Keycloak Setup</li> </ul>"},{"location":"api/endpoints/","title":"API Endpoints","text":"<p>Complete reference for all Authentication Test API endpoints.</p>"},{"location":"api/endpoints/#base-url","title":"Base URL","text":"<pre><code>http://localhost:9080/api/v1\n</code></pre>"},{"location":"api/endpoints/#endpoints-overview","title":"Endpoints Overview","text":"Endpoint Method Auth Description <code>/hello</code> GET No Health check <code>/schedule</code> GET Yes User schedule"},{"location":"api/endpoints/#health-check-endpoint","title":"Health Check Endpoint","text":""},{"location":"api/endpoints/#get-apiv1hello","title":"GET /api/v1/hello","text":"<p>Public endpoint for health checks and server information.</p> <p>Authentication: None required</p> <p>Request: <pre><code>curl -X GET http://localhost:9080/api/v1/hello\n</code></pre></p> <p>Response (200 OK): <pre><code>{\n  \"hostname\": \"server-hostname.local\",\n  \"serverTime\": \"2026-01-28T10:30:00Z\",\n  \"apiVersion\": \"1.0.0\",\n  \"status\": \"healthy\"\n}\n</code></pre></p> <p>Response Fields: - <code>hostname</code> (string): Server hostname - <code>serverTime</code> (string): Current server time in ISO 8601 UTC format - <code>apiVersion</code> (string): API version - <code>status</code> (string): Server status</p>"},{"location":"api/endpoints/#schedule-endpoint","title":"Schedule Endpoint","text":""},{"location":"api/endpoints/#get-apiv1schedule","title":"GET /api/v1/schedule","text":"<p>Retrieve the authenticated user's schedule.</p> <p>Authentication: Required (Bearer JWT token) Authorization: Requires <code>schedule-user</code> role</p> <p>Request: <pre><code>curl -X GET http://localhost:9080/api/v1/schedule \\\n  -H \"Authorization: Bearer YOUR_JWT_TOKEN\"\n</code></pre></p> <p>Response (200 OK): <pre><code>{\n  \"user\": \"testuser1\",\n  \"schedule\": [\n    {\n      \"date\": \"2026-01-28\",\n      \"time\": \"09:00\",\n      \"description\": \"Team standup meeting\"\n    },\n    {\n      \"date\": \"2026-01-28\",\n      \"time\": \"14:30\",\n      \"description\": \"Code review session\"\n    },\n    {\n      \"date\": \"2026-01-29\",\n      \"time\": \"10:00\",\n      \"description\": \"Sprint planning\"\n    }\n  ]\n}\n</code></pre></p> <p>Response Fields: - <code>user</code> (string): Username from JWT token - <code>schedule</code> (array): Array of schedule items   - <code>date</code> (string): Date in ISO 8601 format (YYYY-MM-DD)   - <code>time</code> (string): Time in 24-hour format (HH:mm)   - <code>description</code> (string): Activity description</p> <p>Error Responses:</p> <p>401 Unauthorized: <pre><code>{\n  \"error\": \"UNAUTHORIZED\",\n  \"message\": \"Authentication required\",\n  \"timestamp\": \"2026-01-28T10:30:00Z\",\n  \"path\": \"/api/v1/schedule\"\n}\n</code></pre></p> <p>403 Forbidden: <pre><code>{\n  \"error\": \"FORBIDDEN\",\n  \"message\": \"Insufficient permissions. Required role: schedule-user\",\n  \"timestamp\": \"2026-01-28T10:30:00Z\",\n  \"path\": \"/api/v1/schedule\"\n}\n</code></pre></p>"},{"location":"api/endpoints/#testing-endpoints","title":"Testing Endpoints","text":""},{"location":"api/endpoints/#using-curl","title":"Using curl","text":"<pre><code># Health check\ncurl http://localhost:9080/api/v1/hello | jq\n\n# Get token\nTOKEN=$(curl -X POST http://localhost:8080/realms/secure-test/protocol/openid-connect/token \\\n  -H \"Content-Type: application/x-www-form-urlencoded\" \\\n  -d \"client_id=authentication-test-api\" \\\n  -d \"client_secret=YOUR_SECRET\" \\\n  -d \"grant_type=password\" \\\n  -d \"username=testuser1\" \\\n  -d \"password=password123\" \\\n  | jq -r '.access_token')\n\n# Call schedule endpoint\ncurl http://localhost:9080/api/v1/schedule \\\n  -H \"Authorization: Bearer $TOKEN\" | jq\n</code></pre>"},{"location":"api/endpoints/#next-steps","title":"Next Steps","text":"<ul> <li>Authentication Guide</li> <li>Error Handling</li> <li>OpenAPI Documentation</li> </ul>"},{"location":"api/errors/","title":"Error Handling","text":"<p>Standard error responses and codes for the Authentication Test API.</p>"},{"location":"api/errors/#error-response-format","title":"Error Response Format","text":"<p>All errors return a consistent JSON structure:</p> <pre><code>{\n  \"error\": \"ERROR_CODE\",\n  \"message\": \"Human-readable error message\",\n  \"timestamp\": \"2026-01-28T10:30:00Z\",\n  \"path\": \"/api/v1/schedule\"\n}\n</code></pre>"},{"location":"api/errors/#http-status-codes","title":"HTTP Status Codes","text":"Code Status Description 200 OK Successful request 400 Bad Request Invalid request format 401 Unauthorized Missing or invalid authentication 403 Forbidden Insufficient permissions 404 Not Found Resource not found 500 Internal Server Error Server error"},{"location":"api/errors/#error-codes","title":"Error Codes","text":""},{"location":"api/errors/#unauthorized-401","title":"UNAUTHORIZED (401)","text":"<p>Missing or invalid JWT token.</p> <pre><code>{\n  \"error\": \"UNAUTHORIZED\",\n  \"message\": \"Authentication required\",\n  \"timestamp\": \"2026-01-28T10:30:00Z\",\n  \"path\": \"/api/v1/schedule\"\n}\n</code></pre>"},{"location":"api/errors/#forbidden-403","title":"FORBIDDEN (403)","text":"<p>Valid token but insufficient permissions.</p> <pre><code>{\n  \"error\": \"FORBIDDEN\",\n  \"message\": \"Insufficient permissions. Required role: schedule-user\",\n  \"timestamp\": \"2026-01-28T10:30:00Z\",\n  \"path\": \"/api/v1/schedule\"\n}\n</code></pre>"},{"location":"api/errors/#internal_error-500","title":"INTERNAL_ERROR (500)","text":"<p>Unexpected server error.</p> <pre><code>{\n  \"error\": \"INTERNAL_ERROR\",\n  \"message\": \"An unexpected error occurred\",\n  \"timestamp\": \"2026-01-28T10:30:00Z\",\n  \"path\": \"/api/v1/schedule\"\n}\n</code></pre>"},{"location":"api/errors/#handling-errors","title":"Handling Errors","text":""},{"location":"api/errors/#in-client-applications","title":"In Client Applications","text":"<pre><code>fetch('http://localhost:9080/api/v1/schedule', {\n  headers: {\n    'Authorization': `Bearer ${token}`\n  }\n})\n.then(response =&gt; {\n  if (!response.ok) {\n    return response.json().then(error =&gt; {\n      throw new Error(error.message);\n    });\n  }\n  return response.json();\n})\n.catch(error =&gt; {\n  console.error('API Error:', error.message);\n});\n</code></pre>"},{"location":"api/errors/#next-steps","title":"Next Steps","text":"<ul> <li>API Endpoints</li> <li>Troubleshooting</li> </ul>"},{"location":"api/openapi/","title":"OpenAPI Documentation","text":"<p>Interactive API documentation using OpenAPI 3.0 and Swagger UI.</p>"},{"location":"api/openapi/#accessing-openapi-documentation","title":"Accessing OpenAPI Documentation","text":"<p>Once the server is running, access the interactive documentation:</p>"},{"location":"api/openapi/#swagger-ui","title":"Swagger UI","text":"<p>Interactive API explorer with try-it-out functionality:</p> <pre><code>http://localhost:9080/openapi/ui\n</code></pre>"},{"location":"api/openapi/#openapi-specification","title":"OpenAPI Specification","text":"<p>Raw OpenAPI 3.0 specification in JSON format:</p> <pre><code>http://localhost:9080/openapi\n</code></pre>"},{"location":"api/openapi/#exporting-the-openapi-specification","title":"Exporting the OpenAPI Specification","text":"<p>To add this API to Orchestrate or other tools, you need to export the OpenAPI specification file.</p> curlwgetBrowserSwagger UIAutomated Script <p>Download the spec using curl (recommended):</p> <pre><code>curl http://localhost:9080/openapi -o openapi.json\n</code></pre> <p>This creates an <code>openapi.json</code> file in your current directory.</p> <p>Download using wget:</p> <pre><code>wget http://localhost:9080/openapi -O openapi.json\n</code></pre> <p>Download via web browser:</p> <ol> <li>Start the server: <code>mvn liberty:dev</code></li> <li>Open your browser to: <code>http://localhost:9080/openapi</code></li> <li>Right-click and select \"Save Page As...\"</li> <li>Save as <code>openapi.json</code></li> </ol> <p>Export from Swagger UI:</p> <ol> <li>Navigate to <code>http://localhost:9080/openapi/ui</code></li> <li>Look for the OpenAPI spec link at the top of the page</li> <li>Right-click and \"Save Link As...\"</li> <li>Save as <code>openapi.json</code></li> </ol> <p>Create a script to export automatically:</p> <pre><code>#!/bin/bash\n# export-openapi.sh\n\n# Wait for server to be ready\necho \"Waiting for server to start...\"\nuntil curl -s http://localhost:9080/openapi &gt; /dev/null; do\n    sleep 2\ndone\n\n# Export the spec\necho \"Exporting OpenAPI specification...\"\ncurl http://localhost:9080/openapi -o openapi.json\n\necho \"OpenAPI spec exported to openapi.json\"\n</code></pre> <p>Make it executable and run:</p> <pre><code>chmod +x export-openapi.sh\n./export-openapi.sh\n</code></pre>"},{"location":"api/openapi/#verify-the-export","title":"Verify the Export","text":"<p>Check that the file contains valid JSON:</p> <pre><code>cat openapi.json | jq '.'\n</code></pre> <p>Or view the OpenAPI version:</p> <pre><code>cat openapi.json | jq '.openapi'\n</code></pre> <p>Expected output: <code>\"3.0.3\"</code> or similar.</p>"},{"location":"api/openapi/#using-the-spec-with-orchestrate","title":"Using the Spec with Orchestrate","text":"<p>Once exported, you can:</p> <ol> <li>Import to Orchestrate - Use the <code>openapi.json</code> file to register your API</li> <li>Version Control - Commit the spec to your repository for tracking changes</li> <li>API Documentation - Share with team members or external consumers</li> <li>Code Generation - Use tools like OpenAPI Generator to create client SDKs</li> </ol>"},{"location":"api/openapi/#using-swagger-ui","title":"Using Swagger UI","text":"<ol> <li>Open Swagger UI at <code>http://localhost:9080/openapi/ui</code></li> <li>Explore Endpoints - Click on any endpoint to see details</li> <li>Try It Out - Click \"Try it out\" button</li> <li>Authenticate - Click \"Authorize\" and enter your JWT token</li> <li>Execute - Fill in parameters and click \"Execute\"</li> </ol>"},{"location":"api/openapi/#authentication-in-swagger-ui","title":"Authentication in Swagger UI","text":"<ol> <li>Click the \"Authorize\" button (lock icon)</li> <li>Enter your JWT token in the format: <code>Bearer YOUR_TOKEN</code></li> <li>Click \"Authorize\"</li> <li>Click \"Close\"</li> </ol> <p>Now you can test protected endpoints.</p>"},{"location":"api/openapi/#getting-a-token-for-testing","title":"Getting a Token for Testing","text":"<pre><code>curl -X POST http://localhost:8080/realms/secure-test/protocol/openid-connect/token \\\n  -H \"Content-Type: application/x-www-form-urlencoded\" \\\n  -d \"client_id=authentication-test-api\" \\\n  -d \"client_secret=YOUR_SECRET\" \\\n  -d \"grant_type=password\" \\\n  -d \"username=testuser1\" \\\n  -d \"password=password123\" \\\n  | jq -r '.access_token'\n</code></pre> <p>Copy the token and use it in Swagger UI.</p>"},{"location":"api/openapi/#openapi-annotations","title":"OpenAPI Annotations","text":"<p>The API uses MicroProfile OpenAPI annotations for documentation:</p> <pre><code>@Operation(\n    summary = \"Get user schedule\",\n    description = \"Retrieve the authenticated user's schedule\"\n)\n@APIResponses({\n    @APIResponse(\n        responseCode = \"200\",\n        description = \"Schedule retrieved successfully\"\n    )\n})\n</code></pre>"},{"location":"api/openapi/#next-steps","title":"Next Steps","text":"<ul> <li>API Endpoints</li> <li>Authentication</li> </ul>"},{"location":"architecture/oauth-flows/","title":"OAuth 2.0 Authentication Flows","text":""},{"location":"architecture/oauth-flows/#overview","title":"Overview","text":"<p>This project implements a comprehensive OAuth 2.0 authentication architecture using Keycloak as the Identity Provider (IdP). The system supports two distinct authentication flows:</p> <ol> <li>Frontend Authentication - Authorization Code Flow for user login</li> <li>API Server Authentication - JWT Bearer Token validation for API access</li> </ol> <p>Both flows work together to provide secure, user-specific access to resources while maintaining proper separation of concerns.</p>"},{"location":"architecture/oauth-flows/#system-architecture","title":"System Architecture","text":"<pre><code>graph TB\n    subgraph \"User Layer\"\n        User[User Browser]\n    end\n\n    subgraph \"Frontend Layer\"\n        Frontend[Next.js Frontend&lt;br/&gt;Port: 3000]\n        NextAuth[NextAuth.js&lt;br/&gt;Session Management]\n        Widget[Orchestrate Widget&lt;br/&gt;Embedded]\n    end\n\n    subgraph \"Identity Provider\"\n        Keycloak[Keycloak OAuth Server&lt;br/&gt;Realm: secure-test]\n        TokenExchange[OAuth Token Exchange&lt;br/&gt;/protocol/openid-connect/token]\n        FrontendClient[Frontend Client&lt;br/&gt;authentication-test-frontend]\n        APIClient[API Client&lt;br/&gt;authentication-test-api]\n    end\n\n    subgraph \"Backend Layer\"\n        APIServer[Java/Liberty API Server&lt;br/&gt;Port: 9080]\n        ScheduleService[Schedule Service]\n    end\n\n    subgraph \"AI Layer - Orchestrate Handles Token Exchange\"\n        Orchestrate[watsonx Orchestrate&lt;br/&gt;Port: 8080]\n        Agent[Schedule Agent]\n        OBOLogic[OAuth OBO Logic&lt;br/&gt;Built-in]\n    end\n\n    User --&gt;|1. Login Request| Frontend\n    Frontend --&gt;|2. OAuth Redirect| Keycloak\n    Keycloak --&gt;|3. Auth Code| Frontend\n    Frontend --&gt;|4. Exchange Code for Token| Keycloak\n    Keycloak --&gt;|5. Frontend Access Token| NextAuth\n\n    User --&gt;|6. Query via Widget| Widget\n    Widget --&gt;|7. Send Query + User Token| Orchestrate\n    Orchestrate --&gt;|8. Token Exchange Request&lt;br/&gt;OBO Flow| TokenExchange\n    TokenExchange --&gt;|9. API Access Token| Orchestrate\n    Orchestrate --&gt;|10. API Call + API Token| APIServer\n    APIServer --&gt;|11. Validate JWT| Keycloak\n    APIServer --&gt;|12. Query Data| ScheduleService\n    ScheduleService --&gt;|13. Return Data| APIServer\n    APIServer --&gt;|14. User Schedule| Orchestrate\n    Orchestrate --&gt;|15. Format Response| Agent\n    Agent --&gt;|16. Natural Language| Orchestrate\n    Orchestrate --&gt;|17. Response| Widget\n    Widget --&gt;|18. Display| User\n\n    FrontendClient -.-&gt;|Manages| Frontend\n    APIClient -.-&gt;|Validates| APIServer\n    OBOLogic -.-&gt;|Part of| Orchestrate</code></pre>"},{"location":"architecture/oauth-flows/#keycloaks-role","title":"Keycloak's Role","text":"<p>Keycloak serves as the central Identity Provider (IdP) and Authorization Server for the entire system. It provides:</p>"},{"location":"architecture/oauth-flows/#core-functions","title":"Core Functions","text":"<ol> <li>User Authentication</li> <li>Validates user credentials</li> <li>Issues access tokens and refresh tokens</li> <li> <p>Manages user sessions</p> </li> <li> <p>Token Issuance</p> </li> <li>Generates JWT tokens with user claims</li> <li>Signs tokens with RSA keys</li> <li> <p>Includes user roles and groups</p> </li> <li> <p>Token Validation</p> </li> <li>Provides JWKS endpoint for public key distribution</li> <li>Validates token signatures</li> <li> <p>Verifies token expiration and audience</p> </li> <li> <p>Client Management</p> </li> <li>Manages multiple OAuth clients (frontend, API)</li> <li>Enforces client-specific security policies</li> <li> <p>Controls redirect URIs and scopes</p> </li> <li> <p>User Management</p> </li> <li>Stores user credentials securely</li> <li>Manages user roles and groups</li> <li>Provides user profile information</li> </ol>"},{"location":"architecture/oauth-flows/#keycloak-configuration","title":"Keycloak Configuration","text":"<p>Realm: <code>secure-test</code></p> <p>Clients: - <code>authentication-test-frontend</code> - Public client for web application - <code>authentication-test-api</code> - Confidential client for API server</p> <p>Key Endpoints: - Authorization: <code>https://keycloak.otterburn.home/realms/secure-test/protocol/openid-connect/auth</code> - Token: <code>https://keycloak.otterburn.home/realms/secure-test/protocol/openid-connect/token</code> - JWKS: <code>https://keycloak.otterburn.home/realms/secure-test/protocol/openid-connect/certs</code> - UserInfo: <code>https://keycloak.otterburn.home/realms/secure-test/protocol/openid-connect/userinfo</code></p>"},{"location":"architecture/oauth-flows/#flow-1-frontend-user-authentication","title":"Flow 1: Frontend User Authentication","text":""},{"location":"architecture/oauth-flows/#authorization-code-flow-oauth-20","title":"Authorization Code Flow (OAuth 2.0)","text":"<p>The frontend uses the Authorization Code Flow, which is the most secure OAuth 2.0 flow for web applications.</p> <pre><code>sequenceDiagram\n    participant User\n    participant Browser\n    participant Frontend as Next.js Frontend\n    participant NextAuth as NextAuth.js\n    participant Keycloak\n\n    User-&gt;&gt;Browser: Click \"Sign In\"\n    Browser-&gt;&gt;Frontend: Initiate login\n    Frontend-&gt;&gt;NextAuth: signIn('keycloak')\n\n    Note over NextAuth,Keycloak: Step 1: Authorization Request\n    NextAuth-&gt;&gt;Keycloak: Redirect to /auth&lt;br/&gt;client_id=authentication-test-frontend&lt;br/&gt;response_type=code&lt;br/&gt;scope=openid email profile&lt;br/&gt;redirect_uri=callback URL\n\n    Note over User,Keycloak: Step 2: User Authentication\n    Keycloak-&gt;&gt;User: Display login page\n    User-&gt;&gt;Keycloak: Enter credentials\n    Keycloak-&gt;&gt;Keycloak: Validate credentials\n\n    Note over Keycloak,Browser: Step 3: Authorization Code\n    Keycloak-&gt;&gt;Browser: Redirect with auth code&lt;br/&gt;code=abc123...\n    Browser-&gt;&gt;NextAuth: Callback with code\n\n    Note over NextAuth,Keycloak: Step 4: Token Exchange\n    NextAuth-&gt;&gt;Keycloak: POST /token&lt;br/&gt;grant_type=authorization_code&lt;br/&gt;code=abc123...&lt;br/&gt;client_id + client_secret\n\n    Keycloak-&gt;&gt;Keycloak: Validate code &amp; client\n    Keycloak-&gt;&gt;NextAuth: Return tokens&lt;br/&gt;access_token&lt;br/&gt;refresh_token&lt;br/&gt;id_token\n\n    Note over NextAuth,Frontend: Step 5: Session Creation\n    NextAuth-&gt;&gt;NextAuth: Create encrypted session\n    NextAuth-&gt;&gt;Browser: Set session cookie (HTTP-only)\n    Browser-&gt;&gt;User: Redirect to app (logged in)</code></pre>"},{"location":"architecture/oauth-flows/#token-structure","title":"Token Structure","text":"<p>Access Token (JWT): <pre><code>{\n  \"exp\": 1706659200,\n  \"iat\": 1706655600,\n  \"jti\": \"a1b2c3d4-e5f6-7890-abcd-ef1234567890\",\n  \"iss\": \"https://keycloak.otterburn.home/realms/secure-test\",\n  \"aud\": \"authentication-test-frontend\",\n  \"sub\": \"f47ac10b-58cc-4372-a567-0e02b2c3d479\",\n  \"typ\": \"Bearer\",\n  \"azp\": \"authentication-test-frontend\",\n  \"session_state\": \"12345678-90ab-cdef-1234-567890abcdef\",\n  \"scope\": \"openid email profile\",\n  \"email_verified\": true,\n  \"name\": \"Test User 2\",\n  \"preferred_username\": \"testuser2\",\n  \"given_name\": \"Test\",\n  \"family_name\": \"User\",\n  \"email\": \"testuser2@example.com\"\n}\n</code></pre></p>"},{"location":"architecture/oauth-flows/#token-refresh-flow","title":"Token Refresh Flow","text":"<p>When the access token expires, NextAuth automatically refreshes it:</p> <pre><code>sequenceDiagram\n    participant Frontend\n    participant NextAuth\n    participant Keycloak\n\n    Frontend-&gt;&gt;NextAuth: Request with expired token\n    NextAuth-&gt;&gt;NextAuth: Detect token expiration\n\n    Note over NextAuth,Keycloak: Automatic Refresh\n    NextAuth-&gt;&gt;Keycloak: POST /token&lt;br/&gt;grant_type=refresh_token&lt;br/&gt;refresh_token=xyz789...&lt;br/&gt;client_id + client_secret\n\n    Keycloak-&gt;&gt;Keycloak: Validate refresh token\n    Keycloak-&gt;&gt;NextAuth: New tokens&lt;br/&gt;access_token (new)&lt;br/&gt;refresh_token (new)\n\n    NextAuth-&gt;&gt;NextAuth: Update session\n    NextAuth-&gt;&gt;Frontend: Continue with new token</code></pre> <p>Implementation (<code>Frontend/lib/auth.ts</code>): <pre><code>async function refreshAccessToken(token: ExtendedJWT): Promise&lt;ExtendedJWT&gt; {\n  const url = `${process.env.KEYCLOAK_ISSUER}/protocol/openid-connect/token`;\n\n  const response = await fetch(url, {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/x-www-form-urlencoded\" },\n    body: new URLSearchParams({\n      client_id: process.env.KEYCLOAK_CLIENT_ID!,\n      client_secret: process.env.KEYCLOAK_CLIENT_SECRET!,\n      grant_type: \"refresh_token\",\n      refresh_token: token.refreshToken!,\n    }),\n  });\n\n  const refreshedTokens = await response.json();\n\n  return {\n    ...token,\n    accessToken: refreshedTokens.access_token,\n    accessTokenExpires: Date.now() + refreshedTokens.expires_in * 1000,\n    refreshToken: refreshedTokens.refresh_token ?? token.refreshToken,\n  };\n}\n</code></pre></p>"},{"location":"architecture/oauth-flows/#flow-2-api-server-authentication","title":"Flow 2: API Server Authentication","text":""},{"location":"architecture/oauth-flows/#jwt-bearer-token-validation","title":"JWT Bearer Token Validation","text":"<p>The API server validates JWT tokens issued by Keycloak using the MicroProfile JWT specification.</p> <pre><code>sequenceDiagram\n    participant Client as Client/Orchestrate\n    participant API as API Server&lt;br/&gt;(Liberty)\n    participant MPJwt as MicroProfile JWT\n    participant Keycloak\n\n    Note over Client,API: Step 1: API Request\n    Client-&gt;&gt;API: GET /api/v1/schedule&lt;br/&gt;Authorization: Bearer &lt;JWT&gt;\n\n    Note over API,MPJwt: Step 2: Token Extraction\n    API-&gt;&gt;MPJwt: Extract JWT from header\n    MPJwt-&gt;&gt;MPJwt: Parse JWT\n\n    Note over MPJwt,Keycloak: Step 3: Key Retrieval (cached)\n    MPJwt-&gt;&gt;Keycloak: GET /certs (JWKS endpoint)\n    Keycloak-&gt;&gt;MPJwt: Return public keys\n\n    Note over MPJwt: Step 4: Token Validation\n    MPJwt-&gt;&gt;MPJwt: Verify signature with public key\n    MPJwt-&gt;&gt;MPJwt: Check expiration (exp claim)\n    MPJwt-&gt;&gt;MPJwt: Verify issuer (iss claim)\n    MPJwt-&gt;&gt;MPJwt: Verify audience (aud claim)\n\n    alt Token Valid\n        MPJwt-&gt;&gt;API: Token valid&lt;br/&gt;Extract claims (username, roles)\n        API-&gt;&gt;API: Check authorization (roles)\n        API-&gt;&gt;API: Process request\n        API-&gt;&gt;Client: 200 OK + Response data\n    else Token Invalid\n        MPJwt-&gt;&gt;API: Token invalid\n        API-&gt;&gt;Client: 401 Unauthorized\n    end</code></pre>"},{"location":"architecture/oauth-flows/#api-server-configuration","title":"API Server Configuration","text":"<p>Liberty server.xml (<code>API_server/src/main/liberty/config/server.xml</code>): <pre><code>&lt;mpJwt id=\"jwtConfig\"\n       jwksUri=\"${env.JWT_JWKS_URI}\"\n       issuer=\"${env.JWT_ISSUER}\"\n       audiences=\"authentication-test-api\"\n       groupNameAttribute=\"groups\"\n       userNameAttribute=\"preferred_username\"\n       sslRef=\"jwtSSLConfig\"/&gt;\n</code></pre></p> <p>Environment Variables: <pre><code>JWT_JWKS_URI=https://keycloak.otterburn.home/realms/secure-test/protocol/openid-connect/certs\nJWT_ISSUER=https://keycloak.otterburn.home/realms/secure-test\n</code></pre></p>"},{"location":"architecture/oauth-flows/#token-validation-process","title":"Token Validation Process","text":"<ol> <li>Signature Verification</li> <li>API server fetches public keys from Keycloak JWKS endpoint</li> <li>Verifies JWT signature using RSA public key</li> <li> <p>Ensures token hasn't been tampered with</p> </li> <li> <p>Claims Validation</p> </li> <li>Issuer (<code>iss</code>): Must match configured Keycloak realm</li> <li>Audience (<code>aud</code>): Must be <code>authentication-test-api</code></li> <li>Expiration (<code>exp</code>): Token must not be expired</li> <li> <p>Not Before (<code>nbf</code>): Token must be valid now</p> </li> <li> <p>User Context Extraction</p> </li> <li>Username: From <code>preferred_username</code> claim</li> <li>Roles: From <code>groups</code> claim</li> <li>User ID: From <code>sub</code> claim</li> </ol>"},{"location":"architecture/oauth-flows/#flow-3-oauth-on-behalf-of-obo-token-exchange","title":"Flow 3: OAuth On-Behalf-Of (OBO) Token Exchange","text":""},{"location":"architecture/oauth-flows/#orchestrate-sso-integration","title":"Orchestrate SSO Integration","text":"<p>When watsonx Orchestrate needs to call the API on behalf of the authenticated user, it uses the OAuth 2.0 On-Behalf-Of (OBO) flow with token exchange. This is similar to how Workday and other enterprise systems implement SSO.</p> <p>Key Concept: Orchestrate obtains the user's frontend authentication token from the widget session, then directly calls Keycloak's OAuth token exchange endpoint to exchange the frontend token for an API-specific token. The frontend is not involved in the token exchange process.</p> <pre><code>sequenceDiagram\n    participant User\n    participant Widget as Orchestrate Widget&lt;br/&gt;(Embedded in Frontend)\n    participant Frontend as Frontend App&lt;br/&gt;(Next.js)\n    participant Orchestrate as Orchestrate Server&lt;br/&gt;(AI Layer)\n    participant Keycloak as Keycloak&lt;br/&gt;OAuth Token Exchange\n    participant API as API Server&lt;br/&gt;(Java/Liberty)\n\n    Note over User,Widget: Step 1: User Interaction\n    User-&gt;&gt;Widget: \"What's on my schedule?\"\n    Widget-&gt;&gt;Orchestrate: Send query + user's frontend token\n\n    Note over Orchestrate: Step 2: Orchestrate Initiates OBO Flow\n    Orchestrate-&gt;&gt;Orchestrate: Detect SSO connection configured\n    Orchestrate-&gt;&gt;Orchestrate: Extract user's frontend token\n\n    Note over Orchestrate,Keycloak: Step 3: Token Exchange at Keycloak (OBO)\n    Orchestrate-&gt;&gt;Keycloak: POST /protocol/openid-connect/token&lt;br/&gt;grant_type=urn:ietf:params:oauth:grant-type:token-exchange&lt;br/&gt;subject_token=&lt;frontend_token&gt;&lt;br/&gt;requested_token_type=access_token&lt;br/&gt;audience=authentication-test-api\n    Keycloak-&gt;&gt;Keycloak: Validate frontend token\n    Keycloak-&gt;&gt;Keycloak: Generate API token for user\n    Keycloak-&gt;&gt;Orchestrate: Return API access token\n\n    Note over Orchestrate: Step 4: Agent Processing\n    Orchestrate-&gt;&gt;Orchestrate: Invoke schedule_assistant agent\n    Orchestrate-&gt;&gt;Orchestrate: Agent calls get_user_schedule tool\n\n    Note over Orchestrate,API: Step 5: API Call with API Token\n    Orchestrate-&gt;&gt;API: GET /api/v1/schedule&lt;br/&gt;Authorization: Bearer &lt;api_token&gt;\n\n    Note over API,Keycloak: Step 6: Token Validation\n    API-&gt;&gt;Keycloak: Validate JWT (JWKS)\n    Keycloak-&gt;&gt;API: Token valid for user\n\n    Note over API: Step 7: User-Specific Authorization\n    API-&gt;&gt;API: Extract username from JWT\n    API-&gt;&gt;API: Check schedule-user role\n    API-&gt;&gt;API: Retrieve user's schedule\n\n    API-&gt;&gt;Orchestrate: 200 OK + User's schedule data\n    Orchestrate-&gt;&gt;Orchestrate: Format natural language response\n    Orchestrate-&gt;&gt;Widget: Return formatted response\n    Widget-&gt;&gt;User: Display personalized schedule</code></pre>"},{"location":"architecture/oauth-flows/#how-oauth-on-behalf-of-works","title":"How OAuth On-Behalf-Of Works","text":"<p>The OBO flow enables Orchestrate to act on behalf of the authenticated user without requiring the user to re-authenticate:</p> <ol> <li>User Authentication: User logs into the frontend via Keycloak (Authorization Code Flow)</li> <li>Session Establishment: Frontend stores user's access token in encrypted session</li> <li>Widget Embedding: Orchestrate widget is embedded in the frontend with user's session context</li> <li>Token Acquisition: Widget passes user's frontend token to Orchestrate</li> <li>Token Exchange at Keycloak: When Orchestrate needs to call the API:</li> <li>Orchestrate extracts the user's frontend token</li> <li>Orchestrate calls Keycloak's token exchange endpoint directly</li> <li>Keycloak validates the frontend token</li> <li>Keycloak issues a new API-specific token for the same user</li> <li>Orchestrate receives the API token</li> <li>API Authorization: Orchestrate calls API with the exchanged token, API validates and returns user-specific data</li> </ol> <p>Security Benefits: - \u2705 User never shares credentials with Orchestrate - \u2705 Token is scoped to the authenticated user - \u2705 API sees the actual user identity (not a service account) - \u2705 Audit trail shows real user actions - \u2705 Token has limited lifetime (expires with session) - \u2705 Frontend is not involved in token exchange (separation of concerns) - \u2705 Keycloak controls token exchange policy centrally</p>"},{"location":"architecture/oauth-flows/#keycloak-token-exchange","title":"Keycloak Token Exchange","text":"<p>Orchestrate calls Keycloak's OAuth 2.0 Token Exchange endpoint (RFC 8693):</p> <p>Token Exchange Request: <pre><code>POST /realms/secure-test/protocol/openid-connect/token\nContent-Type: application/x-www-form-urlencoded\n\ngrant_type=urn:ietf:params:oauth:grant-type:token-exchange\n&amp;client_id=authentication-test-api\n&amp;client_secret=&lt;api_client_secret&gt;\n&amp;subject_token=&lt;user_frontend_token&gt;\n&amp;subject_token_type=urn:ietf:params:oauth:token-type:access_token\n&amp;requested_token_type=urn:ietf:params:oauth:token-type:access_token\n&amp;audience=authentication-test-api\n</code></pre></p> <p>Token Exchange Response: <pre><code>{\n  \"access_token\": \"eyJhbGc...\",\n  \"issued_token_type\": \"urn:ietf:params:oauth:token-type:access_token\",\n  \"token_type\": \"Bearer\",\n  \"expires_in\": 3600\n}\n</code></pre></p> <p>The exchanged token: - Has the same user identity (<code>sub</code>, <code>preferred_username</code>) - Has audience <code>authentication-test-api</code> (not <code>authentication-test-frontend</code>) - Can be validated by the API server - Maintains user's roles and permissions</p>"},{"location":"architecture/oauth-flows/#orchestrate-connection-configuration","title":"Orchestrate Connection Configuration","text":"<p>The connection configuration consists of two parts:</p>"},{"location":"architecture/oauth-flows/#1-connection-yaml-file","title":"1. Connection YAML File","text":"<p>Connection YAML (<code>orchestrate/schedule-api-connection.yaml</code>):</p> <pre><code>spec_version: v1\nkind: connection\napp_id: schedule-api-connection\nenvironments:\n  draft:\n    kind: oauth_auth_on_behalf_of_flow\n    type: member\n    sso: true  # Enables On-Behalf-Of flow\n    server_url: http://localhost:9080  # API server endpoint\n    idp_config:\n      header:\n        content-type: application/x-www-form-urlencoded\n      body:\n        requested_token_use: on_behalf_of\n        requested_token_type: urn:ietf:params:oauth:token-type:access_token\n    app_config:\n      header:\n        content-type: application/json\n</code></pre> <p>Key Configuration Parameters: - <code>kind: oauth_auth_on_behalf_of_flow</code> - Specifies OAuth On-Behalf-Of flow (matches Workday SSO pattern) - <code>sso: true</code> - Enables SSO/On-Behalf-Of mode - <code>type: member</code> - Connection is per-user (not shared) - <code>server_url</code> - The API server endpoint (where Orchestrate sends requests with the exchanged token) - <code>idp_config</code> - Configuration for token exchange request format:   - <code>requested_token_use: on_behalf_of</code> - Specifies OBO token exchange   - <code>requested_token_type</code> - Type of token requested (access_token for JWT) - <code>app_config</code> - Configuration for API server requests</p>"},{"location":"architecture/oauth-flows/#2-identity-provider-configuration","title":"2. Identity Provider Configuration","text":"<p>The token exchange server URL and credentials are configured separately using the <code>set-identity-provider</code> CLI command:</p> <pre><code>orchestrate connections set-identity-provider \\\n  --app-id schedule-api-connection \\\n  --env draft \\\n  --url https://keycloak.otterburn.home/realms/secure-test/protocol/openid-connect/token \\\n  --client-id authentication-test-api \\\n  --client-secret 8u50V7iXkuibA4BvzKVoDcQ5aaAbUsTI \\\n  --scope openid \\\n  --grant-type urn:ietf:params:oauth:grant-type:jwt-bearer\n</code></pre> <p>Identity Provider Parameters: - <code>--url</code> - The Keycloak token exchange endpoint (where Orchestrate exchanges tokens) - <code>--client-id</code> - The API client ID in Keycloak (used to authenticate Orchestrate to Keycloak) - <code>--client-secret</code> - The API client secret - <code>--scope</code> - OAuth scopes to request - <code>--grant-type</code> - The grant type for token exchange (JWT bearer for RFC 8693)</p> <p>Important: The <code>idp_config.body</code> parameters in the YAML file are merged with the identity provider configuration to form the complete token exchange request.</p>"},{"location":"architecture/oauth-flows/#understanding-the-two-urls","title":"Understanding the Two URLs","text":"<p>The OAuth On-Behalf-Of flow involves two different server URLs:</p> <ol> <li>Token Exchange Server URL (Identity Provider)</li> <li>Configured via: <code>set-identity-provider --url</code></li> <li>Purpose: Where Orchestrate exchanges the frontend token for an API token</li> <li>Example: <code>https://keycloak.otterburn.home/realms/secure-test/protocol/openid-connect/token</code></li> <li>Used for: OAuth token exchange (RFC 8693)</li> <li> <p>Authentication: Orchestrate authenticates using <code>client_id</code> and <code>client_secret</code></p> </li> <li> <p>API Server URL (Application)</p> </li> <li>Configured via: Connection YAML <code>server_url</code></li> <li>Purpose: Where Orchestrate makes API calls with the exchanged token</li> <li>Example: <code>http://localhost:9080</code></li> <li>Used for: Actual API requests (GET /api/v1/schedule)</li> <li>Authentication: Bearer token (the exchanged API token)</li> </ol> <p>Flow Summary: <pre><code>User Token \u2192 [Token Exchange Server] \u2192 API Token \u2192 [API Server] \u2192 User Data\n            (Keycloak)                            (Java/Liberty)\n</code></pre></p>"},{"location":"architecture/oauth-flows/#token-flow-comparison","title":"Token Flow Comparison","text":"Aspect Without OBO With OBO (SSO) Token Owner Service account Actual user Authentication Orchestrate credentials User's session API Identity Generic service Specific user Audit Trail Shows \"orchestrate\" Shows \"testuser2\" Data Access All users' data User's own data Security Shared credentials Per-user tokens"},{"location":"architecture/oauth-flows/#why-this-matters","title":"Why This Matters","text":"<p>Without OBO: Orchestrate would need its own service account credentials, and the API would see all requests as coming from \"orchestrate-service\", making it impossible to return user-specific data.</p> <p>With OBO: Orchestrate acts on behalf of the authenticated user, so the API sees requests from \"testuser2\" and can return that user's specific schedule.</p>"},{"location":"architecture/oauth-flows/#security-considerations","title":"Security Considerations","text":""},{"location":"architecture/oauth-flows/#token-storage","title":"Token Storage","text":"Location Storage Method Security Level Frontend HTTP-only encrypted cookie \u2705 High - Not accessible to JavaScript API Server Not stored (validated per request) \u2705 High - Stateless validation Orchestrate Temporary (request scope only) \u2705 High - No persistence"},{"location":"architecture/oauth-flows/#token-transmission","title":"Token Transmission","text":"<ul> <li>\u2705 HTTPS in Production: All token transmission over TLS</li> <li>\u2705 Authorization Header: Tokens sent in standard Bearer format</li> <li>\u2705 No URL Parameters: Tokens never in query strings</li> <li>\u2705 No Logging: Tokens excluded from application logs</li> </ul>"},{"location":"architecture/oauth-flows/#token-validation","title":"Token Validation","text":"<pre><code>graph TD\n    A[Receive JWT Token] --&gt; B{Extract Token}\n    B --&gt; C{Parse JWT}\n    C --&gt; D{Verify Signature}\n    D --&gt;|Invalid| E[401 Unauthorized]\n    D --&gt;|Valid| F{Check Expiration}\n    F --&gt;|Expired| E\n    F --&gt;|Valid| G{Verify Issuer}\n    G --&gt;|Wrong Issuer| E\n    G --&gt;|Correct| H{Verify Audience}\n    H --&gt;|Wrong Audience| E\n    H --&gt;|Correct| I{Check Roles}\n    I --&gt;|Missing Role| J[403 Forbidden]\n    I --&gt;|Has Role| K[Process Request]</code></pre>"},{"location":"architecture/oauth-flows/#client-separation","title":"Client Separation","text":"<p>The system uses two separate OAuth clients for security:</p> Client Purpose Grant Type Token Audience <code>authentication-test-frontend</code> User login Authorization Code <code>authentication-test-frontend</code> <code>authentication-test-api</code> API validation N/A (validates only) <code>authentication-test-api</code> <p>Why Separate Clients?</p> <ol> <li>Principle of Least Privilege: Each client has only the permissions it needs</li> <li>Audit Trail: Clear separation of frontend vs API access</li> <li>Token Scope Control: Different scopes for different purposes</li> <li>Security Isolation: Compromise of one doesn't affect the other</li> </ol>"},{"location":"architecture/oauth-flows/#audience-validation","title":"Audience Validation","text":"<p>Important: The API server validates the token audience claim:</p> <pre><code>&lt;mpJwt audiences=\"authentication-test-api\" /&gt;\n</code></pre> <p>Current Limitation: Frontend tokens have audience <code>authentication-test-frontend</code>, which causes validation to fail at the API server.</p> <p>Solutions:</p> <ol> <li>Token Exchange (Recommended): Use the token exchange endpoint to get API-specific tokens</li> <li>Multi-Audience: Configure Keycloak to include both audiences in tokens</li> <li>Audience Mapper: Add custom Keycloak mapper to include API audience</li> </ol>"},{"location":"architecture/oauth-flows/#token-lifecycle","title":"Token Lifecycle","text":""},{"location":"architecture/oauth-flows/#complete-token-journey","title":"Complete Token Journey","text":"<pre><code>stateDiagram-v2\n    [*] --&gt; UserLogin: User clicks Sign In\n    UserLogin --&gt; AuthCode: Keycloak authenticates\n    AuthCode --&gt; FrontendToken: NextAuth exchanges code\n    FrontendToken --&gt; SessionCookie: Store in encrypted cookie\n\n    SessionCookie --&gt; TokenValid: User makes request\n    TokenValid --&gt; TokenExpired: Time passes\n    TokenExpired --&gt; RefreshToken: Auto-refresh\n    RefreshToken --&gt; SessionCookie: Update session\n\n    SessionCookie --&gt; TokenExchange: Orchestrate needs API access\n    TokenExchange --&gt; APICall: Pass token to API\n    APICall --&gt; JWTValidation: API validates token\n    JWTValidation --&gt; UserData: Return user-specific data\n\n    SessionCookie --&gt; Logout: User signs out\n    Logout --&gt; [*]: Clear session</code></pre>"},{"location":"architecture/oauth-flows/#token-expiration-times","title":"Token Expiration Times","text":"Token Type Typical Lifetime Renewable? Access Token 1 hour (3600s) \u2705 Yes (via refresh token) Refresh Token 30 minutes (1800s) \u2705 Yes (sliding window) ID Token 1 hour (3600s) \u274c No (informational only) Session Cookie 30 days \u2705 Yes (via refresh)"},{"location":"architecture/oauth-flows/#testing-the-flows","title":"Testing the Flows","text":""},{"location":"architecture/oauth-flows/#test-frontend-authentication","title":"Test Frontend Authentication","text":"<pre><code># 1. Start frontend\ncd Frontend\nnpm run dev\n\n# 2. Open browser\nopen http://localhost:3000\n\n# 3. Click \"Sign In\"\n# 4. Login with: testuser2 / Passw0rd12\u00a3\n# 5. Verify redirect back to app\n</code></pre>"},{"location":"architecture/oauth-flows/#test-api-authentication","title":"Test API Authentication","text":"<pre><code># 1. Get a token from Keycloak\ncurl -k -X POST https://keycloak.otterburn.home/realms/secure-test/protocol/openid-connect/token \\\n  -H \"Content-Type: application/x-www-form-urlencoded\" \\\n  -d \"client_id=authentication-test-api\" \\\n  -d \"client_secret=8u50V7iXkuibA4BvzKVoDcQ5aaAbUsTI\" \\\n  -d \"grant_type=password\" \\\n  -d \"username=testuser2\" \\\n  -d \"password=Passw0rd12\u00a3\" \\\n  | jq -r '.access_token'\n\n# 2. Use token to call API\ncurl http://localhost:9080/api/v1/schedule \\\n  -H \"Authorization: Bearer &lt;ACCESS_TOKEN&gt;\"\n</code></pre>"},{"location":"architecture/oauth-flows/#test-token-exchange","title":"Test Token Exchange","text":"<pre><code># 1. Login to frontend (get session cookie)\n# 2. Call token exchange endpoint\ncurl http://localhost:3000/api/token-exchange \\\n  -X POST \\\n  -H \"Cookie: next-auth.session-token=&lt;SESSION_TOKEN&gt;\" \\\n  | jq\n\n# Expected response:\n# {\n#   \"access_token\": \"eyJhbGc...\",\n#   \"issued_token_type\": \"urn:ietf:params:oauth:token-type:access_token\",\n#   \"token_type\": \"Bearer\",\n#   \"expires_in\": 3600\n# }\n</code></pre>"},{"location":"architecture/oauth-flows/#troubleshooting","title":"Troubleshooting","text":""},{"location":"architecture/oauth-flows/#common-issues","title":"Common Issues","text":""},{"location":"architecture/oauth-flows/#invalid-redirect-uri","title":"\"Invalid redirect URI\"","text":"<p>Cause: Redirect URI not configured in Keycloak client</p> <p>Solution: Add to Valid Redirect URIs in Keycloak: <pre><code>http://localhost:3000/api/auth/callback/keycloak\n</code></pre></p>"},{"location":"architecture/oauth-flows/#token-signature-verification-failed","title":"\"Token signature verification failed\"","text":"<p>Cause: API server cannot reach Keycloak JWKS endpoint</p> <p>Solution: Verify network connectivity and SSL configuration</p>"},{"location":"architecture/oauth-flows/#invalid-audience","title":"\"Invalid audience\"","text":"<p>Cause: Token audience doesn't match API server expectation</p> <p>Solution: Use token exchange or configure multi-audience tokens</p>"},{"location":"architecture/oauth-flows/#token-expired","title":"\"Token expired\"","text":"<p>Cause: Access token lifetime exceeded</p> <p>Solution: Implement token refresh or re-authenticate</p>"},{"location":"architecture/oauth-flows/#related-documentation","title":"Related Documentation","text":"<ul> <li>Frontend Authentication Guide</li> <li>API Authentication Guide</li> <li>Keycloak Setup</li> <li>Orchestrate Integration</li> </ul>"},{"location":"architecture/oauth-flows/#standards-specifications","title":"Standards &amp; Specifications","text":"<ul> <li>OAuth 2.0 (RFC 6749)</li> <li>OAuth 2.0 Token Exchange (RFC 8693)</li> <li>JSON Web Token (RFC 7519)</li> <li>OpenID Connect Core 1.0</li> <li>MicroProfile JWT Authentication</li> </ul>"},{"location":"build/containers/","title":"Containerization","text":"<p>Learn how to build and run the Authentication Test API in containers using Podman or Docker.</p>"},{"location":"build/containers/#overview","title":"Overview","text":"<p>The project includes a <code>Containerfile</code> in the <code>API_server/</code> directory (compatible with both Podman and Docker) that creates a production-ready container image.</p>"},{"location":"build/containers/#container-image-details","title":"Container Image Details","text":"<ul> <li>Base Image: OpenLiberty 24.0.0.1 with Java 21</li> <li>Multi-stage Build: Optimized for size and security</li> <li>Non-root User: Runs as user 1001 for security</li> <li>Exposed Ports: 9080 (HTTP), 9443 (HTTPS)</li> </ul>"},{"location":"build/containers/#building-container-images","title":"Building Container Images","text":"Podman (Recommended)Docker <p>Podman is a daemonless container engine that's compatible with Docker.</p> <p>Build Image:</p> <pre><code>cd API_server\npodman build -t authentication-test-api:1.0.0 .\n</code></pre> <p>Build with Custom Tag:</p> <pre><code>cd API_server\npodman build -t authentication-test-api:latest .\n</code></pre> <p>Build with No Cache:</p> <p>Force rebuild without using cache:</p> <pre><code>cd API_server\npodman build --no-cache -t authentication-test-api:1.0.0 .\n</code></pre> <p>Build Image:</p> <pre><code>cd API_server\ndocker build -t authentication-test-api:1.0.0 .\n</code></pre> <p>Build with Build Args:</p> <p>Pass build-time variables:</p> <pre><code>cd API_server\ndocker build \\\n  --build-arg LIBERTY_VERSION=24.0.0.1 \\\n  -t authentication-test-api:1.0.0 .\n</code></pre>"},{"location":"build/containers/#running-containers","title":"Running Containers","text":""},{"location":"build/containers/#basic-run","title":"Basic Run","text":"PodmanDocker <pre><code>podman run -d \\\n  --name auth-api \\\n  -p 9080:9080 \\\n  -p 9443:9443 \\\n  authentication-test-api:1.0.0\n</code></pre> <pre><code>docker run -d \\\n  --name auth-api \\\n  -p 9080:9080 \\\n  -p 9443:9443 \\\n  authentication-test-api:1.0.0\n</code></pre>"},{"location":"build/containers/#run-with-environment-variables","title":"Run with Environment Variables","text":"<p>Configure the application using environment variables:</p> PodmanDocker <pre><code>podman run -d \\\n  --name auth-api \\\n  -p 9080:9080 \\\n  -p 9443:9443 \\\n  -e JWT_JWKS_URI=https://keycloak.lab.home/realms/secure-test/protocol/openid-connect/certs \\\n  -e JWT_ISSUER=https://keycloak.lab.home/realms/secure-test \\\n  -e LOG_LEVEL=DEBUG \\\n  -e CORS_ALLOWED_ORIGINS=http://localhost:3000 \\\n  authentication-test-api:1.0.0\n</code></pre> <pre><code>docker run -d \\\n  --name auth-api \\\n  -p 9080:9080 \\\n  -p 9443:9443 \\\n  -e JWT_JWKS_URI=https://keycloak.lab.home/realms/secure-test/protocol/openid-connect/certs \\\n  -e JWT_ISSUER=https://keycloak.lab.home/realms/secure-test \\\n  -e LOG_LEVEL=DEBUG \\\n  -e CORS_ALLOWED_ORIGINS=http://localhost:3000 \\\n  authentication-test-api:1.0.0\n</code></pre>"},{"location":"build/containers/#run-with-environment-file","title":"Run with Environment File","text":"<p>Create an environment file:</p> <pre><code># env.list\nJWT_JWKS_URI=https://keycloak.lab.home/realms/secure-test/protocol/openid-connect/certs\nJWT_ISSUER=https://keycloak.lab.home/realms/secure-test\nLOG_LEVEL=INFO\nCORS_ALLOWED_ORIGINS=http://localhost:3000,https://app.lab.home\nCORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,OPTIONS\nCORS_ALLOWED_HEADERS=Authorization,Content-Type\n</code></pre> <p>Run with environment file:</p> PodmanDocker <pre><code>podman run -d \\\n  --name auth-api \\\n  -p 9080:9080 \\\n  --env-file env.list \\\n  authentication-test-api:1.0.0\n</code></pre> <pre><code>docker run -d \\\n  --name auth-api \\\n  -p 9080:9080 \\\n  --env-file env.list \\\n  authentication-test-api:1.0.0\n</code></pre>"},{"location":"build/containers/#run-in-foreground","title":"Run in Foreground","text":"<p>Run with logs visible (useful for debugging):</p> PodmanDocker <pre><code>podman run --rm \\\n  --name auth-api \\\n  -p 9080:9080 \\\n  authentication-test-api:1.0.0\n</code></pre> <pre><code>docker run --rm \\\n  --name auth-api \\\n  -p 9080:9080 \\\n  authentication-test-api:1.0.0\n</code></pre> <p>Press <code>Ctrl+C</code> to stop.</p>"},{"location":"build/containers/#container-management","title":"Container Management","text":""},{"location":"build/containers/#list-running-containers","title":"List Running Containers","text":"PodmanDocker <pre><code>podman ps\n</code></pre> <pre><code>docker ps\n</code></pre>"},{"location":"build/containers/#list-all-containers","title":"List All Containers","text":"PodmanDocker <pre><code>podman ps -a\n</code></pre> <pre><code>docker ps -a\n</code></pre>"},{"location":"build/containers/#view-container-logs","title":"View Container Logs","text":"PodmanDocker <pre><code>podman logs auth-api\n\n# Follow logs\npodman logs -f auth-api\n\n# Last 100 lines\npodman logs --tail 100 auth-api\n</code></pre> <pre><code>docker logs auth-api\n\n# Follow logs\ndocker logs -f auth-api\n\n# Last 100 lines\ndocker logs --tail 100 auth-api\n</code></pre>"},{"location":"build/containers/#stop-container","title":"Stop Container","text":"PodmanDocker <pre><code>podman stop auth-api\n</code></pre> <pre><code>docker stop auth-api\n</code></pre>"},{"location":"build/containers/#start-stopped-container","title":"Start Stopped Container","text":"PodmanDocker <pre><code>podman start auth-api\n</code></pre> <pre><code>docker start auth-api\n</code></pre>"},{"location":"build/containers/#restart-container","title":"Restart Container","text":"PodmanDocker <pre><code>podman restart auth-api\n</code></pre> <pre><code>docker restart auth-api\n</code></pre>"},{"location":"build/containers/#remove-container","title":"Remove Container","text":"PodmanDocker <pre><code>podman rm auth-api\n\n# Force remove running container\npodman rm -f auth-api\n</code></pre> <pre><code>docker rm auth-api\n\n# Force remove running container\ndocker rm -f auth-api\n</code></pre>"},{"location":"build/containers/#execute-commands-in-container","title":"Execute Commands in Container","text":"PodmanDocker <pre><code># Open shell\npodman exec -it auth-api /bin/bash\n\n# Run single command\npodman exec auth-api ls -la /config/apps\n</code></pre> <pre><code># Open shell\ndocker exec -it auth-api /bin/bash\n\n# Run single command\ndocker exec auth-api ls -la /config/apps\n</code></pre>"},{"location":"build/containers/#image-management","title":"Image Management","text":""},{"location":"build/containers/#list-images","title":"List Images","text":"PodmanDocker <pre><code>podman images\n</code></pre> <pre><code>docker images\n</code></pre>"},{"location":"build/containers/#inspect-image","title":"Inspect Image","text":"PodmanDocker <pre><code>podman inspect authentication-test-api:1.0.0\n</code></pre> <pre><code>docker inspect authentication-test-api:1.0.0\n</code></pre>"},{"location":"build/containers/#remove-image","title":"Remove Image","text":"PodmanDocker <pre><code>podman rmi authentication-test-api:1.0.0\n</code></pre> <pre><code>docker rmi authentication-test-api:1.0.0\n</code></pre>"},{"location":"build/containers/#tag-image","title":"Tag Image","text":"PodmanDocker <pre><code>podman tag authentication-test-api:1.0.0 authentication-test-api:latest\n</code></pre> <pre><code>docker tag authentication-test-api:1.0.0 authentication-test-api:latest\n</code></pre>"},{"location":"build/containers/#save-image-to-file","title":"Save Image to File","text":"PodmanDocker <pre><code>podman save -o auth-api.tar authentication-test-api:1.0.0\n</code></pre> <pre><code>docker save -o auth-api.tar authentication-test-api:1.0.0\n</code></pre>"},{"location":"build/containers/#load-image-from-file","title":"Load Image from File","text":"PodmanDocker <pre><code>podman load -i auth-api.tar\n</code></pre> <pre><code>docker load -i auth-api.tar\n</code></pre>"},{"location":"build/containers/#container-networking","title":"Container Networking","text":""},{"location":"build/containers/#connect-to-keycloak-container","title":"Connect to Keycloak Container","text":"<p>If running Keycloak in a container, create a network:</p> PodmanDocker <pre><code># Create network\npodman network create auth-network\n\n# Run Keycloak\npodman run -d \\\n  --name keycloak \\\n  --network auth-network \\\n  -p 8080:8080 \\\n  -e KEYCLOAK_ADMIN=admin \\\n  -e KEYCLOAK_ADMIN_PASSWORD=admin \\\n  quay.io/keycloak/keycloak:latest start-dev\n\n# Run API\npodman run -d \\\n  --name auth-api \\\n  --network auth-network \\\n  -p 9080:9080 \\\n  -e JWT_JWKS_URI=http://keycloak:8080/realms/secure-test/protocol/openid-connect/certs \\\n  -e JWT_ISSUER=http://keycloak:8080/realms/secure-test \\\n  authentication-test-api:1.0.0\n</code></pre> <pre><code># Create network\ndocker network create auth-network\n\n# Run Keycloak\ndocker run -d \\\n  --name keycloak \\\n  --network auth-network \\\n  -p 8080:8080 \\\n  -e KEYCLOAK_ADMIN=admin \\\n  -e KEYCLOAK_ADMIN_PASSWORD=admin \\\n  quay.io/keycloak/keycloak:latest start-dev\n\n# Run API\ndocker run -d \\\n  --name auth-api \\\n  --network auth-network \\\n  -p 9080:9080 \\\n  -e JWT_JWKS_URI=http://keycloak:8080/realms/secure-test/protocol/openid-connect/certs \\\n  -e JWT_ISSUER=http://keycloak:8080/realms/secure-test \\\n  authentication-test-api:1.0.0\n</code></pre>"},{"location":"build/containers/#health-checks","title":"Health Checks","text":""},{"location":"build/containers/#container-health-check","title":"Container Health Check","text":"<p>Add health check to container:</p> PodmanDocker <pre><code>podman run -d \\\n  --name auth-api \\\n  -p 9080:9080 \\\n  --health-cmd \"curl -f http://localhost:9080/api/v1/hello || exit 1\" \\\n  --health-interval 30s \\\n  --health-timeout 10s \\\n  --health-retries 3 \\\n  authentication-test-api:1.0.0\n</code></pre> <pre><code>docker run -d \\\n  --name auth-api \\\n  -p 9080:9080 \\\n  --health-cmd \"curl -f http://localhost:9080/api/v1/hello || exit 1\" \\\n  --health-interval 30s \\\n  --health-timeout 10s \\\n  --health-retries 3 \\\n  authentication-test-api:1.0.0\n</code></pre>"},{"location":"build/containers/#check-container-health","title":"Check Container Health","text":"PodmanDocker <pre><code>podman inspect --format='{{.State.Health.Status}}' auth-api\n</code></pre> <pre><code>docker inspect --format='{{.State.Health.Status}}' auth-api\n</code></pre>"},{"location":"build/containers/#volume-mounts","title":"Volume Mounts","text":""},{"location":"build/containers/#mount-configuration","title":"Mount Configuration","text":"<p>Mount custom configuration:</p> PodmanDocker <pre><code>podman run -d \\\n  --name auth-api \\\n  -p 9080:9080 \\\n  -v ./custom-config:/config/configDropins/overrides:Z \\\n  authentication-test-api:1.0.0\n</code></pre> <pre><code>docker run -d \\\n  --name auth-api \\\n  -p 9080:9080 \\\n  -v ./custom-config:/config/configDropins/overrides \\\n  authentication-test-api:1.0.0\n</code></pre>"},{"location":"build/containers/#mount-logs","title":"Mount Logs","text":"<p>Persist logs outside container:</p> PodmanDocker <pre><code>podman run -d \\\n  --name auth-api \\\n  -p 9080:9080 \\\n  -v ./logs:/logs:Z \\\n  authentication-test-api:1.0.0\n</code></pre> <pre><code>docker run -d \\\n  --name auth-api \\\n  -p 9080:9080 \\\n  -v ./logs:/logs \\\n  authentication-test-api:1.0.0\n</code></pre>"},{"location":"build/containers/#production-deployment","title":"Production Deployment","text":""},{"location":"build/containers/#resource-limits","title":"Resource Limits","text":"<p>Set CPU and memory limits:</p> PodmanDocker <pre><code>podman run -d \\\n  --name auth-api \\\n  -p 9080:9080 \\\n  --memory=\"1g\" \\\n  --cpus=\"1.0\" \\\n  authentication-test-api:1.0.0\n</code></pre> <pre><code>docker run -d \\\n  --name auth-api \\\n  -p 9080:9080 \\\n  --memory=\"1g\" \\\n  --cpus=\"1.0\" \\\n  authentication-test-api:1.0.0\n</code></pre>"},{"location":"build/containers/#restart-policy","title":"Restart Policy","text":"<p>Auto-restart on failure:</p> PodmanDocker <pre><code>podman run -d \\\n  --name auth-api \\\n  -p 9080:9080 \\\n  --restart=unless-stopped \\\n  authentication-test-api:1.0.0\n</code></pre> <pre><code>docker run -d \\\n  --name auth-api \\\n  -p 9080:9080 \\\n  --restart=unless-stopped \\\n  authentication-test-api:1.0.0\n</code></pre>"},{"location":"build/containers/#troubleshooting","title":"Troubleshooting","text":""},{"location":"build/containers/#container-wont-start","title":"Container Won't Start","text":"<p>Check logs:</p> PodmanDocker <pre><code>podman logs auth-api\n</code></pre> <pre><code>docker logs auth-api\n</code></pre>"},{"location":"build/containers/#port-already-in-use","title":"Port Already in Use","text":"<p>Find and stop conflicting container:</p> PodmanDocker <pre><code>podman ps | grep 9080\npodman stop &lt;container-id&gt;\n</code></pre> <pre><code>docker ps | grep 9080\ndocker stop &lt;container-id&gt;\n</code></pre>"},{"location":"build/containers/#image-build-fails","title":"Image Build Fails","text":"<p>Build with verbose output:</p> PodmanDocker <pre><code>cd API_server\npodman build --no-cache --progress=plain -t authentication-test-api:1.0.0 .\n</code></pre> <pre><code>cd API_server\ndocker build --no-cache --progress=plain -t authentication-test-api:1.0.0 .\n</code></pre>"},{"location":"build/containers/#next-steps","title":"Next Steps","text":"<ul> <li>Running the Server - Deploy and run the application</li> <li>Configuration - Configure environment variables</li> <li>Keycloak Setup - Setup authentication server</li> </ul>"},{"location":"build/containers/#additional-resources","title":"Additional Resources","text":"<ul> <li>Podman Documentation</li> <li>Docker Documentation</li> <li>OpenLiberty Container Images</li> </ul>"},{"location":"build/maven/","title":"Building with Maven","text":"<p>This guide covers building, testing, and packaging the Authentication Test API using Apache Maven.</p> <p>Project Location</p> <p>All Maven commands should be run from the <code>API_server/</code> directory where the <code>pom.xml</code> file is located.</p>"},{"location":"build/maven/#maven-lifecycle","title":"Maven Lifecycle","text":"<p>Maven uses a standard build lifecycle with these main phases:</p> <pre><code>clean \u2192 validate \u2192 compile \u2192 test \u2192 package \u2192 verify \u2192 install \u2192 deploy\n</code></pre>"},{"location":"build/maven/#basic-build-commands","title":"Basic Build Commands","text":""},{"location":"build/maven/#clean-build","title":"Clean Build","text":"<p>Remove all generated files and start fresh:</p> <pre><code>cd API_server\nmvn clean\n</code></pre> <p>This deletes the <code>target/</code> directory within <code>API_server/</code>.</p>"},{"location":"build/maven/#compile","title":"Compile","text":"<p>Compile the source code without running tests:</p> <pre><code>cd API_server\nmvn compile\n</code></pre> <p>Output: Compiled classes in <code>API_server/target/classes/</code></p>"},{"location":"build/maven/#run-tests","title":"Run Tests","text":"<p>Execute unit tests:</p> <pre><code>cd API_server\nmvn test\n</code></pre>"},{"location":"build/maven/#package","title":"Package","text":"<p>Create the WAR file:</p> <pre><code>cd API_server\nmvn package\n</code></pre> <p>Output: <code>API_server/target/authentication-test-api.war</code></p>"},{"location":"build/maven/#full-build","title":"Full Build","text":"<p>Clean, compile, test, and package in one command:</p> <pre><code>cd API_server\nmvn clean package\n</code></pre> <p>This is the most common build command.</p>"},{"location":"build/maven/#development-mode","title":"Development Mode","text":""},{"location":"build/maven/#liberty-dev-mode","title":"Liberty Dev Mode","text":"<p>Run the application with hot reload:</p> <pre><code>cd API_server\nmvn liberty:dev\n</code></pre> <p>Features: - Hot Reload: Automatically recompiles and redeploys on code changes - Test on Save: Runs tests when files change - Debug Ready: Debug port available on 7777 - Interactive: Press Enter to run tests, <code>r</code> to restart</p> <p>Exit with <code>Ctrl+C</code>.</p>"},{"location":"build/maven/#skip-tests","title":"Skip Tests","text":"<p>Build without running tests (faster):</p> <pre><code>cd API_server\nmvn clean package -DskipTests\n</code></pre> <p>Warning</p> <p>Only skip tests during development. Always run tests before committing code.</p>"},{"location":"build/maven/#advanced-build-options","title":"Advanced Build Options","text":""},{"location":"build/maven/#update-dependencies","title":"Update Dependencies","text":"<p>Force update of all dependencies:</p> <pre><code>cd API_server\nmvn clean install -U\n</code></pre> <p>The <code>-U</code> flag forces Maven to check for updated snapshots.</p>"},{"location":"build/maven/#offline-build","title":"Offline Build","text":"<p>Build without downloading dependencies:</p> <pre><code>cd API_server\nmvn clean package -o\n</code></pre> <p>Requires all dependencies to be in local repository.</p>"},{"location":"build/maven/#verbose-output","title":"Verbose Output","text":"<p>Show detailed build information:</p> <pre><code>cd API_server\nmvn clean package -X\n</code></pre> <p>Useful for debugging build issues.</p>"},{"location":"build/maven/#parallel-builds","title":"Parallel Builds","text":"<p>Build faster using multiple threads:</p> <pre><code>cd API_server\nmvn clean package -T 4\n</code></pre> <p>Uses 4 threads. Adjust based on your CPU cores.</p>"},{"location":"build/maven/#build-profiles","title":"Build Profiles","text":""},{"location":"build/maven/#development-profile","title":"Development Profile","text":"<pre><code>cd API_server\nmvn clean package -Pdev\n</code></pre>"},{"location":"build/maven/#production-profile","title":"Production Profile","text":"<pre><code>cd API_server\nmvn clean package -Pprod\n</code></pre> <p>Note</p> <p>Profiles are defined in <code>API_server/pom.xml</code> and can customize build behavior.</p>"},{"location":"build/maven/#liberty-maven-plugin","title":"Liberty Maven Plugin","text":""},{"location":"build/maven/#start-server","title":"Start Server","text":"<p>Start OpenLiberty server:</p> <pre><code>cd API_server\nmvn liberty:start\n</code></pre> <p>Server runs in background.</p>"},{"location":"build/maven/#stop-server","title":"Stop Server","text":"<p>Stop the running server:</p> <pre><code>cd API_server\nmvn liberty:stop\n</code></pre>"},{"location":"build/maven/#run-server","title":"Run Server","text":"<p>Start server in foreground:</p> <pre><code>cd API_server\nmvn liberty:run\n</code></pre> <p>Exit with <code>Ctrl+C</code>.</p>"},{"location":"build/maven/#create-server-package","title":"Create Server Package","text":"<p>Create a runnable server package:</p> <pre><code>cd API_server\nmvn liberty:package\n</code></pre> <p>Output: <code>API_server/target/authentication-test-api.zip</code></p>"},{"location":"build/maven/#deploy-application","title":"Deploy Application","text":"<p>Deploy WAR to running server:</p> <pre><code>cd API_server\nmvn liberty:deploy\n</code></pre>"},{"location":"build/maven/#build-output","title":"Build Output","text":""},{"location":"build/maven/#directory-structure","title":"Directory Structure","text":"<p>After a successful build:</p> <pre><code>API_server/target/\n\u251c\u2500\u2500 authentication-test-api.war          # Deployable WAR file\n\u251c\u2500\u2500 authentication-test-api/             # Exploded WAR\n\u251c\u2500\u2500 classes/                             # Compiled classes\n\u251c\u2500\u2500 generated-sources/                   # Generated code\n\u251c\u2500\u2500 maven-archiver/                      # Maven metadata\n\u251c\u2500\u2500 maven-status/                        # Build status\n\u2514\u2500\u2500 test-classes/                        # Compiled test classes\n</code></pre>"},{"location":"build/maven/#war-file-contents","title":"WAR File Contents","text":"<p>The generated WAR file contains:</p> <pre><code>authentication-test-api.war\n\u251c\u2500\u2500 WEB-INF/\n\u2502   \u251c\u2500\u2500 classes/                         # Application classes\n\u2502   \u2502   \u2514\u2500\u2500 com/example/api/\n\u2502   \u251c\u2500\u2500 lib/                             # Dependencies (if any)\n\u2502   \u2514\u2500\u2500 web.xml                          # Web descriptor (optional)\n\u2514\u2500\u2500 META-INF/\n    \u2514\u2500\u2500 MANIFEST.MF                      # Manifest file\n</code></pre>"},{"location":"build/maven/#dependency-management","title":"Dependency Management","text":""},{"location":"build/maven/#list-dependencies","title":"List Dependencies","text":"<p>Show all project dependencies:</p> <pre><code>cd API_server\nmvn dependency:tree\n</code></pre>"},{"location":"build/maven/#analyze-dependencies","title":"Analyze Dependencies","text":"<p>Check for unused or undeclared dependencies:</p> <pre><code>cd API_server\nmvn dependency:analyze\n</code></pre>"},{"location":"build/maven/#download-sources","title":"Download Sources","text":"<p>Download source JARs for dependencies:</p> <pre><code>cd API_server\nmvn dependency:sources\n</code></pre> <p>Useful for IDE debugging.</p>"},{"location":"build/maven/#download-javadocs","title":"Download Javadocs","text":"<p>Download Javadoc JARs:</p> <pre><code>cd API_server\nmvn dependency:resolve -Dclassifier=javadoc\n</code></pre>"},{"location":"build/maven/#testing","title":"Testing","text":""},{"location":"build/maven/#run-specific-test","title":"Run Specific Test","text":"<p>Run a single test class:</p> <pre><code>cd API_server\nmvn test -Dtest=HelloResourceTest\n</code></pre>"},{"location":"build/maven/#run-test-method","title":"Run Test Method","text":"<p>Run a specific test method:</p> <pre><code>cd API_server\nmvn test -Dtest=HelloResourceTest#testHelloEndpoint\n</code></pre>"},{"location":"build/maven/#skip-tests_1","title":"Skip Tests","text":"<p>Skip test compilation and execution:</p> <pre><code>cd API_server\nmvn package -Dmaven.test.skip=true\n</code></pre>"},{"location":"build/maven/#test-coverage","title":"Test Coverage","text":"<p>Generate test coverage report (requires jacoco plugin):</p> <pre><code>cd API_server\nmvn clean test jacoco:report\n</code></pre> <p>Report: <code>API_server/target/site/jacoco/index.html</code></p>"},{"location":"build/maven/#code-quality","title":"Code Quality","text":""},{"location":"build/maven/#compile-with-warnings","title":"Compile with Warnings","text":"<p>Show all compiler warnings:</p> <pre><code>cd API_server\nmvn clean compile -Xlint:all\n</code></pre>"},{"location":"build/maven/#format-code","title":"Format Code","text":"<p>Format code according to style rules (requires formatter plugin):</p> <pre><code>cd API_server\nmvn formatter:format\n</code></pre>"},{"location":"build/maven/#troubleshooting","title":"Troubleshooting","text":""},{"location":"build/maven/#clear-local-repository","title":"Clear Local Repository","text":"<p>If dependencies are corrupted:</p> <pre><code># Remove project dependencies from local repo\nrm -rf ~/.m2/repository/com/example/authentication-test-api\n\n# Rebuild\ncd API_server\nmvn clean install -U\n</code></pre>"},{"location":"build/maven/#increase-memory","title":"Increase Memory","text":"<p>If build runs out of memory:</p> <pre><code>export MAVEN_OPTS=\"-Xmx2048m -XX:MaxPermSize=512m\"\ncd API_server\nmvn clean package\n</code></pre>"},{"location":"build/maven/#debug-build","title":"Debug Build","text":"<p>Run Maven in debug mode:</p> <pre><code>cd API_server\nmvn clean package -X &gt; build.log 2&gt;&amp;1\n</code></pre> <p>Review <code>build.log</code> for detailed information.</p>"},{"location":"build/maven/#dependency-conflicts","title":"Dependency Conflicts","text":"<p>Resolve dependency conflicts:</p> <pre><code>cd API_server\nmvn dependency:tree -Dverbose\n</code></pre> <p>Look for conflicts marked with <code>(omitted for conflict with X.Y.Z)</code>.</p>"},{"location":"build/maven/#build-best-practices","title":"Build Best Practices","text":""},{"location":"build/maven/#1-always-clean-before-release","title":"1. Always Clean Before Release","text":"<pre><code>cd API_server\nmvn clean package\n</code></pre> <p>Ensures no stale artifacts.</p>"},{"location":"build/maven/#2-run-tests","title":"2. Run Tests","text":"<pre><code>cd API_server\nmvn clean verify\n</code></pre> <p>Runs all tests including integration tests.</p>"},{"location":"build/maven/#3-check-for-updates","title":"3. Check for Updates","text":"<pre><code>cd API_server\nmvn versions:display-dependency-updates\nmvn versions:display-plugin-updates\n</code></pre>"},{"location":"build/maven/#4-verify-build-reproducibility","title":"4. Verify Build Reproducibility","text":"<pre><code>cd API_server\nmvn clean package\nmvn clean package\ndiff target/authentication-test-api.war target/authentication-test-api.war\n</code></pre> <p>Builds should be identical.</p>"},{"location":"build/maven/#cicd-integration","title":"CI/CD Integration","text":""},{"location":"build/maven/#github-actions","title":"GitHub Actions","text":"<pre><code>- name: Build with Maven\n  run: |\n    cd API_server\n    mvn clean package -B\n</code></pre>"},{"location":"build/maven/#gitlab-ci","title":"GitLab CI","text":"<pre><code>build:\n  script:\n    - cd API_server\n    - mvn clean package\n</code></pre>"},{"location":"build/maven/#jenkins","title":"Jenkins","text":"<pre><code>sh 'cd API_server &amp;&amp; mvn clean package'\n</code></pre>"},{"location":"build/maven/#next-steps","title":"Next Steps","text":"<ul> <li>Containerization - Build container images</li> <li>Running the Server - Deploy and run the application</li> <li>Configuration - Configure the application</li> </ul>"},{"location":"build/maven/#additional-resources","title":"Additional Resources","text":"<ul> <li>Maven Documentation</li> <li>Liberty Maven Plugin</li> <li>Maven Lifecycle Reference</li> </ul>"},{"location":"build/running/","title":"Running the Server","text":"<p>Guide for running the Authentication Test API server in different environments.</p>"},{"location":"build/running/#running-options","title":"Running Options","text":"Development ModeProduction ModeContainer <p>The easiest way to run during development with hot reload:</p> <pre><code>cd API_server\nmvn liberty:dev\n</code></pre> <p>Features:</p> <ul> <li>Hot reload on code changes</li> <li>Automatic test execution</li> <li>Debug port on 7777</li> <li>Interactive mode</li> </ul> <p>Access the API at:</p> <ul> <li>HTTP: <code>http://localhost:9080</code></li> <li>HTTPS: <code>https://localhost:9443</code></li> </ul> <p>Press <code>Ctrl+C</code> to stop.</p> <p>Start the server in background:</p> <pre><code>cd API_server\nmvn liberty:start\n</code></pre> <p>Stop the server:</p> <pre><code>cd API_server\nmvn liberty:stop\n</code></pre> <p>See Containerization Guide for detailed instructions on running in containers with Podman or Docker.</p>"},{"location":"build/running/#configuration","title":"Configuration","text":"<p>Set environment variables before starting:</p> <pre><code>export JWT_JWKS_URI=https://keycloak.lab.home/realms/secure-test/protocol/openid-connect/certs\nexport JWT_ISSUER=https://keycloak.lab.home/realms/secure-test\ncd API_server\nmvn liberty:dev\n</code></pre>"},{"location":"build/running/#verification","title":"Verification","text":"<p>Test the server is running:</p> <pre><code>curl http://localhost:9080/api/v1/hello\n</code></pre>"},{"location":"build/running/#next-steps","title":"Next Steps","text":"<ul> <li>API Endpoints</li> <li>Configuration</li> <li>Troubleshooting</li> </ul>"},{"location":"config/environment/","title":"Environment Variables","text":"<p>Configuration options for the Authentication Test API using environment variables.</p>"},{"location":"config/environment/#required-variables","title":"Required Variables","text":""},{"location":"config/environment/#jwt-configuration","title":"JWT Configuration","text":"<pre><code># Keycloak JWKS endpoint for token validation\nexport JWT_JWKS_URI=https://keycloak.lab.home/realms/secure-test/protocol/openid-connect/certs\n\n# JWT token issuer\nexport JWT_ISSUER=https://keycloak.lab.home/realms/secure-test\n</code></pre>"},{"location":"config/environment/#optional-variables","title":"Optional Variables","text":""},{"location":"config/environment/#cors-configuration","title":"CORS Configuration","text":"<pre><code># Allowed origins (comma-separated)\nexport CORS_ALLOWED_ORIGINS=http://localhost:3000,https://app.lab.home\n\n# Allowed HTTP methods\nexport CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,OPTIONS\n\n# Allowed headers\nexport CORS_ALLOWED_HEADERS=Authorization,Content-Type\n</code></pre>"},{"location":"config/environment/#logging","title":"Logging","text":"<pre><code># Log level: TRACE, DEBUG, INFO, WARN, ERROR\nexport LOG_LEVEL=INFO\n</code></pre>"},{"location":"config/environment/#setting-variables","title":"Setting Variables","text":""},{"location":"config/environment/#development-local","title":"Development (Local)","text":"<pre><code># Create .env file (don't commit!)\ncat &gt; .env &lt;&lt; EOF\nJWT_JWKS_URI=http://localhost:8080/realms/secure-test/protocol/openid-connect/certs\nJWT_ISSUER=http://localhost:8080/realms/secure-test\nLOG_LEVEL=DEBUG\nEOF\n\n# Load variables\nsource .env\n\n# Run application\nmvn liberty:dev\n</code></pre>"},{"location":"config/environment/#container-deployment","title":"Container Deployment","text":"<pre><code># Using environment file\npodman run -d \\\n  --name auth-api \\\n  -p 9080:9080 \\\n  --env-file .env \\\n  authentication-test-api:1.0.0\n</code></pre>"},{"location":"config/environment/#production","title":"Production","text":"<p>Use secure secret management: - Kubernetes Secrets - HashiCorp Vault - AWS Secrets Manager - Azure Key Vault</p>"},{"location":"config/environment/#next-steps","title":"Next Steps","text":"<ul> <li>Server Configuration</li> <li>Security Settings</li> </ul>"},{"location":"config/security/","title":"Security Settings","text":"<p>Security configuration and best practices for the Authentication Test API.</p>"},{"location":"config/security/#jwt-token-validation","title":"JWT Token Validation","text":"<ul> <li>Tokens validated using Keycloak's public key (JWKS)</li> <li>Signature verification on every request</li> <li>Token expiration checked automatically</li> </ul>"},{"location":"config/security/#role-based-access-control","title":"Role-Based Access Control","text":"<ul> <li><code>schedule-user</code> role required for <code>/schedule</code> endpoint</li> <li>Roles extracted from JWT token claims</li> <li>Authorization enforced by <code>@RolesAllowed</code> annotation</li> </ul>"},{"location":"config/security/#https-configuration","title":"HTTPS Configuration","text":"<p>For production, always use HTTPS:</p> <ol> <li>Generate or obtain SSL certificate</li> <li>Configure in <code>server.xml</code></li> <li>Redirect HTTP to HTTPS</li> </ol>"},{"location":"config/security/#security-best-practices","title":"Security Best Practices","text":"<ul> <li>Never log JWT tokens or passwords</li> <li>Use environment variables for secrets</li> <li>Enable CORS only for trusted origins</li> <li>Keep dependencies updated</li> <li>Use strong passwords in Keycloak</li> </ul>"},{"location":"config/security/#next-steps","title":"Next Steps","text":"<ul> <li>Environment Variables</li> <li>Keycloak Setup</li> </ul>"},{"location":"config/server/","title":"Server Configuration","text":"<p>OpenLiberty server configuration for the Authentication Test API.</p>"},{"location":"config/server/#configuration-file","title":"Configuration File","text":"<p>The server is configured in <code>src/main/liberty/config/server.xml</code>.</p>"},{"location":"config/server/#key-features","title":"Key Features","text":"<ul> <li>RESTful Web Services (JAX-RS 3.1)</li> <li>JSON Processing (JSON-P 2.1, JSON-B 3.0)</li> <li>CDI 4.0</li> <li>MicroProfile Config 3.1</li> <li>MicroProfile OpenAPI 3.1</li> <li>MicroProfile JWT 2.1</li> </ul>"},{"location":"config/server/#ports","title":"Ports","text":"<ul> <li>HTTP: 9080</li> <li>HTTPS: 9443</li> </ul>"},{"location":"config/server/#next-steps","title":"Next Steps","text":"<ul> <li>Environment Variables</li> <li>Security Settings</li> </ul>"},{"location":"config/ssl-certificates/","title":"SSL Certificate Configuration","text":"<p>This guide explains how to configure OpenLiberty to work with self-signed SSL certificates, which is essential when connecting to Keycloak instances using custom Certificate Authorities (CA).</p>"},{"location":"config/ssl-certificates/#why-is-this-needed","title":"Why is This Needed?","text":"<p>When Keycloak uses self-signed certificates or certificates issued by a custom CA (like a home lab CA), OpenLiberty cannot validate the certificate chain by default. This causes errors when:</p> <ul> <li>Fetching JWKS (JSON Web Key Set) from Keycloak</li> <li>Validating JWT tokens</li> <li>Making any HTTPS requests to Keycloak</li> </ul> <p>Common error: <pre><code>PKIX path building failed: unable to find valid certification path to requested target\n</code></pre></p>"},{"location":"config/ssl-certificates/#understanding-the-certificate-chain","title":"Understanding the Certificate Chain","text":"<p>A typical certificate chain looks like this:</p> <pre><code>Root CA (HomeLab CA Root CA)\n    \u2193\nIntermediate CA (Home Lab Intermediate)\n    \u2193\nServer Certificate (keycloak.lab.home)\n</code></pre> <p>OpenLiberty needs to trust the entire chain to validate the server certificate.</p>"},{"location":"config/ssl-certificates/#prerequisites","title":"Prerequisites","text":"<ul> <li>OpenLiberty installed</li> <li>Access to your CA certificates (root and intermediate)</li> <li>Keycloak running with self-signed certificates</li> </ul>"},{"location":"config/ssl-certificates/#solution-overview","title":"Solution Overview","text":"<p>We need to:</p> <ol> <li>Export CA certificates from Keycloak</li> <li>Import CA certificates into OpenLiberty's truststore</li> <li>Configure OpenLiberty to use the truststore</li> <li>Verify the configuration</li> </ol>"},{"location":"config/ssl-certificates/#step-1-export-ca-certificates","title":"Step 1: Export CA Certificates","text":"From Keycloak ServerFrom BrowserProvided by Administrator <p>If you have access to the Keycloak server:</p> <pre><code># Export the certificate chain from Keycloak\necho | openssl s_client -connect keycloak.lab.home:443 -showcerts 2&gt;/dev/null | \\\n  openssl x509 -outform PEM &gt; keycloak-server.crt\n\n# View certificate details\nopenssl x509 -in keycloak-server.crt -noout -subject -issuer\n</code></pre> <ol> <li>Navigate to Keycloak in your browser</li> <li>Click the padlock icon in the address bar</li> <li>View certificate details</li> <li>Export each certificate in the chain:<ul> <li>Server certificate</li> <li>Intermediate CA certificate</li> <li>Root CA certificate</li> </ul> </li> <li>Save as PEM format (<code>.crt</code> or <code>.pem</code> files)</li> </ol> <p>If your administrator provides the CA certificates, save them to a <code>certs/</code> directory:</p> <pre><code>mkdir -p certs\n# Copy provided certificates\ncp /path/to/root_ca.crt certs/\ncp /path/to/intermediate_ca.crt certs/\n</code></pre>"},{"location":"config/ssl-certificates/#step-2-verify-certificate-chain","title":"Step 2: Verify Certificate Chain","text":"<p>Before importing, verify the certificate chain is complete:</p> <pre><code># Check root CA\nopenssl x509 -in certs/root_ca.crt -noout -subject -issuer\n\n# Check intermediate CA\nopenssl x509 -in certs/intermediate_ca.crt -noout -subject -issuer\n\n# Verify the chain\nopenssl verify -CAfile certs/root_ca.crt certs/intermediate_ca.crt\n</code></pre> <p>Expected output: <pre><code>certs/intermediate_ca.crt: OK\n</code></pre></p>"},{"location":"config/ssl-certificates/#step-3-import-certificates-into-truststore","title":"Step 3: Import Certificates into Truststore","text":"<p>This assumes you have a separate RootCA certificate, and intermediate certificate and a server certificate chain, adjust as needed. OpenLiberty uses a PKCS12 keystore located at: <pre><code>API_server/target/liberty/wlp/usr/servers/authTestServer/resources/security/key.p12\n</code></pre></p>"},{"location":"config/ssl-certificates/#import-root-ca-certificate","title":"Import Root CA Certificate","text":"<pre><code>keytool -import \\\n  -alias homelab-root-ca \\\n  -file certs/root_ca.crt \\\n  -keystore API_server/target/liberty/wlp/usr/servers/authTestServer/resources/security/key.p12 \\\n  -storepass changeit \\\n  -noprompt\n</code></pre>"},{"location":"config/ssl-certificates/#import-intermediate-ca-certificate","title":"Import Intermediate CA Certificate","text":"<pre><code>keytool -import \\\n  -alias homelab-intermediate-ca \\\n  -file certs/intermediate_ca.crt \\\n  -keystore API_server/target/liberty/wlp/usr/servers/authTestServer/resources/security/key.p12 \\\n  -storepass changeit \\\n  -noprompt\n</code></pre>"},{"location":"config/ssl-certificates/#verify-imports","title":"Verify Imports","text":"<p>List all certificates in the keystore:</p> <pre><code>keytool -list \\\n  -keystore API_server/target/liberty/wlp/usr/servers/authTestServer/resources/security/key.p12 \\\n  -storepass changeit\n</code></pre> <p>Expected output: <pre><code>Keystore type: PKCS12\nKeystore provider: SUN\n\nYour keystore contains 8 entries\n\ndefault, 28 Jan 2026, PrivateKeyEntry\nhomelab-root-ca, 28 Jan 2026, trustedCertEntry\nhomelab-intermediate-ca, 28 Jan 2026, trustedCertEntry\n...\n</code></pre></p>"},{"location":"config/ssl-certificates/#step-4-configure-openliberty","title":"Step 4: Configure OpenLiberty","text":""},{"location":"config/ssl-certificates/#update-serverxml","title":"Update server.xml","text":"<p>Configure SSL settings in <code>API_server/src/main/liberty/config/server.xml</code>:</p> <pre><code>&lt;!-- SSL Configuration for JWT/JWKS endpoint --&gt;\n&lt;ssl id=\"jwtSSLConfig\"\n     keyStoreRef=\"defaultKeyStore\"\n     trustDefaultCerts=\"true\"\n     verifyHostname=\"false\"\n     sslProtocol=\"TLSv1.2\"\n     clientAuthentication=\"false\"\n     clientAuthenticationSupported=\"false\"/&gt;\n\n&lt;!-- Outbound SSL configuration for REST clients --&gt;\n&lt;sslDefault outboundSSLRef=\"jwtSSLConfig\"/&gt;\n\n&lt;!-- Keystore configuration --&gt;\n&lt;keyStore id=\"defaultKeyStore\"\n          password=\"changeit\"/&gt;\n\n&lt;!-- MicroProfile JWT Configuration --&gt;\n&lt;mpJwt id=\"jwtConfig\"\n       jwksUri=\"${env.JWT_JWKS_URI}\"\n       issuer=\"${env.JWT_ISSUER}\"\n       audiences=\"authentication-test-api\"\n       groupNameAttribute=\"groups\"\n       userNameAttribute=\"preferred_username\"\n       sslRef=\"jwtSSLConfig\"/&gt;\n</code></pre>"},{"location":"config/ssl-certificates/#key-configuration-options","title":"Key Configuration Options","text":"<ul> <li><code>trustDefaultCerts=\"true\"</code> - Trust system default certificates</li> <li><code>verifyHostname=\"false\"</code> - Disable hostname verification (development only)</li> <li><code>sslProtocol=\"TLSv1.2\"</code> - Use TLS 1.2 or higher</li> <li><code>sslRef=\"jwtSSLConfig\"</code> - Reference SSL configuration in mpJwt</li> </ul> <p>Production Settings</p> <p>For production, set <code>verifyHostname=\"true\"</code> and ensure certificates have correct hostnames.</p>"},{"location":"config/ssl-certificates/#optional-jvm-options-for-development","title":"Optional: JVM Options for Development","text":"<p>For development environments, you can add JVM options to disable strict SSL validation:</p> <p>Create <code>API_server/src/main/liberty/config/jvm.options</code>:</p> <pre><code># Disable strict SSL validation (DEVELOPMENT ONLY)\n-Dcom.ibm.jsse2.overrideDefaultTLS=true\n-Djavax.net.ssl.trustAll=true\n-Djdk.internal.httpclient.disableHostnameVerification=true\n\n# Memory settings\n-Xmx512m\n-Xms256m\n</code></pre> <p>Security Warning</p> <p>Never use these JVM options in production! They disable SSL certificate validation entirely.</p>"},{"location":"config/ssl-certificates/#step-5-restart-openliberty","title":"Step 5: Restart OpenLiberty","text":"<p>After importing certificates and updating configuration:</p> <pre><code># Stop the server\ncd API_server\nmvn liberty:stop\n\n# Start in dev mode\nmvn liberty:dev\n</code></pre> <p>Or for a full restart:</p> <pre><code># Complete restart\ncd API_server\nmvn liberty:stop &amp;&amp; sleep 3 &amp;&amp; mvn liberty:dev\n</code></pre>"},{"location":"config/ssl-certificates/#step-6-verify-configuration","title":"Step 6: Verify Configuration","text":""},{"location":"config/ssl-certificates/#test-jwks-endpoint-access","title":"Test JWKS Endpoint Access","text":"<p>Check if OpenLiberty can now access the Keycloak JWKS endpoint:</p> <pre><code># Check server logs for SSL errors\ntail -f API_server/target/liberty/wlp/usr/servers/authTestServer/logs/messages.log | grep -i \"ssl\\|pkix\\|certificate\"\n</code></pre> <p>Success indicators: - No PKIX errors - No SSL handshake failures - JWT tokens validate successfully</p>"},{"location":"config/ssl-certificates/#test-api-with-jwt-token","title":"Test API with JWT Token","text":"<pre><code># Get token from Keycloak\nTOKEN=$(curl -s -k -X POST https://keycloak.lab.home/realms/secure-test/protocol/openid-connect/token \\\n  -H \"Content-Type: application/x-www-form-urlencoded\" \\\n  -d \"client_id=authentication-test-api\" \\\n  -d \"client_secret=YOUR_CLIENT_SECRET\" \\\n  -d \"grant_type=password\" \\\n  -d \"username=testuser2\" \\\n  -d \"password=YOUR_PASSWORD\" | jq -r '.access_token')\n\n# Test API\ncurl -s http://localhost:9080/api/v1/schedule \\\n  -H \"Authorization: Bearer $TOKEN\" | jq .\n</code></pre> <p>Expected result: 200 OK with schedule data (no SSL errors)</p>"},{"location":"config/ssl-certificates/#troubleshooting","title":"Troubleshooting","text":""},{"location":"config/ssl-certificates/#still-getting-pkix-errors","title":"Still Getting PKIX Errors","text":"<p>Possible causes:</p> <ol> <li>Incomplete certificate chain</li> <li>Verify you imported both root and intermediate CA certificates</li> <li> <p>Check certificate chain with <code>openssl verify</code></p> </li> <li> <p>Server not restarted</p> </li> <li>Truststore changes require a full server restart</li> <li> <p>Use <code>cd API_server &amp;&amp; mvn liberty:stop &amp;&amp; mvn liberty:dev</code></p> </li> <li> <p>Wrong keystore path</p> </li> <li>Verify keystore location matches server.xml configuration</li> <li>Check file permissions</li> </ol>"},{"location":"config/ssl-certificates/#certificate-import-failed","title":"Certificate Import Failed","text":"<pre><code># Check if certificate is valid\nopenssl x509 -in certs/root_ca.crt -text -noout\n\n# Verify certificate format (should be PEM)\nhead -1 certs/root_ca.crt\n# Should show: -----BEGIN CERTIFICATE-----\n</code></pre>"},{"location":"config/ssl-certificates/#hostname-verification-errors","title":"Hostname Verification Errors","text":"<p>If you see hostname verification errors:</p> <pre><code>&lt;!-- Temporarily disable for development --&gt;\n&lt;ssl id=\"jwtSSLConfig\"\n     ...\n     verifyHostname=\"false\"/&gt;\n</code></pre> <p>For production, ensure certificates have correct Subject Alternative Names (SAN).</p>"},{"location":"config/ssl-certificates/#automated-certificate-import-script","title":"Automated Certificate Import Script","text":"<p>Create a script to automate certificate import:</p> <pre><code>#!/bin/bash\n# import_ca_certs.sh\n\nKEYSTORE=\"API_server/target/liberty/wlp/usr/servers/authTestServer/resources/security/key.p12\"\nSTOREPASS=\"changeit\"\n\n# Import root CA\nkeytool -import \\\n  -alias homelab-root-ca \\\n  -file certs/root_ca.crt \\\n  -keystore \"$KEYSTORE\" \\\n  -storepass \"$STOREPASS\" \\\n  -noprompt\n\n# Import intermediate CA\nkeytool -import \\\n  -alias homelab-intermediate-ca \\\n  -file certs/intermediate_ca.crt \\\n  -keystore \"$KEYSTORE\" \\\n  -storepass \"$STOREPASS\" \\\n  -noprompt\n\necho \"Certificates imported successfully\"\nkeytool -list -keystore \"$KEYSTORE\" -storepass \"$STOREPASS\" | grep -i \"homelab\"\n</code></pre> <p>Make it executable:</p> <pre><code>chmod +x import_ca_certs.sh\n./import_ca_certs.sh\n</code></pre>"},{"location":"config/ssl-certificates/#production-considerations","title":"Production Considerations","text":""},{"location":"config/ssl-certificates/#use-proper-certificates","title":"Use Proper Certificates","text":"<p>For production:</p> <ol> <li>Use certificates from trusted CA (Let's Encrypt, DigiCert, etc.)</li> <li>Enable hostname verification</li> <li>Remove JVM SSL bypass options</li> <li>Use strong keystore passwords</li> <li>Regularly rotate certificates</li> </ol>"},{"location":"config/ssl-certificates/#certificate-renewal","title":"Certificate Renewal","text":"<p>When certificates are renewed:</p> <ol> <li>Export new certificates</li> <li>Remove old certificates from truststore:    <pre><code>keytool -delete -alias homelab-root-ca \\\n  -keystore \"$KEYSTORE\" -storepass \"$STOREPASS\"\n</code></pre></li> <li>Import new certificates</li> <li>Restart server</li> </ol>"},{"location":"config/ssl-certificates/#monitoring-certificate-expiration","title":"Monitoring Certificate Expiration","text":"<p>Check certificate expiration dates:</p> <pre><code># Check certificate validity\nopenssl x509 -in certs/root_ca.crt -noout -dates\n\n# Check keystore certificates\nkeytool -list -v \\\n  -keystore target/liberty/wlp/usr/servers/authTestServer/resources/security/key.p12 \\\n  -storepass changeit | grep -A2 \"Valid\"\n</code></pre>"},{"location":"config/ssl-certificates/#next-steps","title":"Next Steps","text":"<ul> <li>Keycloak Setup - Configure Keycloak realm</li> <li>Groups Mapper - Configure role mapping</li> <li>Troubleshooting - Common issues</li> </ul>"},{"location":"config/ssl-certificates/#references","title":"References","text":"<ul> <li>OpenLiberty SSL Configuration</li> <li>Java Keytool Documentation</li> <li>OpenSSL Documentation</li> </ul>"},{"location":"deployment/github-pages/","title":"Deploying Documentation to GitHub Pages","text":"<p>This guide explains how to deploy the MkDocs documentation to GitHub Pages.</p>"},{"location":"deployment/github-pages/#prerequisites","title":"Prerequisites","text":"<ul> <li>Git repository on GitHub</li> <li>Python 3.8+ installed</li> <li>Write access to the repository</li> </ul>"},{"location":"deployment/github-pages/#deployment-options","title":"Deployment Options","text":"Manual DeploymentGitHub Actions (Automated)Mike (Versioned Documentation) <p>Step 1: Install MkDocs</p> <pre><code># Install MkDocs and dependencies\npip install -r requirements.txt\n\n# Verify installation\nmkdocs --version\n</code></pre> <p>Step 2: Build Documentation</p> <pre><code># Build the documentation\nmkdocs build\n\n# This creates a 'site' directory with static HTML\n</code></pre> <p>Step 3: Deploy to GitHub Pages</p> <pre><code># Deploy to gh-pages branch\nmkdocs gh-deploy\n\n# This will:\n# 1. Build the documentation\n# 2. Push to gh-pages branch\n# 3. Make it available at https://yourusername.github.io/authentication_test\n</code></pre> <p>Step 4: Configure GitHub Pages</p> <ol> <li>Go to your repository on GitHub</li> <li>Click \"Settings\"</li> <li>Scroll to \"Pages\" section</li> <li>Under \"Source\", select:</li> <li>Branch: <code>gh-pages</code></li> <li>Folder: <code>/ (root)</code></li> <li>Click \"Save\"</li> </ol> <p>Your documentation will be available at: <pre><code>https://yourusername.github.io/authentication_test\n</code></pre></p> <p>Step 1: Create Workflow File</p> <p>Create <code>.github/workflows/docs.yml</code>:</p> <pre><code>name: Deploy Documentation\n\non:\n  push:\n    branches:\n      - main\n    paths:\n      - 'docs/**'\n      - 'mkdocs.yml'\n      - 'requirements.txt'\n      - '.github/workflows/docs.yml'\n  workflow_dispatch:\n\npermissions:\n  contents: write\n\njobs:\n  deploy:\n    runs-on: ubuntu-latest\n    steps:\n      - name: Checkout code\n        uses: actions/checkout@v4\n        with:\n          fetch-depth: 0\n\n      - name: Setup Python\n        uses: actions/setup-python@v5\n        with:\n          python-version: 3.x\n\n      - name: Cache dependencies\n        uses: actions/cache@v3\n        with:\n          key: ${{ github.ref }}\n          path: .cache\n\n      - name: Install dependencies\n        run: pip install -r requirements.txt\n\n      - name: Build and deploy\n        run: mkdocs gh-deploy --force\n</code></pre> <p>Step 2: Commit and Push</p> <pre><code>git add .github/workflows/docs.yml\ngit commit -m \"Add GitHub Actions workflow for documentation\"\ngit push origin main\n</code></pre> <p>Step 3: Verify Deployment</p> <ol> <li>Go to \"Actions\" tab in your repository</li> <li>Watch the workflow run</li> <li>Once complete, visit your documentation site</li> </ol> <p>Mike allows you to maintain multiple versions of documentation.</p> <p>Install Mike:</p> <pre><code>pip install mike\n</code></pre> <p>Deploy Version:</p> <pre><code># Deploy version 1.0\nmike deploy --push --update-aliases 1.0 latest\n\n# Set default version\nmike set-default --push latest\n</code></pre> <p>View Versions Locally:</p> <pre><code>mike serve\n</code></pre> <p>Visit: <code>http://localhost:8000</code></p>"},{"location":"deployment/github-pages/#customizing-deployment","title":"Customizing Deployment","text":""},{"location":"deployment/github-pages/#custom-domain","title":"Custom Domain","text":"<ol> <li> <p>Create <code>docs/CNAME</code> file:    <pre><code>docs.example.com\n</code></pre></p> </li> <li> <p>Configure DNS:</p> </li> <li> <p>Add CNAME record pointing to <code>yourusername.github.io</code></p> </li> <li> <p>In GitHub Settings \u2192 Pages:</p> </li> <li>Enter custom domain</li> <li>Enable \"Enforce HTTPS\"</li> </ol>"},{"location":"deployment/github-pages/#update-mkdocsyml","title":"Update mkdocs.yml","text":"<pre><code>site_url: https://docs.example.com\nrepo_url: https://github.com/yourusername/authentication_test\n</code></pre>"},{"location":"deployment/github-pages/#local-development","title":"Local Development","text":""},{"location":"deployment/github-pages/#serve-locally","title":"Serve Locally","text":"<pre><code># Start development server\nmkdocs serve\n\n# With live reload\nmkdocs serve --dev-addr=0.0.0.0:8000\n</code></pre> <p>Visit: <code>http://localhost:8000</code></p>"},{"location":"deployment/github-pages/#build-only","title":"Build Only","text":"<pre><code># Build without deploying\nmkdocs build\n\n# Build to custom directory\nmkdocs build --site-dir custom_site\n</code></pre>"},{"location":"deployment/github-pages/#clean-build","title":"Clean Build","text":"<pre><code># Remove site directory\nrm -rf site\n\n# Rebuild\nmkdocs build\n</code></pre>"},{"location":"deployment/github-pages/#troubleshooting","title":"Troubleshooting","text":""},{"location":"deployment/github-pages/#build-fails","title":"Build Fails","text":"<p>Check for errors:</p> <pre><code>mkdocs build --verbose\n</code></pre> <p>Common issues: - Missing dependencies: <code>pip install -r requirements.txt</code> - Invalid YAML in mkdocs.yml - Broken links in documentation</p>"},{"location":"deployment/github-pages/#deployment-fails","title":"Deployment Fails","text":"<ol> <li>Check GitHub Actions logs</li> <li>Verify permissions:    <pre><code>permissions:\n  contents: write\n</code></pre></li> <li>Ensure gh-pages branch exists</li> </ol>"},{"location":"deployment/github-pages/#site-not-updating","title":"Site Not Updating","text":"<ol> <li>Clear browser cache</li> <li>Wait a few minutes for GitHub Pages to update</li> <li>Check GitHub Actions workflow completed successfully</li> <li>Verify gh-pages branch has new commits</li> </ol>"},{"location":"deployment/github-pages/#404-errors","title":"404 Errors","text":"<ol> <li>Check <code>site_url</code> in mkdocs.yml</li> <li>Verify GitHub Pages is enabled</li> <li>Ensure gh-pages branch is selected as source</li> </ol>"},{"location":"deployment/github-pages/#best-practices","title":"Best Practices","text":""},{"location":"deployment/github-pages/#1-version-control","title":"1. Version Control","text":"<p>Don't commit the <code>site/</code> directory:</p> <pre><code># .gitignore\nsite/\n.cache/\n</code></pre>"},{"location":"deployment/github-pages/#2-documentation-structure","title":"2. Documentation Structure","text":"<p>Keep documentation organized:</p> <pre><code>docs/\n\u251c\u2500\u2500 index.md\n\u251c\u2500\u2500 getting-started/\n\u251c\u2500\u2500 build/\n\u251c\u2500\u2500 keycloak/\n\u251c\u2500\u2500 api/\n\u251c\u2500\u2500 config/\n\u251c\u2500\u2500 troubleshooting/\n\u2514\u2500\u2500 development/\n</code></pre>"},{"location":"deployment/github-pages/#3-regular-updates","title":"3. Regular Updates","text":"<p>Update documentation with code changes:</p> <pre><code># After code changes\ngit add docs/\ngit commit -m \"Update documentation\"\ngit push\n</code></pre>"},{"location":"deployment/github-pages/#4-review-before-deploy","title":"4. Review Before Deploy","text":"<p>Always review locally:</p> <pre><code>mkdocs serve\n# Review at http://localhost:8000\nmkdocs gh-deploy\n</code></pre>"},{"location":"deployment/github-pages/#5-use-branches","title":"5. Use Branches","text":"<p>For major documentation changes:</p> <pre><code>git checkout -b docs/update-api-guide\n# Make changes\ngit push origin docs/update-api-guide\n# Create pull request\n</code></pre>"},{"location":"deployment/github-pages/#monitoring","title":"Monitoring","text":""},{"location":"deployment/github-pages/#search","title":"Search","text":"<p>MkDocs Material includes built-in search. No configuration needed.</p>"},{"location":"deployment/github-pages/#maintenance","title":"Maintenance","text":""},{"location":"deployment/github-pages/#update-dependencies","title":"Update Dependencies","text":"<pre><code># Update all dependencies\npip install --upgrade -r requirements.txt\n\n# Update specific package\npip install --upgrade mkdocs-material\n</code></pre>"},{"location":"deployment/github-pages/#check-for-broken-links","title":"Check for Broken Links","text":"<pre><code># Install linkchecker\npip install linkchecker\n\n# Check links\nmkdocs build\nlinkchecker site/\n</code></pre>"},{"location":"deployment/github-pages/#additional-resources","title":"Additional Resources","text":"<ul> <li>MkDocs Documentation</li> <li>Material for MkDocs</li> <li>GitHub Pages Documentation</li> <li>Mike Documentation</li> </ul>"},{"location":"deployment/github-pages/#next-steps","title":"Next Steps","text":"<ul> <li>Contributing Guide</li> <li>Project Structure</li> </ul>"},{"location":"development/contributing/","title":"Contributing Guide","text":"<p>Guidelines for contributing to the Authentication Test API project.</p>"},{"location":"development/contributing/#getting-started","title":"Getting Started","text":"<ol> <li>Fork the repository</li> <li>Clone your fork</li> <li>Create a feature branch</li> <li>Make your changes</li> <li>Submit a pull request</li> </ol>"},{"location":"development/contributing/#development-setup","title":"Development Setup","text":"<pre><code># Clone repository\ngit clone https://github.com/yourusername/authentication_test.git\ncd authentication_test\n\n# Build project\nmvn clean package\n\n# Run in development mode\nmvn liberty:dev\n</code></pre>"},{"location":"development/contributing/#code-style","title":"Code Style","text":"<ul> <li>Follow Java naming conventions</li> <li>Use meaningful variable names</li> <li>Add JavaDoc comments for public methods</li> <li>Keep methods focused and concise</li> </ul>"},{"location":"development/contributing/#testing","title":"Testing","text":"<ul> <li>Write unit tests for new features</li> <li>Ensure all tests pass before submitting PR</li> <li>Aim for 80%+ code coverage</li> </ul> <pre><code>mvn test\n</code></pre>"},{"location":"development/contributing/#documentation","title":"Documentation","text":"<ul> <li>Update documentation for new features</li> <li>Keep README.md current</li> <li>Add examples for new endpoints</li> </ul>"},{"location":"development/contributing/#pull-request-process","title":"Pull Request Process","text":"<ol> <li>Update documentation</li> <li>Add tests for new features</li> <li>Ensure build passes</li> <li>Request review from maintainers</li> </ol>"},{"location":"development/contributing/#next-steps","title":"Next Steps","text":"<ul> <li>Project Structure</li> <li>Building with Maven</li> </ul>"},{"location":"development/structure/","title":"Project Structure","text":"<p>Overview of the Authentication Test API project organization.</p>"},{"location":"development/structure/#directory-layout","title":"Directory Layout","text":"<pre><code>authentication_test/\n\u251c\u2500\u2500 .github/\n\u2502   \u2514\u2500\u2500 workflows/\n\u2502       \u2514\u2500\u2500 docs.yml              # GitHub Actions for docs deployment\n\u251c\u2500\u2500 docs/                         # MkDocs documentation\n\u2502   \u251c\u2500\u2500 mkdocs.yml               # MkDocs configuration\n\u2502   \u251c\u2500\u2500 requirements.txt         # Python dependencies for docs\n\u2502   \u2514\u2500\u2500 docs/                    # Documentation source files\n\u251c\u2500\u2500 API_server/                   # API Server application\n\u2502   \u251c\u2500\u2500 src/\n\u2502   \u2502   \u251c\u2500\u2500 main/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 java/com/example/api/\n\u2502   \u2502   \u2502   \u2502   \u251c\u2500\u2500 config/      # Configuration classes\n\u2502   \u2502   \u2502   \u2502   \u251c\u2500\u2500 model/       # Data models\n\u2502   \u2502   \u2502   \u2502   \u251c\u2500\u2500 resource/    # JAX-RS endpoints\n\u2502   \u2502   \u2502   \u2502   \u251c\u2500\u2500 service/     # Business logic\n\u2502   \u2502   \u2502   \u2502   \u2514\u2500\u2500 exception/   # Exception handlers\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 resources/\n\u2502   \u2502   \u2502   \u2502   \u2514\u2500\u2500 META-INF/\n\u2502   \u2502   \u2502   \u2502       \u2514\u2500\u2500 microprofile-config.properties\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 liberty/\n\u2502   \u2502   \u2502       \u2514\u2500\u2500 config/\n\u2502   \u2502   \u2502           \u2514\u2500\u2500 server.xml   # OpenLiberty configuration\n\u2502   \u2502   \u2514\u2500\u2500 test/\n\u2502   \u2502       \u2514\u2500\u2500 java/            # Test classes\n\u2502   \u251c\u2500\u2500 pom.xml                  # Maven configuration\n\u2502   \u251c\u2500\u2500 Containerfile            # Container build file\n\u2502   \u2514\u2500\u2500 spec.md                  # API specification\n\u2514\u2500\u2500 README.md                    # Project README\n</code></pre>"},{"location":"development/structure/#key-components","title":"Key Components","text":""},{"location":"development/structure/#configuration-config","title":"Configuration (<code>config/</code>)","text":"<ul> <li><code>ApiApplication.java</code> - JAX-RS application and OpenAPI config</li> </ul>"},{"location":"development/structure/#models-model","title":"Models (<code>model/</code>)","text":"<ul> <li><code>Schedule.java</code> - User schedule response</li> <li><code>ScheduleItem.java</code> - Individual schedule entry</li> <li><code>HelloResponse.java</code> - Health check response</li> <li><code>ErrorResponse.java</code> - Standard error format</li> </ul>"},{"location":"development/structure/#resources-resource","title":"Resources (<code>resource/</code>)","text":"<ul> <li><code>HelloResource.java</code> - Health check endpoint</li> <li><code>ScheduleResource.java</code> - Schedule endpoint (secured)</li> </ul>"},{"location":"development/structure/#services-service","title":"Services (<code>service/</code>)","text":"<ul> <li><code>ScheduleService.java</code> - Schedule generation logic</li> </ul>"},{"location":"development/structure/#exception-handling-exception","title":"Exception Handling (<code>exception/</code>)","text":"<ul> <li><code>GlobalExceptionMapper.java</code> - Centralized error handling</li> </ul>"},{"location":"development/structure/#next-steps","title":"Next Steps","text":"<ul> <li>Contributing Guide</li> <li>Building with Maven</li> </ul>"},{"location":"frontend/api-integration/","title":"API Integration Architecture","text":""},{"location":"frontend/api-integration/#critical-no-direct-api-access","title":"Critical: No Direct API Access","text":"<p>IMPORTANT: The frontend application does NOT make direct API calls to the schedule API server. All schedule data access is through the IBM watsonx Orchestrate widget.</p>"},{"location":"frontend/api-integration/#why-no-direct-api-access","title":"Why No Direct API Access?","text":""},{"location":"frontend/api-integration/#architectural-decision","title":"Architectural Decision","text":"<p>The specification explicitly states:</p> <p>\"There should be no direct integration with the schedule API. Instead, the frontend should provide access to the schedule through the Orchestrate embedded widget.\"</p>"},{"location":"frontend/api-integration/#benefits-of-this-architecture","title":"Benefits of This Architecture","text":"<ol> <li>Separation of Concerns</li> <li>Frontend: User interface and authentication</li> <li>Orchestrate: Business logic and API integration</li> <li> <p>API Server: Data access and authorization</p> </li> <li> <p>Security</p> </li> <li>No API credentials in frontend code</li> <li>Token management handled by Orchestrate</li> <li> <p>Reduced attack surface</p> </li> <li> <p>Flexibility</p> </li> <li>API changes don't require frontend updates</li> <li>Orchestrate can aggregate multiple APIs</li> <li> <p>Easy to add new data sources</p> </li> <li> <p>AI-Powered Features</p> </li> <li>Natural language interface</li> <li>Intelligent data processing</li> <li>Contextual responses</li> </ol>"},{"location":"frontend/api-integration/#correct-architecture","title":"Correct Architecture","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    Frontend Application                      \u2502\n\u2502                                                              \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502              User Interface                            \u2502 \u2502\n\u2502  \u2502                                                         \u2502 \u2502\n\u2502  \u2502  - Authentication (NextAuth + Keycloak)                \u2502 \u2502\n\u2502  \u2502  - Page routing                                        \u2502 \u2502\n\u2502  \u2502  - Orchestrate widget embedding                        \u2502 \u2502\n\u2502  \u2502  - Token exchange endpoint                             \u2502 \u2502\n\u2502  \u2502                                                         \u2502 \u2502\n\u2502  \u2502  \u274c NO direct API calls                                \u2502 \u2502\n\u2502  \u2502  \u274c NO fetch() to API server                           \u2502 \u2502\n\u2502  \u2502  \u274c NO axios/HTTP client for schedule data             \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                          \u2502\n                          \u2502 Token Exchange (RFC 8693)\n                          \u2502 User JWT passed securely\n                          \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              IBM watsonx Orchestrate                         \u2502\n\u2502                                                              \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502           Watson Assistant Chat Widget                 \u2502 \u2502\n\u2502  \u2502                                                         \u2502 \u2502\n\u2502  \u2502  - Receives user JWT from frontend                     \u2502 \u2502\n\u2502  \u2502  - Makes API calls on behalf of user                   \u2502 \u2502\n\u2502  \u2502  - Processes schedule data                             \u2502 \u2502\n\u2502  \u2502  - Provides conversational interface                   \u2502 \u2502\n\u2502  \u2502                                                         \u2502 \u2502\n\u2502  \u2502  \u2705 ONLY component that calls API                      \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                          \u2502\n                          \u2502 HTTP + JWT Bearer Token\n                          \u2502 GET /api/v1/schedule\n                          \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    API Server                                \u2502\n\u2502              http://localhost:9080                           \u2502\n\u2502                                                              \u2502\n\u2502  - Validates JWT tokens                                      \u2502\n\u2502  - Enforces role-based access control                        \u2502\n\u2502  - Returns user schedule data                                \u2502\n\u2502  - Knows nothing about Orchestrate                           \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"frontend/api-integration/#what-was-removed","title":"What Was Removed","text":"<p>During implementation, the following files were created but then removed because they violated the specification:</p>"},{"location":"frontend/api-integration/#removed-libapits","title":"\u274c Removed: <code>lib/api.ts</code>","text":"<p>This file contained direct API client code:</p> <pre><code>// \u274c INCORRECT - This was removed\nexport async function fetchSchedule(accessToken: string) {\n  const response = await fetch(`${API_URL}/api/v1/schedule`, {\n    headers: {\n      Authorization: `Bearer ${accessToken}`,\n    },\n  });\n  return response.json();\n}\n</code></pre> <p>Why removed: Frontend should never call API directly.</p>"},{"location":"frontend/api-integration/#removed-componentsuischedulepaneltsx","title":"\u274c Removed: <code>components/ui/SchedulePanel.tsx</code>","text":"<p>This component made direct API calls:</p> <pre><code>// \u274c INCORRECT - This was removed\nuseEffect(() =&gt; {\n  if (session?.accessToken) {\n    fetchSchedule(session.accessToken)\n      .then(setSchedule)\n      .catch(setError);\n  }\n}, [session]);\n</code></pre> <p>Why removed: Violated the \"no direct API integration\" requirement.</p>"},{"location":"frontend/api-integration/#correct-implementation","title":"Correct Implementation","text":""},{"location":"frontend/api-integration/#token-exchange-endpoint","title":"\u2705 Token Exchange Endpoint","text":"<p>The ONLY API-related code in the frontend is the token exchange endpoint:</p> <pre><code>// \u2705 CORRECT - app/api/token-exchange/route.ts\nexport async function POST(request: NextRequest) {\n  const session = await getServerSession(authOptions);\n\n  if (!session || !session.accessToken) {\n    return NextResponse.json(\n      { error: 'unauthorized' },\n      { status: 401 }\n    );\n  }\n\n  // Return token to Orchestrate (not to browser)\n  return NextResponse.json({\n    access_token: session.accessToken,\n    token_type: 'Bearer',\n    expires_in: 3600,\n  });\n}\n</code></pre> <p>Purpose: Securely provide user's JWT to Orchestrate widget.</p> <p>Note: This endpoint does NOT call the API server. It only returns the token.</p>"},{"location":"frontend/api-integration/#orchestrate-widget-component","title":"\u2705 Orchestrate Widget Component","text":"<p>The widget handles all schedule data access:</p> <pre><code>// \u2705 CORRECT - components/orchestrate/OrchestrateWidget.tsx\nexport default function OrchestrateWidget() {\n  useEffect(() =&gt; {\n    // Load Watson Assistant Chat widget\n    const script = document.createElement('script');\n    script.src = 'https://web-chat.global.assistant.watson.appdomain.cloud/...';\n\n    script.onload = () =&gt; {\n      window.watsonAssistantChatOptions = {\n        integrationID: process.env.NEXT_PUBLIC_ORCHESTRATE_INTEGRATION_ID,\n        region: process.env.NEXT_PUBLIC_ORCHESTRATE_REGION,\n        serviceInstanceID: process.env.NEXT_PUBLIC_ORCHESTRATE_SERVICE_INSTANCE_ID,\n        onLoad: async (instance: any) =&gt; {\n          // Get token via token exchange\n          const tokenResponse = await fetch('/api/token-exchange', {\n            method: 'POST',\n          });\n\n          const { access_token } = await tokenResponse.json();\n\n          // Pass token to Orchestrate\n          instance.updateUserPayload({\n            context: {\n              skills: {\n                'main skill': {\n                  user_defined: {\n                    jwt_token: access_token,\n                  },\n                },\n              },\n            },\n          });\n\n          await instance.render();\n        },\n      };\n\n      window.loadWatsonAssistantChat();\n    };\n\n    document.body.appendChild(script);\n  }, []);\n\n  return &lt;div id=\"watson-assistant-chat-container\" /&gt;;\n}\n</code></pre> <p>Key points: - Widget loads from Orchestrate - Token passed to widget, not used by frontend - Widget makes API calls, not frontend</p>"},{"location":"frontend/api-integration/#data-flow","title":"Data Flow","text":""},{"location":"frontend/api-integration/#schedule-data-request-flow","title":"Schedule Data Request Flow","text":"<pre><code>1. User asks widget: \"Show my schedule\"\n   \u2502\n   \u25bc\n2. Widget (Orchestrate) receives request\n   \u2502\n   \u25bc\n3. Widget uses JWT token (from token exchange)\n   \u2502\n   \u25bc\n4. Widget calls: GET http://localhost:9080/api/v1/schedule\n   \u2502  Headers: Authorization: Bearer {JWT}\n   \u25bc\n5. API server validates JWT\n   \u2502\n   \u25bc\n6. API server returns schedule data\n   \u2502\n   \u25bc\n7. Widget processes and displays data\n   \u2502\n   \u25bc\n8. User sees schedule in chat interface\n</code></pre> <p>Note: Frontend is NOT involved in steps 3-7.</p>"},{"location":"frontend/api-integration/#environment-variables","title":"Environment Variables","text":""},{"location":"frontend/api-integration/#removed-variables","title":"\u274c Removed Variables","text":"<p>These were removed because they're not needed:</p> <pre><code># \u274c REMOVED - Frontend doesn't call API\nNEXT_PUBLIC_API_URL=http://localhost:9080\n</code></pre>"},{"location":"frontend/api-integration/#current-variables","title":"\u2705 Current Variables","text":"<p>Only Orchestrate configuration is needed:</p> <pre><code># \u2705 CORRECT - For Orchestrate widget\nNEXT_PUBLIC_ORCHESTRATE_INTEGRATION_ID=...\nNEXT_PUBLIC_ORCHESTRATE_REGION=us-south\nNEXT_PUBLIC_ORCHESTRATE_SERVICE_INSTANCE_ID=...\n</code></pre>"},{"location":"frontend/api-integration/#common-misconceptions","title":"Common Misconceptions","text":""},{"location":"frontend/api-integration/#misconception-1-frontend-needs-api-url","title":"\u274c Misconception 1: \"Frontend needs API URL\"","text":"<p>Wrong: Frontend never calls API, so doesn't need API URL.</p> <p>Right: Only Orchestrate needs API URL (configured in Orchestrate console).</p>"},{"location":"frontend/api-integration/#misconception-2-need-to-handle-api-errors-in-frontend","title":"\u274c Misconception 2: \"Need to handle API errors in frontend\"","text":"<p>Wrong: Frontend doesn't make API calls, so no API errors to handle.</p> <p>Right: Widget handles API errors and shows appropriate messages.</p>"},{"location":"frontend/api-integration/#misconception-3-need-loading-states-for-api-calls","title":"\u274c Misconception 3: \"Need loading states for API calls\"","text":"<p>Wrong: Frontend doesn't make API calls, so no loading states needed.</p> <p>Right: Widget has its own loading indicators.</p>"},{"location":"frontend/api-integration/#misconception-4-need-to-cache-schedule-data","title":"\u274c Misconception 4: \"Need to cache schedule data\"","text":"<p>Wrong: Frontend doesn't receive schedule data, so nothing to cache.</p> <p>Right: Widget/Orchestrate handles caching if needed.</p>"},{"location":"frontend/api-integration/#security-implications","title":"Security Implications","text":""},{"location":"frontend/api-integration/#benefits-of-no-direct-api-access","title":"Benefits of No Direct API Access","text":"<ol> <li>No API Credentials in Frontend</li> <li>No API URL in client code</li> <li>No risk of credential exposure</li> <li> <p>Simpler security model</p> </li> <li> <p>Reduced Attack Surface</p> </li> <li>Can't bypass Orchestrate</li> <li>Can't manipulate API calls</li> <li> <p>Can't access unauthorized data</p> </li> <li> <p>Token Isolation</p> </li> <li>Token only used by Orchestrate</li> <li>Frontend never sees API responses</li> <li>Cleaner separation of concerns</li> </ol>"},{"location":"frontend/api-integration/#token-exchange-security","title":"Token Exchange Security","text":"<p>The token exchange endpoint is secure because:</p> <ol> <li>Server-side validation: Session checked on server</li> <li>No token exposure: Token not sent to browser</li> <li>Same-origin only: CORS prevents external access</li> <li>No caching: Fresh token on each request</li> </ol>"},{"location":"frontend/api-integration/#testing","title":"Testing","text":""},{"location":"frontend/api-integration/#what-to-test","title":"What to Test","text":"<p>\u2705 DO test: - Token exchange endpoint works - Widget loads correctly - User can interact with widget - Authentication flow works</p> <p>\u274c DON'T test: - Direct API calls (there are none) - API error handling (widget handles it) - Schedule data parsing (widget does it)</p>"},{"location":"frontend/api-integration/#example-tests","title":"Example Tests","text":"<pre><code>// \u2705 CORRECT - Test token exchange\ndescribe('Token Exchange', () =&gt; {\n  it('returns token for authenticated user', async () =&gt; {\n    const response = await fetch('/api/token-exchange', {\n      method: 'POST',\n      headers: { Cookie: 'session=...' },\n    });\n\n    expect(response.status).toBe(200);\n    const data = await response.json();\n    expect(data.access_token).toBeDefined();\n  });\n});\n\n// \u274c INCORRECT - Don't test direct API calls\ndescribe('Schedule API', () =&gt; {\n  it('fetches schedule', async () =&gt; {\n    // This test shouldn't exist!\n    const response = await fetch('http://localhost:9080/api/v1/schedule');\n    // ...\n  });\n});\n</code></pre>"},{"location":"frontend/api-integration/#migration-guide","title":"Migration Guide","text":"<p>If you have existing code that makes direct API calls, here's how to migrate:</p>"},{"location":"frontend/api-integration/#before-incorrect","title":"Before (Incorrect)","text":"<pre><code>// \u274c Direct API call\nconst schedule = await fetch(`${API_URL}/api/v1/schedule`, {\n  headers: { Authorization: `Bearer ${token}` },\n}).then(r =&gt; r.json());\n\nsetSchedule(schedule);\n</code></pre>"},{"location":"frontend/api-integration/#after-correct","title":"After (Correct)","text":"<pre><code>// \u2705 Use Orchestrate widget\n&lt;OrchestrateWidget /&gt;\n\n// Widget handles all API calls\n// No schedule state needed in frontend\n</code></pre>"},{"location":"frontend/api-integration/#summary","title":"Summary","text":"Aspect Frontend Orchestrate API Server Makes API calls \u274c No \u2705 Yes N/A Has API URL \u274c No \u2705 Yes N/A Handles schedule data \u274c No \u2705 Yes \u2705 Yes Uses JWT token \u2705 Yes (for auth) \u2705 Yes (for API) \u2705 Yes (validates) Shows schedule UI \u274c No \u2705 Yes \u274c No"},{"location":"frontend/api-integration/#next-steps","title":"Next Steps","text":"<ul> <li>Orchestrate Integration - Setup the widget</li> <li>Development Guide - Start building</li> <li>Authentication Guide - Understand auth flow</li> </ul>"},{"location":"frontend/api-integration/#related-documentation","title":"Related Documentation","text":"<ul> <li>Frontend Overview</li> <li>Architecture Diagram</li> <li>API Server Documentation</li> </ul>"},{"location":"frontend/authentication/","title":"Authentication Guide","text":""},{"location":"frontend/authentication/#overview","title":"Overview","text":"<p>The frontend application uses OAuth 2.0 Authorization Code Flow with Keycloak for user authentication. This guide explains how authentication works, the token flow, and how to implement authentication in your code.</p>"},{"location":"frontend/authentication/#authentication-flow","title":"Authentication Flow","text":""},{"location":"frontend/authentication/#complete-authentication-sequence","title":"Complete Authentication Sequence","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                                                          \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Browser \u2502                                                          \u2502 Keycloak \u2502\n\u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518                                                          \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518\n     \u2502                                                                    \u2502\n     \u2502 1. User clicks \"Sign In\"                                          \u2502\n     \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25b6  \u2502\n     \u2502                                                                    \u2502\n     \u2502 2. Redirect to Keycloak login page                                \u2502\n     \u2502 \u25c0\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2502\n     \u2502                                                                    \u2502\n     \u2502 3. User enters credentials                                        \u2502\n     \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25b6  \u2502\n     \u2502                                                                    \u2502\n     \u2502 4. Keycloak validates credentials                                 \u2502\n     \u2502                                                                    \u2502\n     \u2502 5. Redirect back with authorization code                          \u2502\n     \u2502 \u25c0\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2502\n     \u2502                                                                    \u2502\n\u250c\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2510                                                          \u250c\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 NextAuth\u2502                                                          \u2502 Keycloak \u2502\n\u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518                                                          \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518\n     \u2502                                                                    \u2502\n     \u2502 6. Exchange code for tokens (server-side)                         \u2502\n     \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25b6  \u2502\n     \u2502                                                                    \u2502\n     \u2502 7. Return access_token, refresh_token, id_token                   \u2502\n     \u2502 \u25c0\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2502\n     \u2502                                                                    \u2502\n     \u2502 8. Create encrypted session cookie                                \u2502\n     \u2502                                                                    \u2502\n\u250c\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2510                                                               \u2502\n\u2502 Browser \u2502                                                               \u2502\n\u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518                                                               \u2502\n     \u2502                                                                    \u2502\n     \u2502 9. Redirect to application with session                           \u2502\n     \u2502                                                                    \u2502\n     \u2502 10. Access protected pages                                        \u2502\n     \u2502                                                                    \u2502\n</code></pre>"},{"location":"frontend/authentication/#step-by-step-breakdown","title":"Step-by-Step Breakdown","text":""},{"location":"frontend/authentication/#1-initial-sign-in-request","title":"1. Initial Sign-In Request","text":"<p>User clicks the \"Sign In\" button, triggering NextAuth:</p> <pre><code>// components/auth/LoginButton.tsx\nimport { signIn } from 'next-auth/react';\n\n&lt;button onClick={() =&gt; signIn('keycloak')}&gt;\n  Sign In\n&lt;/button&gt;\n</code></pre>"},{"location":"frontend/authentication/#2-redirect-to-keycloak","title":"2. Redirect to Keycloak","text":"<p>NextAuth redirects to Keycloak's authorization endpoint:</p> <pre><code>https://keycloak.lab.home/realms/secure-test/protocol/openid-connect/auth\n  ?client_id=authentication-test-frontend\n  &amp;redirect_uri=http://localhost:3000/api/auth/callback/keycloak\n  &amp;response_type=code\n  &amp;scope=openid email profile\n</code></pre>"},{"location":"frontend/authentication/#3-user-authentication","title":"3. User Authentication","text":"<p>User enters credentials on Keycloak's login page. Keycloak validates the credentials.</p>"},{"location":"frontend/authentication/#4-authorization-code","title":"4. Authorization Code","text":"<p>Keycloak redirects back with an authorization code:</p> <pre><code>http://localhost:3000/api/auth/callback/keycloak\n  ?code=abc123...\n  &amp;state=xyz789...\n</code></pre>"},{"location":"frontend/authentication/#5-token-exchange","title":"5. Token Exchange","text":"<p>NextAuth exchanges the code for tokens (server-side):</p> <pre><code>POST https://keycloak.lab.home/realms/secure-test/protocol/openid-connect/token\nContent-Type: application/x-www-form-urlencoded\n\ngrant_type=authorization_code\n&amp;code=abc123...\n&amp;redirect_uri=http://localhost:3000/api/auth/callback/keycloak\n&amp;client_id=authentication-test-frontend\n&amp;client_secret=8u50V7iXkuibA4BvzKVoDcQ5aaAbUsTI\n</code></pre>"},{"location":"frontend/authentication/#6-token-response","title":"6. Token Response","text":"<p>Keycloak returns tokens:</p> <pre><code>{\n  \"access_token\": \"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9...\",\n  \"refresh_token\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\",\n  \"id_token\": \"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9...\",\n  \"expires_in\": 3600,\n  \"refresh_expires_in\": 1800,\n  \"token_type\": \"Bearer\"\n}\n</code></pre>"},{"location":"frontend/authentication/#7-session-creation","title":"7. Session Creation","text":"<p>NextAuth creates an encrypted session cookie containing:</p> <ul> <li>User information</li> <li>Access token</li> <li>Refresh token</li> <li>Token expiration time</li> </ul>"},{"location":"frontend/authentication/#token-management","title":"Token Management","text":""},{"location":"frontend/authentication/#access-token","title":"Access Token","text":"<p>Purpose: Authenticate API requests</p> <p>Lifetime: Typically 1 hour (3600 seconds)</p> <p>Storage: Encrypted in session cookie (server-side)</p> <p>Usage: Passed to Orchestrate via token exchange endpoint</p>"},{"location":"frontend/authentication/#refresh-token","title":"Refresh Token","text":"<p>Purpose: Obtain new access tokens without re-authentication</p> <p>Lifetime: Typically 30 minutes (1800 seconds)</p> <p>Storage: Encrypted in session cookie (server-side)</p> <p>Usage: Automatically used by NextAuth when access token expires</p>"},{"location":"frontend/authentication/#token-refresh-flow","title":"Token Refresh Flow","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                                                          \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 NextAuth\u2502                                                          \u2502 Keycloak \u2502\n\u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518                                                          \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518\n     \u2502                                                                    \u2502\n     \u2502 1. Access token expired                                           \u2502\n     \u2502                                                                    \u2502\n     \u2502 2. Use refresh token to get new access token                      \u2502\n     \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25b6  \u2502\n     \u2502                                                                    \u2502\n     \u2502 3. Return new access_token and refresh_token                      \u2502\n     \u2502 \u25c0\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2502\n     \u2502                                                                    \u2502\n     \u2502 4. Update session with new tokens                                 \u2502\n     \u2502                                                                    \u2502\n</code></pre> <p>Implementation in <code>lib/auth.ts</code>:</p> <pre><code>async function refreshAccessToken(token: ExtendedJWT): Promise&lt;ExtendedJWT&gt; {\n  try {\n    const url = `${process.env.KEYCLOAK_ISSUER}/protocol/openid-connect/token`;\n\n    const response = await fetch(url, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/x-www-form-urlencoded\",\n      },\n      body: new URLSearchParams({\n        client_id: process.env.KEYCLOAK_CLIENT_ID!,\n        client_secret: process.env.KEYCLOAK_CLIENT_SECRET!,\n        grant_type: \"refresh_token\",\n        refresh_token: token.refreshToken!,\n      }),\n    });\n\n    const refreshedTokens = await response.json();\n\n    return {\n      ...token,\n      accessToken: refreshedTokens.access_token,\n      accessTokenExpires: Date.now() + refreshedTokens.expires_in * 1000,\n      refreshToken: refreshedTokens.refresh_token ?? token.refreshToken,\n    };\n  } catch (error) {\n    return {\n      ...token,\n      error: \"RefreshAccessTokenError\",\n    };\n  }\n}\n</code></pre>"},{"location":"frontend/authentication/#oauth-20-token-exchange-rfc-8693","title":"OAuth 2.0 Token Exchange (RFC 8693)","text":""},{"location":"frontend/authentication/#purpose","title":"Purpose","text":"<p>Enable Orchestrate to access the API server on behalf of the authenticated user.</p>"},{"location":"frontend/authentication/#flow","title":"Flow","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Orchestrate\u2502                  \u2502 Frontend \u2502                  \u2502 API Server \u2502\n\u2502   Widget   \u2502                  \u2502          \u2502                  \u2502            \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518                  \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518                  \u2514\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n      \u2502                              \u2502                              \u2502\n      \u2502 1. Request user's token      \u2502                              \u2502\n      \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25b6                              \u2502\n      \u2502                              \u2502                              \u2502\n      \u2502 2. Validate session          \u2502                              \u2502\n      \u2502                              \u2502                              \u2502\n      \u2502 3. Return access_token       \u2502                              \u2502\n      \u2502\u25c0\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                              \u2502\n      \u2502                              \u2502                              \u2502\n      \u2502 4. Call API with token       \u2502                              \u2502\n      \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25b6\n      \u2502                              \u2502                              \u2502\n      \u2502                              \u2502 5. Validate JWT              \u2502\n      \u2502                              \u2502                              \u2502\n      \u2502 6. Return schedule data      \u2502                              \u2502\n      \u2502\u25c0\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n      \u2502                              \u2502                              \u2502\n</code></pre>"},{"location":"frontend/authentication/#implementation","title":"Implementation","text":"<p>Token exchange endpoint at <code>/api/token-exchange</code>:</p> <pre><code>// app/api/token-exchange/route.ts\nexport async function POST(request: NextRequest) {\n  // Get the user's session\n  const session = (await getServerSession(authOptions)) as ExtendedSession | null;\n\n  // Verify user is authenticated\n  if (!session || !session.accessToken) {\n    return NextResponse.json(\n      {\n        error: 'unauthorized',\n        error_description: 'User is not authenticated',\n      },\n      { status: 401 }\n    );\n  }\n\n  // Return the token in OAuth 2.0 Token Exchange format (RFC 8693)\n  return NextResponse.json({\n    access_token: session.accessToken,\n    issued_token_type: 'urn:ietf:params:oauth:token-type:access_token',\n    token_type: 'Bearer',\n    expires_in: session.expiresAt\n      ? Math.floor((session.expiresAt - Date.now()) / 1000)\n      : 3600,\n  });\n}\n</code></pre>"},{"location":"frontend/authentication/#using-authentication-in-code","title":"Using Authentication in Code","text":""},{"location":"frontend/authentication/#client-components","title":"Client Components","text":"<p>Check authentication status:</p> <pre><code>'use client';\n\nimport { useSession } from 'next-auth/react';\n\nexport default function MyComponent() {\n  const { data: session, status } = useSession();\n\n  if (status === 'loading') {\n    return &lt;div&gt;Loading...&lt;/div&gt;;\n  }\n\n  if (status === 'unauthenticated') {\n    return &lt;div&gt;Please sign in&lt;/div&gt;;\n  }\n\n  return &lt;div&gt;Welcome, {session?.user?.name}!&lt;/div&gt;;\n}\n</code></pre>"},{"location":"frontend/authentication/#server-components","title":"Server Components","text":"<p>Get session on server:</p> <pre><code>import { getServerSession } from 'next-auth';\nimport { authOptions } from '@/lib/auth';\n\nexport default async function MyPage() {\n  const session = await getServerSession(authOptions);\n\n  if (!session) {\n    redirect('/');\n  }\n\n  return &lt;div&gt;Welcome, {session.user?.name}!&lt;/div&gt;;\n}\n</code></pre>"},{"location":"frontend/authentication/#api-routes","title":"API Routes","text":"<p>Protect API routes:</p> <pre><code>import { getServerSession } from 'next-auth';\nimport { authOptions } from '@/lib/auth';\n\nexport async function GET(request: NextRequest) {\n  const session = await getServerSession(authOptions);\n\n  if (!session) {\n    return NextResponse.json(\n      { error: 'Unauthorized' },\n      { status: 401 }\n    );\n  }\n\n  // Process authenticated request\n  return NextResponse.json({ data: 'Protected data' });\n}\n</code></pre>"},{"location":"frontend/authentication/#middleware-route-protection","title":"Middleware (Route Protection)","text":"<p>Protect entire routes:</p> <pre><code>// middleware.ts\nexport { default } from 'next-auth/middleware';\n\nexport const config = {\n  matcher: ['/app/:path*'], // Protect all /app routes\n};\n</code></pre>"},{"location":"frontend/authentication/#sign-out","title":"Sign Out","text":""},{"location":"frontend/authentication/#client-side-sign-out","title":"Client-Side Sign Out","text":"<pre><code>import { signOut } from 'next-auth/react';\n\n&lt;button onClick={() =&gt; signOut({ callbackUrl: '/' })}&gt;\n  Sign Out\n&lt;/button&gt;\n</code></pre>"},{"location":"frontend/authentication/#what-happens-on-sign-out","title":"What Happens on Sign Out","text":"<ol> <li>NextAuth clears the session cookie</li> <li>User is redirected to home page</li> <li>Keycloak session remains active (single sign-out not implemented)</li> </ol>"},{"location":"frontend/authentication/#security-considerations","title":"Security Considerations","text":""},{"location":"frontend/authentication/#token-storage","title":"Token Storage","text":"<ul> <li>\u2705 DO: Store tokens in HTTP-only cookies (NextAuth default)</li> <li>\u274c DON'T: Store tokens in localStorage or sessionStorage</li> <li>\u274c DON'T: Expose tokens in client-side code</li> </ul>"},{"location":"frontend/authentication/#token-transmission","title":"Token Transmission","text":"<ul> <li>\u2705 DO: Use HTTPS in production</li> <li>\u2705 DO: Validate tokens on every request</li> <li>\u274c DON'T: Send tokens in URL parameters</li> <li>\u274c DON'T: Log tokens</li> </ul>"},{"location":"frontend/authentication/#session-management","title":"Session Management","text":"<ul> <li>\u2705 DO: Set appropriate session timeouts</li> <li>\u2705 DO: Implement token refresh</li> <li>\u2705 DO: Handle token expiration gracefully</li> <li>\u274c DON'T: Store sensitive data in session</li> </ul>"},{"location":"frontend/authentication/#troubleshooting","title":"Troubleshooting","text":""},{"location":"frontend/authentication/#issue-callback-url-mismatch","title":"Issue: \"Callback URL mismatch\"","text":"<p>Cause: Redirect URI not configured in Keycloak</p> <p>Solution: Add to Keycloak Valid Redirect URIs: <pre><code>http://localhost:3000/api/auth/callback/keycloak\n</code></pre></p>"},{"location":"frontend/authentication/#issue-invalid-client-credentials","title":"Issue: \"Invalid client credentials\"","text":"<p>Cause: Wrong client secret</p> <p>Solution: Verify <code>KEYCLOAK_CLIENT_SECRET</code> matches Keycloak</p>"},{"location":"frontend/authentication/#issue-token-expired","title":"Issue: \"Token expired\"","text":"<p>Cause: Access token expired and refresh failed</p> <p>Solution: User needs to sign in again</p>"},{"location":"frontend/authentication/#issue-cors-error","title":"Issue: \"CORS error\"","text":"<p>Cause: Keycloak not allowing frontend origin</p> <p>Solution: Add to Keycloak Web Origins: <pre><code>http://localhost:3000\n</code></pre></p>"},{"location":"frontend/authentication/#next-steps","title":"Next Steps","text":"<ul> <li>Orchestrate Integration - Setup the widget</li> <li>Development Guide - Start building</li> <li>API Integration - Understand the architecture</li> </ul>"},{"location":"frontend/authentication/#related-documentation","title":"Related Documentation","text":"<ul> <li>NextAuth.js Documentation</li> <li>OAuth 2.0 RFC 6749</li> <li>OAuth 2.0 Token Exchange RFC 8693</li> <li>Keycloak Documentation</li> </ul>"},{"location":"frontend/configuration/","title":"Frontend Configuration Guide","text":""},{"location":"frontend/configuration/#environment-variables","title":"Environment Variables","text":"<p>The frontend application uses environment variables for configuration. These are stored in <code>.env.local</code> (for local development) and should never be committed to version control.</p>"},{"location":"frontend/configuration/#required-environment-variables","title":"Required Environment Variables","text":""},{"location":"frontend/configuration/#keycloak-configuration","title":"Keycloak Configuration","text":""},{"location":"frontend/configuration/#keycloak_client_id","title":"<code>KEYCLOAK_CLIENT_ID</code>","text":"<ul> <li>Description: The client ID registered in Keycloak for this application</li> <li>Example: <code>authentication-test-frontend</code></li> <li>Required: Yes</li> <li>Where to find: Keycloak Admin Console \u2192 Clients \u2192 Your Client \u2192 Settings</li> </ul>"},{"location":"frontend/configuration/#keycloak_client_secret","title":"<code>KEYCLOAK_CLIENT_SECRET</code>","text":"<ul> <li>Description: The client secret for authenticating with Keycloak</li> <li>Example: <code>8u50V7iXkuibA4BvzKVoDcQ5aaAbUsTI</code></li> <li>Required: Yes</li> <li>Security: Keep this secret! Never commit to version control</li> <li>Where to find: Keycloak Admin Console \u2192 Clients \u2192 Your Client \u2192 Credentials</li> </ul>"},{"location":"frontend/configuration/#keycloak_issuer","title":"<code>KEYCLOAK_ISSUER</code>","text":"<ul> <li>Description: The Keycloak realm issuer URL</li> <li>Format: <code>https://{keycloak-host}/realms/{realm-name}</code></li> <li>Example: <code>https://keycloak.lab.home/realms/secure-test</code></li> <li>Required: Yes</li> <li>Note: Must match the issuer in JWT tokens</li> </ul>"},{"location":"frontend/configuration/#nextauth-configuration","title":"NextAuth Configuration","text":""},{"location":"frontend/configuration/#nextauth_url","title":"<code>NEXTAUTH_URL</code>","text":"<ul> <li>Description: The canonical URL of your application</li> <li>Example: <code>http://localhost:3000</code></li> <li>Required: Yes</li> <li>Production: Use your production domain (e.g., <code>https://app.lab.home</code>)</li> <li>Note: Must match the redirect URI configured in Keycloak</li> </ul>"},{"location":"frontend/configuration/#nextauth_secret","title":"<code>NEXTAUTH_SECRET</code>","text":"<ul> <li>Description: Secret key for encrypting session tokens</li> <li>Example: <code>your-random-secret-here</code></li> <li>Required: Yes</li> <li>Security: Must be a strong random string</li> <li>Generate: <code>openssl rand -base64 32</code></li> <li>Note: Change this in production!</li> </ul>"},{"location":"frontend/configuration/#ibm-watsonx-orchestrate-configuration","title":"IBM watsonx Orchestrate Configuration","text":""},{"location":"frontend/configuration/#next_public_orchestrate_integration_id","title":"<code>NEXT_PUBLIC_ORCHESTRATE_INTEGRATION_ID</code>","text":"<ul> <li>Description: The integration ID for your Orchestrate instance</li> <li>Example: <code>12345678-1234-1234-1234-123456789abc</code></li> <li>Required: Yes (for Orchestrate widget to work)</li> <li>Where to find: IBM watsonx Orchestrate console</li> <li>Note: Prefix <code>NEXT_PUBLIC_</code> makes it available in browser</li> </ul>"},{"location":"frontend/configuration/#next_public_orchestrate_region","title":"<code>NEXT_PUBLIC_ORCHESTRATE_REGION</code>","text":"<ul> <li>Description: The IBM Cloud region where Orchestrate is deployed</li> <li>Example: <code>us-south</code></li> <li>Required: Yes</li> <li>Valid values: <code>us-south</code>, <code>us-east</code>, <code>eu-gb</code>, <code>eu-de</code>, <code>jp-tok</code>, <code>au-syd</code></li> <li>Where to find: IBM watsonx Orchestrate console</li> </ul>"},{"location":"frontend/configuration/#next_public_orchestrate_service_instance_id","title":"<code>NEXT_PUBLIC_ORCHESTRATE_SERVICE_INSTANCE_ID</code>","text":"<ul> <li>Description: The service instance ID for your Orchestrate deployment</li> <li>Example: <code>abcdef12-3456-7890-abcd-ef1234567890</code></li> <li>Required: Yes</li> <li>Where to find: IBM watsonx Orchestrate console</li> </ul>"},{"location":"frontend/configuration/#complete-envlocal-example","title":"Complete .env.local Example","text":"<pre><code># =============================================================================\n# Keycloak OAuth 2.0 Configuration\n# =============================================================================\n# Client ID registered in Keycloak for this frontend application\nKEYCLOAK_CLIENT_ID=authentication-test-frontend\n\n# Client secret for authenticating with Keycloak (keep secret!)\nKEYCLOAK_CLIENT_SECRET=8u50V7iXkuibA4BvzKVoDcQ5aaAbUsTI\n\n# Keycloak realm issuer URL\n# Format: https://{keycloak-host}/realms/{realm-name}\nKEYCLOAK_ISSUER=https://keycloak.lab.home/realms/secure-test\n\n# =============================================================================\n# NextAuth.js Configuration\n# =============================================================================\n# Canonical URL of your application\n# Development: http://localhost:3000\n# Production: https://app.lab.home\nNEXTAUTH_URL=http://localhost:3000\n\n# Secret key for encrypting session tokens\n# Generate with: openssl rand -base64 32\n# IMPORTANT: Change this in production!\nNEXTAUTH_SECRET=your-random-secret-here\n\n# =============================================================================\n# IBM watsonx Orchestrate Configuration\n# =============================================================================\n# Integration ID from Orchestrate console\nNEXT_PUBLIC_ORCHESTRATE_INTEGRATION_ID=12345678-1234-1234-1234-123456789abc\n\n# IBM Cloud region where Orchestrate is deployed\n# Valid values: us-south, us-east, eu-gb, eu-de, jp-tok, au-syd\nNEXT_PUBLIC_ORCHESTRATE_REGION=us-south\n\n# Service instance ID from Orchestrate console\nNEXT_PUBLIC_ORCHESTRATE_SERVICE_INSTANCE_ID=abcdef12-3456-7890-abcd-ef1234567890\n</code></pre>"},{"location":"frontend/configuration/#environment-specific-configuration","title":"Environment-Specific Configuration","text":""},{"location":"frontend/configuration/#development-environment","title":"Development Environment","text":"<p>For local development, use <code>.env.local</code>:</p> <pre><code>NEXTAUTH_URL=http://localhost:3000\nKEYCLOAK_ISSUER=https://keycloak.lab.home/realms/secure-test\n</code></pre>"},{"location":"frontend/configuration/#production-environment","title":"Production Environment","text":"<p>For production deployment, set environment variables in your hosting platform:</p> <pre><code>NEXTAUTH_URL=https://app.lab.home\nKEYCLOAK_ISSUER=https://keycloak.lab.home/realms/secure-test\n</code></pre> <p>Important: Never use <code>.env.local</code> in production. Use your platform's environment variable management.</p>"},{"location":"frontend/configuration/#variable-prefixes","title":"Variable Prefixes","text":""},{"location":"frontend/configuration/#next_public_-prefix","title":"<code>NEXT_PUBLIC_</code> Prefix","text":"<p>Variables with this prefix are:</p> <ul> <li>Exposed to the browser: Available in client-side code</li> <li>Embedded at build time: Included in the JavaScript bundle</li> <li>Use for: Non-sensitive configuration that the browser needs</li> </ul> <p>Example: <pre><code>// Available in browser\nconst region = process.env.NEXT_PUBLIC_ORCHESTRATE_REGION;\n</code></pre></p>"},{"location":"frontend/configuration/#no-prefix","title":"No Prefix","text":"<p>Variables without prefix are:</p> <ul> <li>Server-side only: Not available in browser</li> <li>Secure: Never exposed to client</li> <li>Use for: Secrets, API keys, sensitive configuration</li> </ul> <p>Example: <pre><code>// Only available on server\nconst secret = process.env.KEYCLOAK_CLIENT_SECRET;\n</code></pre></p>"},{"location":"frontend/configuration/#validation","title":"Validation","text":"<p>The application validates required environment variables at startup. If any are missing, you'll see an error:</p> <pre><code>Error: Missing required environment variable: KEYCLOAK_CLIENT_ID\n</code></pre>"},{"location":"frontend/configuration/#security-best-practices","title":"Security Best Practices","text":""},{"location":"frontend/configuration/#1-never-commit-secrets","title":"1. Never Commit Secrets","text":"<p>Add to <code>.gitignore</code>:</p> <pre><code>.env.local\n.env*.local\n</code></pre>"},{"location":"frontend/configuration/#2-use-strong-secrets","title":"2. Use Strong Secrets","text":"<p>Generate secure random strings:</p> <pre><code># For NEXTAUTH_SECRET\nopenssl rand -base64 32\n\n# For other secrets\nopenssl rand -hex 32\n</code></pre>"},{"location":"frontend/configuration/#3-rotate-secrets-regularly","title":"3. Rotate Secrets Regularly","text":"<ul> <li>Change <code>NEXTAUTH_SECRET</code> periodically</li> <li>Rotate Keycloak client secrets</li> <li>Update all environments when rotating</li> </ul>"},{"location":"frontend/configuration/#4-limit-secret-access","title":"4. Limit Secret Access","text":"<ul> <li>Only share secrets with authorized team members</li> <li>Use secret management tools (e.g., HashiCorp Vault)</li> <li>Never send secrets via email or chat</li> </ul>"},{"location":"frontend/configuration/#5-environment-separation","title":"5. Environment Separation","text":"<ul> <li>Use different secrets for dev/staging/production</li> <li>Never use production secrets in development</li> <li>Test with non-production Keycloak realms</li> </ul>"},{"location":"frontend/configuration/#troubleshooting","title":"Troubleshooting","text":""},{"location":"frontend/configuration/#issue-invalid-client-credentials","title":"Issue: \"Invalid client credentials\"","text":"<p>Cause: <code>KEYCLOAK_CLIENT_SECRET</code> doesn't match Keycloak</p> <p>Solution: 1. Go to Keycloak Admin Console 2. Navigate to Clients \u2192 Your Client \u2192 Credentials 3. Copy the secret 4. Update <code>.env.local</code> 5. Restart dev server</p>"},{"location":"frontend/configuration/#issue-redirect-uri-mismatch","title":"Issue: \"Redirect URI mismatch\"","text":"<p>Cause: <code>NEXTAUTH_URL</code> doesn't match Keycloak redirect URI</p> <p>Solution: 1. Check <code>NEXTAUTH_URL</code> in <code>.env.local</code> 2. Go to Keycloak Admin Console 3. Navigate to Clients \u2192 Your Client \u2192 Settings 4. Add to Valid Redirect URIs: <code>{NEXTAUTH_URL}/api/auth/callback/keycloak</code> 5. Save and restart</p>"},{"location":"frontend/configuration/#issue-orchestrate-widget-not-loading","title":"Issue: \"Orchestrate widget not loading\"","text":"<p>Cause: Missing or incorrect Orchestrate configuration</p> <p>Solution: 1. Verify all <code>NEXT_PUBLIC_ORCHESTRATE_*</code> variables are set 2. Check values in Orchestrate console 3. Ensure region is correct 4. Restart dev server (required for <code>NEXT_PUBLIC_</code> changes)</p>"},{"location":"frontend/configuration/#issue-environment-variables-not-loading","title":"Issue: \"Environment variables not loading\"","text":"<p>Cause: File not named correctly or server not restarted</p> <p>Solution: 1. Ensure file is named <code>.env.local</code> (not <code>.env</code> or <code>.env.development</code>) 2. Restart dev server: <code>npm run dev</code> 3. Check for typos in variable names 4. Verify file is in <code>Frontend/</code> directory</p>"},{"location":"frontend/configuration/#advanced-configuration","title":"Advanced Configuration","text":""},{"location":"frontend/configuration/#custom-port","title":"Custom Port","text":"<p>To run on a different port:</p> <pre><code>PORT=3001 npm run dev\n</code></pre> <p>Update configuration: <pre><code>NEXTAUTH_URL=http://localhost:3001\n</code></pre></p> <p>Update Keycloak redirect URI: <pre><code>http://localhost:3001/api/auth/callback/keycloak\n</code></pre></p>"},{"location":"frontend/configuration/#https-in-development","title":"HTTPS in Development","text":"<p>For local HTTPS:</p> <ol> <li>Generate self-signed certificate</li> <li>Configure Next.js for HTTPS</li> <li>Update <code>NEXTAUTH_URL</code> to use <code>https://</code></li> <li>Update Keycloak redirect URIs</li> </ol>"},{"location":"frontend/configuration/#multiple-environments","title":"Multiple Environments","text":"<p>Create environment-specific files:</p> <ul> <li><code>.env.local</code> - Local development</li> <li><code>.env.development</code> - Development server</li> <li><code>.env.staging</code> - Staging environment</li> <li><code>.env.production</code> - Production (use platform variables instead)</li> </ul>"},{"location":"frontend/configuration/#next-steps","title":"Next Steps","text":"<p>After configuration:</p> <ol> <li>Understand Authentication Flow</li> <li>Setup Orchestrate Integration</li> <li>Start Development</li> </ol>"},{"location":"frontend/configuration/#related-documentation","title":"Related Documentation","text":"<ul> <li>Setup Guide</li> <li>Keycloak Client Setup</li> <li>Orchestrate Installation</li> </ul>"},{"location":"frontend/development/","title":"Development Guide","text":""},{"location":"frontend/development/#getting-started","title":"Getting Started","text":"<p>This guide covers development workflows, best practices, and common patterns for working with the frontend application.</p>"},{"location":"frontend/development/#development-environment","title":"Development Environment","text":""},{"location":"frontend/development/#prerequisites","title":"Prerequisites","text":"<ul> <li>Node.js 18.17 or later</li> <li>npm 9 or later</li> <li>VS Code (recommended) or your preferred editor</li> <li>Git</li> </ul>"},{"location":"frontend/development/#recommended-vs-code-extensions","title":"Recommended VS Code Extensions","text":"<pre><code>{\n  \"recommendations\": [\n    \"dbaeumer.vscode-eslint\",\n    \"esbenp.prettier-vscode\",\n    \"bradlc.vscode-tailwindcss\",\n    \"ms-vscode.vscode-typescript-next\"\n  ]\n}\n</code></pre>"},{"location":"frontend/development/#development-server","title":"Development Server","text":"<p>Start the development server:</p> <pre><code>cd Frontend\nnpm run dev\n</code></pre> <p>The server will start at http://localhost:3000 with:</p> <ul> <li>Hot Module Replacement: Changes reflect immediately</li> <li>Fast Refresh: React state preserved on edits</li> <li>Error Overlay: Compilation errors shown in browser</li> <li>Source Maps: Debug original TypeScript code</li> </ul>"},{"location":"frontend/development/#project-structure","title":"Project Structure","text":"<pre><code>Frontend/\n\u251c\u2500\u2500 app/                          # Next.js App Router\n\u2502   \u251c\u2500\u2500 api/                      # API routes\n\u2502   \u2502   \u251c\u2500\u2500 auth/                 # NextAuth endpoints\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 [...nextauth]/\n\u2502   \u2502   \u2502       \u2514\u2500\u2500 route.ts\n\u2502   \u2502   \u2514\u2500\u2500 token-exchange/       # Token exchange endpoint\n\u2502   \u2502       \u2514\u2500\u2500 route.ts\n\u2502   \u251c\u2500\u2500 app/                      # Protected application pages\n\u2502   \u2502   \u251c\u2500\u2500 layout.tsx            # App layout\n\u2502   \u2502   \u2514\u2500\u2500 page.tsx              # Main application page\n\u2502   \u251c\u2500\u2500 layout.tsx                # Root layout\n\u2502   \u251c\u2500\u2500 page.tsx                  # Home page\n\u2502   \u2514\u2500\u2500 globals.css               # Global styles\n\u2502\n\u251c\u2500\u2500 components/                   # React components\n\u2502   \u251c\u2500\u2500 auth/                     # Authentication components\n\u2502   \u2502   \u251c\u2500\u2500 LoginButton.tsx\n\u2502   \u2502   \u251c\u2500\u2500 LogoutButton.tsx\n\u2502   \u2502   \u2514\u2500\u2500 UserMenu.tsx\n\u2502   \u251c\u2500\u2500 layout/                   # Layout components\n\u2502   \u2502   \u251c\u2500\u2500 Header.tsx\n\u2502   \u2502   \u2514\u2500\u2500 Footer.tsx\n\u2502   \u251c\u2500\u2500 orchestrate/              # Orchestrate integration\n\u2502   \u2502   \u2514\u2500\u2500 OrchestrateWidget.tsx\n\u2502   \u251c\u2500\u2500 providers/                # Context providers\n\u2502   \u2502   \u2514\u2500\u2500 SessionProvider.tsx\n\u2502   \u2514\u2500\u2500 ui/                       # UI components\n\u2502       \u251c\u2500\u2500 Button.tsx\n\u2502       \u251c\u2500\u2500 Card.tsx\n\u2502       \u251c\u2500\u2500 Spinner.tsx\n\u2502       \u251c\u2500\u2500 ScheduleItem.tsx\n\u2502       \u2514\u2500\u2500 ScheduleList.tsx\n\u2502\n\u251c\u2500\u2500 lib/                          # Utility libraries\n\u2502   \u2514\u2500\u2500 auth.ts                   # NextAuth configuration\n\u2502\n\u251c\u2500\u2500 types/                        # TypeScript type definitions\n\u2502   \u251c\u2500\u2500 auth.ts                   # Authentication types\n\u2502   \u251c\u2500\u2500 components.ts             # Component prop types\n\u2502   \u2514\u2500\u2500 index.ts                  # Type exports\n\u2502\n\u251c\u2500\u2500 public/                       # Static assets\n\u2502   \u2514\u2500\u2500 ...\n\u2502\n\u251c\u2500\u2500 .env.local                    # Local environment variables\n\u251c\u2500\u2500 .env.example                  # Environment template\n\u251c\u2500\u2500 next.config.ts                # Next.js configuration\n\u251c\u2500\u2500 tailwind.config.ts            # Tailwind CSS configuration\n\u251c\u2500\u2500 tsconfig.json                 # TypeScript configuration\n\u2514\u2500\u2500 package.json                  # Dependencies and scripts\n</code></pre>"},{"location":"frontend/development/#development-workflow","title":"Development Workflow","text":""},{"location":"frontend/development/#1-create-a-new-feature","title":"1. Create a New Feature","text":"<pre><code># Create a new branch\ngit checkout -b feature/my-feature\n\n# Make changes\n# ...\n\n# Test locally\nnpm run dev\n\n# Lint code\nnpm run lint\n\n# Build for production\nnpm run build\n\n# Commit changes\ngit add .\ngit commit -m \"Add my feature\"\n\n# Push to remote\ngit push origin feature/my-feature\n</code></pre>"},{"location":"frontend/development/#2-component-development","title":"2. Component Development","text":""},{"location":"frontend/development/#creating-a-new-component","title":"Creating a New Component","text":"<pre><code>// components/ui/MyComponent.tsx\n'use client'; // If using hooks or browser APIs\n\nimport { MyComponentProps } from '@/types/components';\n\nexport default function MyComponent({ prop1, prop2 }: MyComponentProps) {\n  return (\n    &lt;div className=\"p-4 bg-white rounded-lg shadow\"&gt;\n      {/* Component content */}\n    &lt;/div&gt;\n  );\n}\n</code></pre>"},{"location":"frontend/development/#adding-component-types","title":"Adding Component Types","text":"<pre><code>// types/components.ts\nexport interface MyComponentProps {\n  prop1: string;\n  prop2?: number;\n  children?: React.ReactNode;\n}\n</code></pre>"},{"location":"frontend/development/#3-page-development","title":"3. Page Development","text":""},{"location":"frontend/development/#creating-a-new-page","title":"Creating a New Page","text":"<pre><code>// app/my-page/page.tsx\nimport { getServerSession } from 'next-auth';\nimport { authOptions } from '@/lib/auth';\nimport { redirect } from 'next/navigation';\n\nexport default async function MyPage() {\n  // Server-side authentication check\n  const session = await getServerSession(authOptions);\n\n  if (!session) {\n    redirect('/');\n  }\n\n  return (\n    &lt;div className=\"container mx-auto px-4 py-8\"&gt;\n      &lt;h1 className=\"text-3xl font-bold mb-6\"&gt;My Page&lt;/h1&gt;\n      {/* Page content */}\n    &lt;/div&gt;\n  );\n}\n</code></pre>"},{"location":"frontend/development/#adding-page-metadata","title":"Adding Page Metadata","text":"<pre><code>import { Metadata } from 'next';\n\nexport const metadata: Metadata = {\n  title: 'My Page | Authentication Test',\n  description: 'Description of my page',\n};\n</code></pre>"},{"location":"frontend/development/#4-api-route-development","title":"4. API Route Development","text":""},{"location":"frontend/development/#creating-an-api-route","title":"Creating an API Route","text":"<pre><code>// app/api/my-endpoint/route.ts\nimport { NextRequest, NextResponse } from 'next/server';\nimport { getServerSession } from 'next-auth';\nimport { authOptions } from '@/lib/auth';\n\nexport async function GET(request: NextRequest) {\n  // Validate authentication\n  const session = await getServerSession(authOptions);\n\n  if (!session) {\n    return NextResponse.json(\n      { error: 'Unauthorized' },\n      { status: 401 }\n    );\n  }\n\n  // Process request\n  return NextResponse.json({ data: 'Success' });\n}\n\nexport async function POST(request: NextRequest) {\n  // Handle POST request\n}\n</code></pre>"},{"location":"frontend/development/#coding-standards","title":"Coding Standards","text":""},{"location":"frontend/development/#typescript","title":"TypeScript","text":""},{"location":"frontend/development/#use-strict-types","title":"Use Strict Types","text":"<pre><code>// \u2705 Good\ninterface User {\n  id: string;\n  name: string;\n  email: string;\n}\n\nfunction getUser(id: string): User {\n  // ...\n}\n\n// \u274c Bad\nfunction getUser(id: any): any {\n  // ...\n}\n</code></pre>"},{"location":"frontend/development/#avoid-any","title":"Avoid <code>any</code>","text":"<pre><code>// \u2705 Good\nfunction processData(data: unknown) {\n  if (typeof data === 'string') {\n    // TypeScript knows data is string here\n  }\n}\n\n// \u274c Bad\nfunction processData(data: any) {\n  // No type safety\n}\n</code></pre>"},{"location":"frontend/development/#react-components","title":"React Components","text":""},{"location":"frontend/development/#use-functional-components","title":"Use Functional Components","text":"<pre><code>// \u2705 Good\nexport default function MyComponent({ title }: { title: string }) {\n  return &lt;h1&gt;{title}&lt;/h1&gt;;\n}\n\n// \u274c Bad (class components)\nexport default class MyComponent extends React.Component {\n  // ...\n}\n</code></pre>"},{"location":"frontend/development/#extract-complex-logic","title":"Extract Complex Logic","text":"<pre><code>// \u2705 Good\nfunction useScheduleData() {\n  const [data, setData] = useState(null);\n  // Complex logic here\n  return data;\n}\n\nexport default function MyComponent() {\n  const data = useScheduleData();\n  return &lt;div&gt;{/* Use data */}&lt;/div&gt;;\n}\n\n// \u274c Bad (all logic in component)\nexport default function MyComponent() {\n  const [data, setData] = useState(null);\n  // Lots of complex logic here\n  return &lt;div&gt;{/* Use data */}&lt;/div&gt;;\n}\n</code></pre>"},{"location":"frontend/development/#styling-with-tailwind","title":"Styling with Tailwind","text":""},{"location":"frontend/development/#use-utility-classes","title":"Use Utility Classes","text":"<pre><code>// \u2705 Good\n&lt;div className=\"flex items-center justify-between p-4 bg-white rounded-lg shadow\"&gt;\n  {/* Content */}\n&lt;/div&gt;\n\n// \u274c Bad (inline styles)\n&lt;div style={{ display: 'flex', padding: '16px', background: 'white' }}&gt;\n  {/* Content */}\n&lt;/div&gt;\n</code></pre>"},{"location":"frontend/development/#extract-repeated-patterns","title":"Extract Repeated Patterns","text":"<pre><code>// \u2705 Good\nconst cardClasses = \"p-6 bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow\";\n\n&lt;div className={cardClasses}&gt;Card 1&lt;/div&gt;\n&lt;div className={cardClasses}&gt;Card 2&lt;/div&gt;\n\n// Or create a component\n&lt;Card&gt;Card 1&lt;/Card&gt;\n&lt;Card&gt;Card 2&lt;/Card&gt;\n</code></pre>"},{"location":"frontend/development/#common-patterns","title":"Common Patterns","text":""},{"location":"frontend/development/#authentication-check","title":"Authentication Check","text":"<pre><code>// Server Component\nimport { getServerSession } from 'next-auth';\nimport { authOptions } from '@/lib/auth';\n\nconst session = await getServerSession(authOptions);\nif (!session) {\n  redirect('/');\n}\n\n// Client Component\nimport { useSession } from 'next-auth/react';\n\nconst { data: session, status } = useSession();\nif (status === 'loading') return &lt;Spinner /&gt;;\nif (status === 'unauthenticated') return &lt;LoginPrompt /&gt;;\n</code></pre>"},{"location":"frontend/development/#loading-states","title":"Loading States","text":"<pre><code>'use client';\n\nimport { useState, useEffect } from 'react';\nimport Spinner from '@/components/ui/Spinner';\n\nexport default function MyComponent() {\n  const [loading, setLoading] = useState(true);\n  const [data, setData] = useState(null);\n\n  useEffect(() =&gt; {\n    fetchData()\n      .then(setData)\n      .finally(() =&gt; setLoading(false));\n  }, []);\n\n  if (loading) return &lt;Spinner /&gt;;\n  if (!data) return &lt;div&gt;No data&lt;/div&gt;;\n\n  return &lt;div&gt;{/* Render data */}&lt;/div&gt;;\n}\n</code></pre>"},{"location":"frontend/development/#error-handling","title":"Error Handling","text":"<pre><code>'use client';\n\nimport { useState } from 'react';\n\nexport default function MyComponent() {\n  const [error, setError] = useState&lt;string | null&gt;(null);\n\n  const handleAction = async () =&gt; {\n    try {\n      setError(null);\n      await someAsyncOperation();\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'An error occurred');\n    }\n  };\n\n  return (\n    &lt;div&gt;\n      {error &amp;&amp; (\n        &lt;div className=\"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded\"&gt;\n          {error}\n        &lt;/div&gt;\n      )}\n      &lt;button onClick={handleAction}&gt;Do Something&lt;/button&gt;\n    &lt;/div&gt;\n  );\n}\n</code></pre>"},{"location":"frontend/development/#testing","title":"Testing","text":""},{"location":"frontend/development/#manual-testing-checklist","title":"Manual Testing Checklist","text":"<ul> <li>[ ] Application starts without errors</li> <li>[ ] Can sign in with Keycloak</li> <li>[ ] Can sign out</li> <li>[ ] Protected routes redirect when not authenticated</li> <li>[ ] Orchestrate widget loads</li> <li>[ ] No console errors</li> <li>[ ] Responsive design works on mobile</li> <li>[ ] All links work</li> <li>[ ] Environment variables load correctly</li> </ul>"},{"location":"frontend/development/#browser-testing","title":"Browser Testing","text":"<p>Test in multiple browsers:</p> <ul> <li>Chrome/Edge (Chromium)</li> <li>Firefox</li> <li>Safari (if on macOS)</li> </ul>"},{"location":"frontend/development/#responsive-testing","title":"Responsive Testing","text":"<p>Test at different viewport sizes:</p> <ul> <li>Mobile: 375px, 414px</li> <li>Tablet: 768px, 1024px</li> <li>Desktop: 1280px, 1920px</li> </ul>"},{"location":"frontend/development/#debugging","title":"Debugging","text":""},{"location":"frontend/development/#enable-debug-mode","title":"Enable Debug Mode","text":"<pre><code># In .env.local\nDEBUG=true\nNODE_ENV=development\n</code></pre>"},{"location":"frontend/development/#browser-devtools","title":"Browser DevTools","text":""},{"location":"frontend/development/#console-logs","title":"Console Logs","text":"<pre><code>console.log('Debug info:', data);\nconsole.error('Error:', error);\nconsole.warn('Warning:', warning);\n</code></pre>"},{"location":"frontend/development/#react-devtools","title":"React DevTools","text":"<p>Install React DevTools browser extension to:</p> <ul> <li>Inspect component tree</li> <li>View component props and state</li> <li>Profile performance</li> </ul>"},{"location":"frontend/development/#nextjs-debugging","title":"Next.js Debugging","text":""},{"location":"frontend/development/#server-logs","title":"Server Logs","text":"<p>Check terminal output for server-side errors:</p> <pre><code> \u2a2f Error: Something went wrong\n    at MyComponent (./app/page.tsx:10:5)\n</code></pre>"},{"location":"frontend/development/#build-errors","title":"Build Errors","text":"<pre><code>npm run build\n</code></pre> <p>Shows TypeScript errors and build issues.</p>"},{"location":"frontend/development/#performance-optimization","title":"Performance Optimization","text":""},{"location":"frontend/development/#image-optimization","title":"Image Optimization","text":"<pre><code>import Image from 'next/image';\n\n&lt;Image\n  src=\"/logo.png\"\n  alt=\"Logo\"\n  width={200}\n  height={50}\n  priority // For above-the-fold images\n/&gt;\n</code></pre>"},{"location":"frontend/development/#code-splitting","title":"Code Splitting","text":"<pre><code>import dynamic from 'next/dynamic';\n\nconst HeavyComponent = dynamic(() =&gt; import('./HeavyComponent'), {\n  loading: () =&gt; &lt;Spinner /&gt;,\n  ssr: false, // Disable server-side rendering if needed\n});\n</code></pre>"},{"location":"frontend/development/#memoization","title":"Memoization","text":"<pre><code>import { useMemo, useCallback } from 'react';\n\n// Memoize expensive calculations\nconst expensiveValue = useMemo(() =&gt; {\n  return computeExpensiveValue(data);\n}, [data]);\n\n// Memoize callbacks\nconst handleClick = useCallback(() =&gt; {\n  doSomething(value);\n}, [value]);\n</code></pre>"},{"location":"frontend/development/#common-issues","title":"Common Issues","text":""},{"location":"frontend/development/#issue-changes-not-reflecting","title":"Issue: Changes not reflecting","text":"<p>Solution: Restart dev server</p> <pre><code># Stop server (Ctrl+C)\nnpm run dev\n</code></pre>"},{"location":"frontend/development/#issue-typescript-errors","title":"Issue: TypeScript errors","text":"<p>Solution: Check types and run type check</p> <pre><code>npx tsc --noEmit\n</code></pre>"},{"location":"frontend/development/#issue-environment-variables-not-loading","title":"Issue: Environment variables not loading","text":"<p>Solution: Restart dev server after changing <code>.env.local</code></p>"},{"location":"frontend/development/#issue-build-fails","title":"Issue: Build fails","text":"<p>Solution: Check for TypeScript errors and fix them</p> <pre><code>npm run lint\nnpx tsc --noEmit\nnpm run build\n</code></pre>"},{"location":"frontend/development/#git-workflow","title":"Git Workflow","text":""},{"location":"frontend/development/#commit-messages","title":"Commit Messages","text":"<p>Follow conventional commits:</p> <pre><code>feat: Add new feature\nfix: Fix bug\ndocs: Update documentation\nstyle: Format code\nrefactor: Refactor code\ntest: Add tests\nchore: Update dependencies\n</code></pre>"},{"location":"frontend/development/#branch-naming","title":"Branch Naming","text":"<pre><code>feature/feature-name\nfix/bug-description\ndocs/documentation-update\nrefactor/code-improvement\n</code></pre>"},{"location":"frontend/development/#deployment","title":"Deployment","text":""},{"location":"frontend/development/#build-for-production","title":"Build for Production","text":"<pre><code>npm run build\n</code></pre>"},{"location":"frontend/development/#start-production-server","title":"Start Production Server","text":"<pre><code>npm start\n</code></pre>"},{"location":"frontend/development/#environment-variables","title":"Environment Variables","text":"<p>Set production environment variables in your hosting platform:</p> <ul> <li>Vercel: Project Settings \u2192 Environment Variables</li> <li>Netlify: Site Settings \u2192 Build &amp; Deploy \u2192 Environment</li> <li>Docker: Use environment file or <code>-e</code> flags</li> </ul>"},{"location":"frontend/development/#next-steps","title":"Next Steps","text":"<ul> <li>Authentication Guide - Understand auth flow</li> <li>Orchestrate Integration - Setup widget</li> <li>API Integration - Understand architecture</li> <li>Troubleshooting - Common issues</li> </ul>"},{"location":"frontend/development/#resources","title":"Resources","text":"<ul> <li>Next.js Documentation</li> <li>React Documentation</li> <li>TypeScript Documentation</li> <li>Tailwind CSS Documentation</li> <li>NextAuth.js Documentation</li> </ul>"},{"location":"frontend/orchestrate-integration/","title":"IBM watsonx Orchestrate Integration Guide","text":""},{"location":"frontend/orchestrate-integration/#overview","title":"Overview","text":"<p>The frontend application integrates IBM watsonx Orchestrate through an embedded Watson Assistant Chat widget. This widget provides AI-powered schedule management capabilities without requiring direct API calls from the frontend.</p>"},{"location":"frontend/orchestrate-integration/#architecture","title":"Architecture","text":""},{"location":"frontend/orchestrate-integration/#integration-flow","title":"Integration Flow","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    Frontend Application                       \u2502\n\u2502                                                               \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502\n\u2502  \u2502              Application Page (/app)                   \u2502  \u2502\n\u2502  \u2502                                                         \u2502  \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502  \u2502\n\u2502  \u2502  \u2502         OrchestrateWidget Component              \u2502  \u2502  \u2502\n\u2502  \u2502  \u2502                                                   \u2502  \u2502  \u2502\n\u2502  \u2502  \u2502  1. Loads Watson Assistant Chat script           \u2502  \u2502  \u2502\n\u2502  \u2502  \u2502  2. Initializes widget with user context         \u2502  \u2502  \u2502\n\u2502  \u2502  \u2502  3. Passes JWT via token exchange                \u2502  \u2502  \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502  \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                          \u2502\n                          \u2502 Token Exchange\n                          \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              /api/token-exchange Endpoint                     \u2502\n\u2502                                                               \u2502\n\u2502  - Validates user session                                     \u2502\n\u2502  - Returns JWT access token                                   \u2502\n\u2502  - Implements RFC 8693                                        \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                          \u2502\n                          \u2502 JWT Bearer Token\n                          \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              IBM watsonx Orchestrate                          \u2502\n\u2502                                                               \u2502\n\u2502  - Receives user JWT                                          \u2502\n\u2502  - Calls API server on behalf of user                         \u2502\n\u2502  - Returns schedule data                                      \u2502\n\u2502  - Provides conversational interface                          \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"frontend/orchestrate-integration/#configuration","title":"Configuration","text":""},{"location":"frontend/orchestrate-integration/#required-environment-variables","title":"Required Environment Variables","text":"<pre><code># Integration ID from Orchestrate console\nNEXT_PUBLIC_ORCHESTRATE_INTEGRATION_ID=12345678-1234-1234-1234-123456789abc\n\n# IBM Cloud region\nNEXT_PUBLIC_ORCHESTRATE_REGION=us-south\n\n# Service instance ID\nNEXT_PUBLIC_ORCHESTRATE_SERVICE_INSTANCE_ID=abcdef12-3456-7890-abcd-ef1234567890\n</code></pre>"},{"location":"frontend/orchestrate-integration/#obtaining-configuration-values","title":"Obtaining Configuration Values","text":"<ol> <li>Log in to IBM Cloud</li> <li>Navigate to https://cloud.ibm.com</li> <li> <p>Sign in with your IBM ID</p> </li> <li> <p>Access watsonx Orchestrate</p> </li> <li>Go to Resource List</li> <li>Find your Orchestrate instance</li> <li> <p>Click to open</p> </li> <li> <p>Get Integration ID</p> </li> <li>Navigate to Integrations</li> <li>Find your integration</li> <li> <p>Copy the Integration ID</p> </li> <li> <p>Get Region</p> </li> <li>Check your instance details</li> <li> <p>Note the region (e.g., us-south, eu-gb)</p> </li> <li> <p>Get Service Instance ID</p> </li> <li>In instance details</li> <li>Copy the Service Instance ID</li> </ol>"},{"location":"frontend/orchestrate-integration/#widget-component","title":"Widget Component","text":""},{"location":"frontend/orchestrate-integration/#implementation","title":"Implementation","text":"<p>The <code>OrchestrateWidget</code> component handles all Orchestrate integration:</p> <pre><code>// components/orchestrate/OrchestrateWidget.tsx\n'use client';\n\nimport { useSession } from 'next-auth/react';\nimport { useEffect, useRef, useState } from 'react';\n\nexport default function OrchestrateWidget() {\n  const { data: session } = useSession();\n  const [error, setError] = useState&lt;string | null&gt;(null);\n  const widgetInitialized = useRef(false);\n\n  useEffect(() =&gt; {\n    if (!session?.user || widgetInitialized.current) return;\n\n    // Check configuration\n    const integrationId = process.env.NEXT_PUBLIC_ORCHESTRATE_INTEGRATION_ID;\n    const region = process.env.NEXT_PUBLIC_ORCHESTRATE_REGION;\n    const serviceInstanceId = process.env.NEXT_PUBLIC_ORCHESTRATE_SERVICE_INSTANCE_ID;\n\n    if (!integrationId || !region || !serviceInstanceId) {\n      setError('Orchestrate configuration missing');\n      return;\n    }\n\n    // Load Watson Assistant Chat widget\n    const script = document.createElement('script');\n    script.src = `https://web-chat.global.assistant.watson.appdomain.cloud/versions/${\n      process.env.NEXT_PUBLIC_WA_VERSION || 'latest'\n    }/WatsonAssistantChatEntry.js`;\n\n    script.onload = () =&gt; {\n      window.watsonAssistantChatOptions = {\n        integrationID: integrationId,\n        region: region,\n        serviceInstanceID: serviceInstanceId,\n        onLoad: async (instance: any) =&gt; {\n          // Get user's JWT token via token exchange\n          const tokenResponse = await fetch('/api/token-exchange', {\n            method: 'POST',\n          });\n\n          if (tokenResponse.ok) {\n            const { access_token } = await tokenResponse.json();\n\n            // Pass token to Orchestrate\n            instance.updateUserPayload({\n              context: {\n                skills: {\n                  'main skill': {\n                    user_defined: {\n                      jwt_token: access_token,\n                      user_id: session.user.email,\n                    },\n                  },\n                },\n              },\n            });\n          }\n\n          await instance.render();\n        },\n      };\n\n      window.loadWatsonAssistantChat();\n      widgetInitialized.current = true;\n    };\n\n    document.body.appendChild(script);\n\n    return () =&gt; {\n      if (script.parentNode) {\n        script.parentNode.removeChild(script);\n      }\n    };\n  }, [session]);\n\n  if (error) {\n    return &lt;div className=\"text-red-600\"&gt;{error}&lt;/div&gt;;\n  }\n\n  return &lt;div id=\"watson-assistant-chat-container\" /&gt;;\n}\n</code></pre>"},{"location":"frontend/orchestrate-integration/#key-features","title":"Key Features","text":"<ol> <li>Automatic Token Management</li> <li>Fetches JWT via token exchange endpoint</li> <li>Passes token to Orchestrate securely</li> <li> <p>No token exposure in client code</p> </li> <li> <p>User Context</p> </li> <li>Passes user email/ID to Orchestrate</li> <li>Enables personalized responses</li> <li> <p>Maintains user session</p> </li> <li> <p>Error Handling</p> </li> <li>Validates configuration</li> <li>Shows user-friendly error messages</li> <li> <p>Graceful degradation</p> </li> <li> <p>Lifecycle Management</p> </li> <li>Loads widget only when authenticated</li> <li>Prevents duplicate initialization</li> <li>Cleans up on unmount</li> </ol>"},{"location":"frontend/orchestrate-integration/#widget-customization","title":"Widget Customization","text":""},{"location":"frontend/orchestrate-integration/#appearance","title":"Appearance","text":"<p>Customize widget appearance in Orchestrate console:</p> <ul> <li>Theme: Light or dark</li> <li>Colors: Primary, secondary, accent</li> <li>Position: Bottom right, bottom left, etc.</li> <li>Size: Compact, medium, large</li> <li>Avatar: Custom avatar image</li> </ul>"},{"location":"frontend/orchestrate-integration/#behavior","title":"Behavior","text":"<p>Configure widget behavior:</p> <ul> <li>Auto-open: Open automatically on page load</li> <li>Greeting: Custom greeting message</li> <li>Suggestions: Quick action buttons</li> <li>Language: Supported languages</li> </ul>"},{"location":"frontend/orchestrate-integration/#advanced-options","title":"Advanced Options","text":"<pre><code>window.watsonAssistantChatOptions = {\n  integrationID: integrationId,\n  region: region,\n  serviceInstanceID: serviceInstanceId,\n\n  // Appearance\n  carbonTheme: 'g10', // or 'g90', 'g100'\n  hideCloseButton: false,\n  showLauncher: true,\n\n  // Behavior\n  openChatByDefault: false,\n  namespaceClassPrefix: 'my-app',\n\n  // Callbacks\n  onLoad: async (instance) =&gt; {\n    // Initialize\n  },\n  onError: (error) =&gt; {\n    console.error('Widget error:', error);\n  },\n};\n</code></pre>"},{"location":"frontend/orchestrate-integration/#token-exchange","title":"Token Exchange","text":""},{"location":"frontend/orchestrate-integration/#endpoint-implementation","title":"Endpoint Implementation","text":"<p>The <code>/api/token-exchange</code> endpoint securely provides the user's JWT to Orchestrate:</p> <pre><code>// app/api/token-exchange/route.ts\nexport async function POST(request: NextRequest) {\n  const session = await getServerSession(authOptions);\n\n  if (!session || !session.accessToken) {\n    return NextResponse.json(\n      { error: 'unauthorized' },\n      { status: 401 }\n    );\n  }\n\n  return NextResponse.json({\n    access_token: session.accessToken,\n    issued_token_type: 'urn:ietf:params:oauth:token-type:access_token',\n    token_type: 'Bearer',\n    expires_in: session.expiresAt\n      ? Math.floor((session.expiresAt - Date.now()) / 1000)\n      : 3600,\n  });\n}\n</code></pre>"},{"location":"frontend/orchestrate-integration/#security","title":"Security","text":"<ul> <li>Server-side only: Token never exposed to client</li> <li>Session validation: Ensures user is authenticated</li> <li>CORS protection: Same-origin requests only</li> <li>No caching: Tokens not cached in browser</li> </ul>"},{"location":"frontend/orchestrate-integration/#usage-in-application","title":"Usage in Application","text":""},{"location":"frontend/orchestrate-integration/#application-page","title":"Application Page","text":"<pre><code>// app/app/page.tsx\nimport { getServerSession } from 'next-auth';\nimport { redirect } from 'next/navigation';\nimport OrchestrateWidget from '@/components/orchestrate/OrchestrateWidget';\n\nexport default async function ApplicationPage() {\n  const session = await getServerSession(authOptions);\n\n  if (!session) {\n    redirect('/');\n  }\n\n  return (\n    &lt;div className=\"container mx-auto px-4 py-8\"&gt;\n      &lt;h1 className=\"text-3xl font-bold mb-6\"&gt;\n        Schedule Management\n      &lt;/h1&gt;\n\n      &lt;div className=\"mb-8\"&gt;\n        &lt;OrchestrateWidget /&gt;\n      &lt;/div&gt;\n\n      &lt;div className=\"bg-blue-50 border border-blue-200 rounded-lg p-6\"&gt;\n        &lt;h2 className=\"text-xl font-semibold mb-4\"&gt;\n          How to Use\n        &lt;/h2&gt;\n        &lt;ul className=\"list-disc list-inside space-y-2\"&gt;\n          &lt;li&gt;Click the chat icon to open the assistant&lt;/li&gt;\n          &lt;li&gt;Ask about your schedule&lt;/li&gt;\n          &lt;li&gt;Request schedule updates&lt;/li&gt;\n          &lt;li&gt;Get schedule summaries&lt;/li&gt;\n        &lt;/ul&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n  );\n}\n</code></pre>"},{"location":"frontend/orchestrate-integration/#testing","title":"Testing","text":""},{"location":"frontend/orchestrate-integration/#manual-testing","title":"Manual Testing","text":"<ol> <li> <p>Widget Loads <pre><code>\u2713 Widget appears on page\n\u2713 No console errors\n\u2713 Chat icon visible\n</code></pre></p> </li> <li> <p>Authentication <pre><code>\u2713 Token exchange succeeds\n\u2713 User context passed\n\u2713 Widget initializes\n</code></pre></p> </li> <li> <p>Functionality <pre><code>\u2713 Can open/close widget\n\u2713 Can send messages\n\u2713 Receives responses\n\u2713 Schedule data displays\n</code></pre></p> </li> </ol>"},{"location":"frontend/orchestrate-integration/#debugging","title":"Debugging","text":"<p>Enable debug mode:</p> <pre><code>window.watsonAssistantChatOptions = {\n  // ... other options\n  debug: true, // Enable debug logging\n};\n</code></pre> <p>Check browser console for: - Widget initialization logs - Token exchange requests - API calls from Orchestrate - Error messages</p>"},{"location":"frontend/orchestrate-integration/#troubleshooting","title":"Troubleshooting","text":""},{"location":"frontend/orchestrate-integration/#issue-widget-not-loading","title":"Issue: Widget not loading","text":"<p>Symptoms: No chat icon appears</p> <p>Solutions: 1. Check environment variables are set 2. Verify integration ID is correct 3. Check browser console for errors 4. Ensure user is authenticated</p>"},{"location":"frontend/orchestrate-integration/#issue-configuration-missing-error","title":"Issue: \"Configuration missing\" error","text":"<p>Symptoms: Error message displayed instead of widget</p> <p>Solutions: 1. Verify all <code>NEXT_PUBLIC_ORCHESTRATE_*</code> variables are set 2. Restart dev server (required for <code>NEXT_PUBLIC_</code> changes) 3. Check <code>.env.local</code> file exists</p>"},{"location":"frontend/orchestrate-integration/#issue-token-exchange-fails","title":"Issue: Token exchange fails","text":"<p>Symptoms: Widget loads but doesn't work</p> <p>Solutions: 1. Check user is authenticated 2. Verify <code>/api/token-exchange</code> endpoint works 3. Check browser network tab for 401 errors 4. Ensure session is valid</p>"},{"location":"frontend/orchestrate-integration/#issue-widget-shows-but-no-responses","title":"Issue: Widget shows but no responses","text":"<p>Symptoms: Can send messages but no replies</p> <p>Solutions: 1. Verify Orchestrate is configured correctly 2. Check Orchestrate has access to API server 3. Verify API server is running 4. Check API server logs for errors</p>"},{"location":"frontend/orchestrate-integration/#best-practices","title":"Best Practices","text":""},{"location":"frontend/orchestrate-integration/#1-error-handling","title":"1. Error Handling","text":"<p>Always handle widget errors gracefully:</p> <pre><code>onError: (error) =&gt; {\n  console.error('Widget error:', error);\n  // Show user-friendly message\n  setError('Unable to load assistant. Please refresh.');\n}\n</code></pre>"},{"location":"frontend/orchestrate-integration/#2-loading-states","title":"2. Loading States","text":"<p>Show loading indicator while widget initializes:</p> <pre><code>const [loading, setLoading] = useState(true);\n\nonLoad: async (instance) =&gt; {\n  // Initialize...\n  setLoading(false);\n}\n</code></pre>"},{"location":"frontend/orchestrate-integration/#3-cleanup","title":"3. Cleanup","text":"<p>Always cleanup on component unmount:</p> <pre><code>return () =&gt; {\n  if (script.parentNode) {\n    script.parentNode.removeChild(script);\n  }\n};\n</code></pre>"},{"location":"frontend/orchestrate-integration/#4-token-refresh","title":"4. Token Refresh","text":"<p>Handle token expiration:</p> <pre><code>// Refresh token before passing to widget\nconst tokenResponse = await fetch('/api/token-exchange', {\n  method: 'POST',\n});\n\nif (!tokenResponse.ok) {\n  // Token expired, user needs to re-authenticate\n  signOut({ callbackUrl: '/' });\n}\n</code></pre>"},{"location":"frontend/orchestrate-integration/#next-steps","title":"Next Steps","text":"<ul> <li>API Integration - Understand the architecture</li> <li>Development Guide - Start building</li> <li>Troubleshooting - Common issues</li> </ul>"},{"location":"frontend/orchestrate-integration/#related-documentation","title":"Related Documentation","text":"<ul> <li>Watson Assistant Documentation</li> <li>watsonx Orchestrate Documentation</li> <li>Authentication Guide</li> </ul>"},{"location":"frontend/overview/","title":"Frontend Overview","text":""},{"location":"frontend/overview/#introduction","title":"Introduction","text":"<p>The Authentication Test Frontend is a Next.js 15 application that provides a modern, secure web interface for accessing user schedules through IBM watsonx Orchestrate. The application demonstrates proper OAuth 2.0 authentication with Keycloak and follows best practices for token management and security.</p>"},{"location":"frontend/overview/#architecture","title":"Architecture","text":""},{"location":"frontend/overview/#high-level-architecture","title":"High-Level Architecture","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                     User's Browser                          \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502\n\u2502  \u2502           Next.js Frontend Application                \u2502  \u2502\n\u2502  \u2502                                                        \u2502  \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502  \u2502\n\u2502  \u2502  \u2502  Home Page   \u2502         \u2502  Application Page    \u2502   \u2502  \u2502\n\u2502  \u2502  \u2502  (Public)    \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25b6\u2502  (Protected)         \u2502   \u2502  \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2502                      \u2502   \u2502  \u2502\n\u2502  \u2502                           \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502   \u2502  \u2502\n\u2502  \u2502                           \u2502  \u2502   Orchestrate  \u2502  \u2502   \u2502  \u2502\n\u2502  \u2502                           \u2502  \u2502     Widget     \u2502  \u2502   \u2502  \u2502\n\u2502  \u2502                           \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502   \u2502  \u2502\n\u2502  \u2502                           \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502  \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                          \u2502\n                          \u2502 OAuth 2.0 Authentication\n                          \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    Keycloak Server                          \u2502\n\u2502              https://keycloak.lab.home                      \u2502\n\u2502                                                             \u2502\n\u2502  - User Authentication                                      \u2502\n\u2502  - JWT Token Issuance                                       \u2502\n\u2502  - Token Refresh                                            \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                          \u2502\n                          \u2502 JWT Bearer Token\n                          \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              IBM watsonx Orchestrate                        \u2502\n\u2502                                                             \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502\n\u2502  \u2502  Orchestrate Widget (Embedded in Frontend)            \u2502  \u2502\n\u2502  \u2502                                                        \u2502  \u2502\n\u2502  \u2502  - Receives user JWT via Token Exchange               \u2502  \u2502\n\u2502  \u2502  - Makes API calls on behalf of user                  \u2502  \u2502\n\u2502  \u2502  - Displays schedule data                             \u2502  \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                          \u2502\n                          \u2502 HTTP + JWT Bearer Token\n                          \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    API Server                               \u2502\n\u2502              http://localhost:9080                          \u2502\n\u2502                                                             \u2502\n\u2502  - Validates JWT tokens                                     \u2502\n\u2502  - Enforces role-based access control                       \u2502\n\u2502  - Returns user schedule data                               \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"frontend/overview/#key-architectural-principles","title":"Key Architectural Principles","text":"<ol> <li> <p>No Direct API Access: The frontend NEVER calls the API server directly. All schedule data access is through the Orchestrate widget.</p> </li> <li> <p>Token Exchange Pattern: The frontend implements OAuth 2.0 Token Exchange (RFC 8693) to securely pass the user's JWT to Orchestrate.</p> </li> <li> <p>Separation of Concerns:</p> </li> <li>Frontend: User interface and authentication</li> <li>Orchestrate: Business logic and API integration</li> <li>API Server: Data access and authorization</li> </ol>"},{"location":"frontend/overview/#technology-stack","title":"Technology Stack","text":""},{"location":"frontend/overview/#core-technologies","title":"Core Technologies","text":"<ul> <li>Next.js 15: React framework with App Router</li> <li>TypeScript: Type-safe development</li> <li>Tailwind CSS: Utility-first styling</li> <li>NextAuth.js 4.24: Authentication library</li> </ul>"},{"location":"frontend/overview/#authentication","title":"Authentication","text":"<ul> <li>Keycloak: OAuth 2.0 / OpenID Connect provider</li> <li>JWT: JSON Web Tokens for stateless authentication</li> <li>OAuth 2.0 Token Exchange (RFC 8693): Secure token delegation</li> </ul>"},{"location":"frontend/overview/#integration","title":"Integration","text":"<ul> <li>IBM watsonx Orchestrate: AI-powered widget for schedule management</li> <li>Watson Assistant Chat Widget: Embedded conversational interface</li> </ul>"},{"location":"frontend/overview/#key-features","title":"Key Features","text":""},{"location":"frontend/overview/#1-secure-authentication","title":"1. Secure Authentication","text":"<ul> <li>OAuth 2.0 Authorization Code Flow with Keycloak</li> <li>Automatic token refresh</li> <li>Secure session management</li> <li>Protected routes</li> </ul>"},{"location":"frontend/overview/#2-orchestrate-integration","title":"2. Orchestrate Integration","text":"<ul> <li>Embedded Watson Assistant Chat widget</li> <li>Token exchange for secure API access</li> <li>User context passing</li> <li>Configurable integration settings</li> </ul>"},{"location":"frontend/overview/#3-responsive-design","title":"3. Responsive Design","text":"<ul> <li>Mobile-first approach</li> <li>Tailwind CSS for consistent styling</li> <li>Accessible components</li> <li>Modern UI/UX</li> </ul>"},{"location":"frontend/overview/#4-developer-experience","title":"4. Developer Experience","text":"<ul> <li>TypeScript for type safety</li> <li>ESLint for code quality</li> <li>Hot module replacement</li> <li>Clear project structure</li> </ul>"},{"location":"frontend/overview/#project-structure","title":"Project Structure","text":"<pre><code>Frontend/\n\u251c\u2500\u2500 app/                          # Next.js App Router\n\u2502   \u251c\u2500\u2500 api/                      # API routes\n\u2502   \u2502   \u251c\u2500\u2500 auth/                 # NextAuth endpoints\n\u2502   \u2502   \u2514\u2500\u2500 token-exchange/       # Token exchange endpoint\n\u2502   \u251c\u2500\u2500 app/                      # Protected application pages\n\u2502   \u2502   \u251c\u2500\u2500 layout.tsx            # App layout\n\u2502   \u2502   \u2514\u2500\u2500 page.tsx              # Main application page\n\u2502   \u251c\u2500\u2500 layout.tsx                # Root layout\n\u2502   \u2514\u2500\u2500 page.tsx                  # Home page\n\u251c\u2500\u2500 components/                   # React components\n\u2502   \u251c\u2500\u2500 auth/                     # Authentication components\n\u2502   \u251c\u2500\u2500 layout/                   # Layout components\n\u2502   \u251c\u2500\u2500 orchestrate/              # Orchestrate widget\n\u2502   \u251c\u2500\u2500 providers/                # Context providers\n\u2502   \u2514\u2500\u2500 ui/                       # UI components\n\u251c\u2500\u2500 lib/                          # Utility libraries\n\u2502   \u2514\u2500\u2500 auth.ts                   # NextAuth configuration\n\u251c\u2500\u2500 types/                        # TypeScript type definitions\n\u2502   \u251c\u2500\u2500 auth.ts                   # Authentication types\n\u2502   \u251c\u2500\u2500 components.ts             # Component prop types\n\u2502   \u2514\u2500\u2500 index.ts                  # Type exports\n\u251c\u2500\u2500 docs/                         # Project documentation\n\u251c\u2500\u2500 .env.example                  # Environment variable template\n\u251c\u2500\u2500 .env.local                    # Local environment variables\n\u251c\u2500\u2500 next.config.ts                # Next.js configuration\n\u251c\u2500\u2500 tailwind.config.ts            # Tailwind CSS configuration\n\u2514\u2500\u2500 tsconfig.json                 # TypeScript configuration\n</code></pre>"},{"location":"frontend/overview/#security-considerations","title":"Security Considerations","text":""},{"location":"frontend/overview/#authentication-security","title":"Authentication Security","text":"<ul> <li>All tokens stored in HTTP-only cookies (managed by NextAuth)</li> <li>No tokens in localStorage or sessionStorage</li> <li>Automatic token refresh before expiration</li> <li>Secure session management</li> </ul>"},{"location":"frontend/overview/#api-security","title":"API Security","text":"<ul> <li>No direct API calls from frontend</li> <li>All API access through Orchestrate widget</li> <li>Token exchange endpoint validates user session</li> <li>CORS properly configured</li> </ul>"},{"location":"frontend/overview/#best-practices","title":"Best Practices","text":"<ul> <li>Environment variables for sensitive configuration</li> <li>Type-safe code with TypeScript</li> <li>Input validation and sanitization</li> <li>Secure headers and CSP policies</li> </ul>"},{"location":"frontend/overview/#getting-started","title":"Getting Started","text":"<p>To get started with the frontend application:</p> <ol> <li>Setup Guide - Installation and initial configuration</li> <li>Configuration Guide - Environment variables and settings</li> <li>Authentication Guide - Understanding the auth flow</li> <li>Orchestrate Integration - Widget setup and usage</li> </ol>"},{"location":"frontend/overview/#related-documentation","title":"Related Documentation","text":"<ul> <li>API Server Documentation</li> <li>Keycloak Setup</li> <li>Orchestrate Documentation</li> </ul>"},{"location":"frontend/overview/#support","title":"Support","text":"<p>For issues, questions, or contributions, please refer to:</p> <ul> <li>Troubleshooting Guide</li> <li>Development Guide</li> <li>Project README</li> </ul>"},{"location":"frontend/setup/","title":"Frontend Setup Guide","text":""},{"location":"frontend/setup/#prerequisites","title":"Prerequisites","text":"<p>Before setting up the frontend application, ensure you have:</p> <ul> <li>Node.js: Version 18.17 or later</li> <li>npm: Version 9 or later (comes with Node.js)</li> <li>Keycloak: Running instance at <code>https://keycloak.lab.home</code></li> <li>API Server: Running at <code>http://localhost:9080</code></li> <li>Git: For cloning the repository</li> </ul>"},{"location":"frontend/setup/#installation-steps","title":"Installation Steps","text":""},{"location":"frontend/setup/#1-navigate-to-frontend-directory","title":"1. Navigate to Frontend Directory","text":"<pre><code>cd Frontend\n</code></pre>"},{"location":"frontend/setup/#2-install-dependencies","title":"2. Install Dependencies","text":"<pre><code>npm install\n</code></pre> <p>This will install all required packages including:</p> <ul> <li>Next.js 15</li> <li>React 19</li> <li>NextAuth.js 4.24</li> <li>Tailwind CSS</li> <li>TypeScript</li> <li>And all other dependencies</li> </ul>"},{"location":"frontend/setup/#3-configure-keycloak-client","title":"3. Configure Keycloak Client","text":"<p>Before configuring the frontend, you need to create a Keycloak client. Choose your preferred method:</p> Manual Setup (UI)Automated Setup (REST API) <p>Follow the Frontend Client Setup Guide to create the client manually through the Keycloak Admin Console.</p> <p>Time: ~5 minutes</p> <p>Use the Keycloak REST API to create the client automatically:</p> <pre><code># Step 1: Get admin access token\nTOKEN=$(curl -s -X POST \"https://keycloak.lab.home/realms/master/protocol/openid-connect/token\" \\\n  -H \"Content-Type: application/x-www-form-urlencoded\" \\\n  -d \"username=admin\" \\\n  -d \"password=your-admin-password\" \\\n  -d \"grant_type=password\" \\\n  -d \"client_id=admin-cli\" \\\n  | python3 -c \"import sys, json; print(json.load(sys.stdin)['access_token'])\")\n\n# Step 2: Create frontend client\ncurl -X POST \"https://keycloak.lab.home/admin/realms/secure-test/clients\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"clientId\": \"authentication-test-frontend\",\n    \"name\": \"Authentication Test Frontend\",\n    \"description\": \"Next.js frontend application\",\n    \"enabled\": true,\n    \"protocol\": \"openid-connect\",\n    \"publicClient\": false,\n    \"clientAuthenticatorType\": \"client-secret\",\n    \"standardFlowEnabled\": true,\n    \"directAccessGrantsEnabled\": true,\n    \"rootUrl\": \"http://localhost:3000\",\n    \"baseUrl\": \"http://localhost:3000\",\n    \"redirectUris\": [\n      \"http://localhost:3000/*\",\n      \"http://localhost:3000/api/auth/callback/keycloak\",\n      \"https://app.lab.home/*\",\n      \"https://app.lab.home/api/auth/callback/keycloak\"\n    ],\n    \"webOrigins\": [\n      \"http://localhost:3000\",\n      \"https://app.lab.home\"\n    ],\n    \"attributes\": {\n      \"pkce.code.challenge.method\": \"S256\"\n    }\n  }'\n\n# Step 3: Get client secret\nCLIENT_UUID=$(curl -s \"https://keycloak.lab.home/admin/realms/secure-test/clients?clientId=authentication-test-frontend\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  | python3 -c \"import sys, json; print(json.load(sys.stdin)[0]['id'])\")\n\ncurl -s \"https://keycloak.lab.home/admin/realms/secure-test/clients/$CLIENT_UUID/client-secret\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  | python3 -c \"import sys, json; print('Client Secret:', json.load(sys.stdin)['value'])\"\n</code></pre> <p>Time: ~2 minutes</p> <p>Automated Setup</p> <p>Copy the client secret from the output for the next step.</p>"},{"location":"frontend/setup/#4-configure-environment-variables","title":"4. Configure Environment Variables","text":"<p>Copy the example environment file:</p> <pre><code>cp .env.local.example .env.local\n</code></pre> <p>Edit <code>.env.local</code> with your configuration:</p> <pre><code># Keycloak Configuration\nKEYCLOAK_ID=authentication-test-frontend\nKEYCLOAK_SECRET=&lt;client-secret-from-keycloak&gt;\nKEYCLOAK_ISSUER=https://keycloak.lab.home/realms/secure-test\n\n# NextAuth Configuration\nNEXTAUTH_URL=http://localhost:3000\nNEXTAUTH_SECRET=&lt;generate-with-openssl-rand-base64-32&gt;\n\n# API Server Configuration\nNEXT_PUBLIC_API_URL=http://localhost:9080\n\n# IBM watsonx Orchestrate Configuration (Optional)\n# NEXT_PUBLIC_ORCHESTRATE_INTEGRATION_ID=your-integration-id\n# NEXT_PUBLIC_ORCHESTRATE_REGION=us-south\n# NEXT_PUBLIC_ORCHESTRATE_SERVICE_INSTANCE_ID=your-service-instance-id\n</code></pre> <p>See the Configuration Guide for detailed information about each variable.</p>"},{"location":"frontend/setup/#5-generate-nextauth-secret","title":"5. Generate NextAuth Secret","text":"<p>Generate a secure random secret for NextAuth:</p> <pre><code>openssl rand -base64 32\n</code></pre> <p>Copy the output and set it as <code>NEXTAUTH_SECRET</code> in <code>.env.local</code>.</p>"},{"location":"frontend/setup/#running-the-application","title":"Running the Application","text":""},{"location":"frontend/setup/#development-mode","title":"Development Mode","text":"<p>Start the development server:</p> <pre><code>npm run dev\n</code></pre> <p>The application will be available at:</p> <ul> <li>URL: http://localhost:3000</li> <li>Hot Reload: Enabled</li> <li>Source Maps: Enabled</li> </ul>"},{"location":"frontend/setup/#production-build","title":"Production Build","text":"<p>Build the application for production:</p> <pre><code>npm run build\n</code></pre> <p>Start the production server:</p> <pre><code>npm start\n</code></pre>"},{"location":"frontend/setup/#linting","title":"Linting","text":"<p>Run ESLint to check code quality:</p> <pre><code>npm run lint\n</code></pre>"},{"location":"frontend/setup/#verification-steps","title":"Verification Steps","text":""},{"location":"frontend/setup/#1-check-application-startup","title":"1. Check Application Startup","text":"<p>After running <code>npm run dev</code>, you should see:</p> <pre><code>  \u25b2 Next.js 15.x.x\n  - Local:        http://localhost:3000\n  - Network:      http://192.168.x.x:3000\n\n \u2713 Ready in 2.5s\n</code></pre>"},{"location":"frontend/setup/#2-access-home-page","title":"2. Access Home Page","text":"<p>Navigate to http://localhost:3000</p> <p>You should see:</p> <ul> <li>Application title and description</li> <li>\"Sign In\" button</li> <li>No errors in browser console</li> </ul>"},{"location":"frontend/setup/#3-test-authentication","title":"3. Test Authentication","text":"<p>Click \"Sign In\" button:</p> <ol> <li>Should redirect to Keycloak login page</li> <li>Enter valid credentials</li> <li>Should redirect back to application</li> <li>Should see user menu with your name</li> <li>Should have access to <code>/app</code> page</li> </ol>"},{"location":"frontend/setup/#4-verify-orchestrate-widget","title":"4. Verify Orchestrate Widget","text":"<p>After signing in, navigate to http://localhost:3000/app</p> <p>You should see:</p> <ul> <li>Orchestrate widget placeholder (if not configured)</li> <li>OR Watson Assistant Chat widget (if configured)</li> <li>No console errors</li> </ul>"},{"location":"frontend/setup/#common-setup-issues","title":"Common Setup Issues","text":""},{"location":"frontend/setup/#issue-module-not-found-errors","title":"Issue: \"Module not found\" errors","text":"<p>Solution: Delete <code>node_modules</code> and reinstall:</p> <pre><code>rm -rf node_modules package-lock.json\nnpm install\n</code></pre>"},{"location":"frontend/setup/#issue-port-3000-already-in-use","title":"Issue: Port 3000 already in use","text":"<p>Solution: Use a different port:</p> <pre><code>PORT=3001 npm run dev\n</code></pre> <p>Don't forget to update <code>NEXTAUTH_URL</code> and Keycloak redirect URIs.</p>"},{"location":"frontend/setup/#issue-keycloak-connection-refused","title":"Issue: Keycloak connection refused","text":"<p>Solution: Verify Keycloak is running:</p> <pre><code>curl https://keycloak.lab.home/realms/secure-test/.well-known/openid-configuration\n</code></pre>"},{"location":"frontend/setup/#issue-nextauth-callback-error","title":"Issue: NextAuth callback error","text":"<p>Solution: Verify redirect URI in Keycloak matches exactly:</p> <ul> <li>Keycloak: <code>http://localhost:3000/api/auth/callback/keycloak</code></li> <li>Must include protocol, host, port, and full path</li> </ul>"},{"location":"frontend/setup/#issue-environment-variables-not-loading","title":"Issue: Environment variables not loading","text":"<p>Solution: Ensure <code>.env.local</code> exists and restart dev server:</p> <pre><code># Verify file exists\nls -la .env.local\n\n# Restart server\nnpm run dev\n</code></pre>"},{"location":"frontend/setup/#project-structure-after-setup","title":"Project Structure After Setup","text":"<pre><code>Frontend/\n\u251c\u2500\u2500 node_modules/              # Installed dependencies\n\u251c\u2500\u2500 .next/                     # Next.js build output\n\u251c\u2500\u2500 app/                       # Application code\n\u251c\u2500\u2500 components/                # React components\n\u251c\u2500\u2500 lib/                       # Utility libraries\n\u251c\u2500\u2500 types/                     # TypeScript types\n\u251c\u2500\u2500 public/                    # Static assets\n\u251c\u2500\u2500 .env.local                 # Local environment variables (gitignored)\n\u251c\u2500\u2500 .env.example               # Environment template\n\u251c\u2500\u2500 package.json               # Dependencies and scripts\n\u251c\u2500\u2500 package-lock.json          # Locked dependency versions\n\u251c\u2500\u2500 next.config.ts             # Next.js configuration\n\u251c\u2500\u2500 tailwind.config.ts         # Tailwind configuration\n\u2514\u2500\u2500 tsconfig.json              # TypeScript configuration\n</code></pre>"},{"location":"frontend/setup/#next-steps","title":"Next Steps","text":"<p>After successful setup:</p> <ol> <li>Configure Environment Variables - Detailed configuration guide</li> <li>Understand Authentication - Learn about the auth flow</li> <li>Setup Orchestrate Integration - Configure the widget</li> <li>Development Guide - Start developing</li> </ol>"},{"location":"frontend/setup/#additional-resources","title":"Additional Resources","text":"<ul> <li>Next.js Documentation</li> <li>NextAuth.js Documentation</li> <li>Tailwind CSS Documentation</li> <li>TypeScript Documentation</li> </ul>"},{"location":"frontend/setup/#getting-help","title":"Getting Help","text":"<p>If you encounter issues:</p> <ol> <li>Check Troubleshooting Guide</li> <li>Review Common Issues</li> <li>Check browser console for errors</li> <li>Check terminal output for server errors</li> <li>Verify all prerequisites are met</li> </ol>"},{"location":"getting-started/overview/","title":"Overview","text":"<p>The Authentication Test API is a modern, secure RESTful API server designed to demonstrate best practices for building enterprise-grade Java applications with OAuth 2.0 authentication.</p>"},{"location":"getting-started/overview/#what-is-authentication-test-api","title":"What is Authentication Test API?","text":"<p>This API provides a simple yet complete example of:</p> <ul> <li>Secure Authentication - OAuth 2.0 with JWT tokens via Keycloak</li> <li>Role-Based Authorization - Fine-grained access control</li> <li>RESTful Design - Clean, predictable API endpoints</li> <li>Enterprise Standards - Jakarta EE 10 and MicroProfile 6.1</li> <li>Cloud-Native - Containerized deployment with OpenLiberty</li> </ul>"},{"location":"getting-started/overview/#use-cases","title":"Use Cases","text":"<p>The Authentication Test API is ideal for:</p> <ul> <li>Learning - Understanding OAuth 2.0 and JWT authentication</li> <li>Prototyping - Quick start for new secure API projects</li> <li>Reference - Best practices for Java enterprise applications</li> <li>Testing - Validating authentication and authorization flows</li> </ul>"},{"location":"getting-started/overview/#core-concepts","title":"Core Concepts","text":""},{"location":"getting-started/overview/#authentication-flow","title":"Authentication Flow","text":"<pre><code>sequenceDiagram\n    participant Client\n    participant API\n    participant Keycloak\n\n    Client-&gt;&gt;Keycloak: 1. Request token (username/password)\n    Keycloak-&gt;&gt;Client: 2. Return JWT token\n    Client-&gt;&gt;API: 3. API request with JWT token\n    API-&gt;&gt;Keycloak: 4. Validate token (JWKS)\n    Keycloak-&gt;&gt;API: 5. Token valid\n    API-&gt;&gt;Client: 6. Return response</code></pre>"},{"location":"getting-started/overview/#key-components","title":"Key Components","text":""},{"location":"getting-started/overview/#1-openliberty-server","title":"1. OpenLiberty Server","text":"<p>Lightweight, cloud-native Java application server that provides: - Fast startup times - Small memory footprint - Full Jakarta EE and MicroProfile support</p>"},{"location":"getting-started/overview/#2-keycloak","title":"2. Keycloak","text":"<p>Open-source Identity and Access Management solution providing: - OAuth 2.0 and OpenID Connect - User management - Role-based access control - Token management</p>"},{"location":"getting-started/overview/#3-microprofile-jwt","title":"3. MicroProfile JWT","text":"<p>Specification for using JWT tokens in microservices: - Token validation - Claims extraction - Role mapping</p>"},{"location":"getting-started/overview/#api-structure","title":"API Structure","text":""},{"location":"getting-started/overview/#base-path","title":"Base Path","text":"<p>All API endpoints are prefixed with <code>/api/v1</code></p>"},{"location":"getting-started/overview/#endpoints","title":"Endpoints","text":"Endpoint Method Auth Required Description <code>/api/v1/hello</code> GET No Health check <code>/api/v1/schedule</code> GET Yes User schedule"},{"location":"getting-started/overview/#authentication","title":"Authentication","text":"<p>Protected endpoints require: 1. Valid JWT token in <code>Authorization</code> header 2. Token format: <code>Bearer &lt;token&gt;</code> 3. Required role: <code>schedule-user</code></p>"},{"location":"getting-started/overview/#security-model","title":"Security Model","text":""},{"location":"getting-started/overview/#token-based-authentication","title":"Token-Based Authentication","text":"<ul> <li>JWT tokens issued by Keycloak</li> <li>Tokens contain user identity and roles</li> <li>Tokens are cryptographically signed</li> <li>API validates signature using Keycloak's public key</li> </ul>"},{"location":"getting-started/overview/#role-based-authorization","title":"Role-Based Authorization","text":"<ul> <li>Users must have <code>schedule-user</code> role</li> <li>Roles are checked on each request</li> <li>Missing roles result in 403 Forbidden</li> </ul>"},{"location":"getting-started/overview/#next-steps","title":"Next Steps","text":"<ol> <li>Check Prerequisites - Ensure you have required tools</li> <li>Quick Start - Get the API running</li> <li>Build with Maven - Learn the build process</li> <li>Setup Keycloak - Configure authentication</li> </ol>"},{"location":"getting-started/prerequisites/","title":"Prerequisites","text":"<p>Before you begin, ensure you have the following tools and software installed on your system.</p>"},{"location":"getting-started/prerequisites/#required-software","title":"Required Software","text":""},{"location":"getting-started/prerequisites/#java-development-kit-jdk-21","title":"Java Development Kit (JDK) 21+","text":"<p>The application requires Java 21 or later.</p> macOSLinuxWindows <pre><code># Using Homebrew\nbrew install openjdk@21\n\n# Verify installation\njava -version\n</code></pre> <pre><code># Ubuntu/Debian\nsudo apt update\nsudo apt install openjdk-21-jdk\n\n# RHEL/Fedora\nsudo dnf install java-21-openjdk-devel\n\n# Verify installation\njava -version\n</code></pre> <p>Download and install from Adoptium or Oracle</p> <p>Verify installation in PowerShell: <pre><code>java -version\n</code></pre></p>"},{"location":"getting-started/prerequisites/#apache-maven-39","title":"Apache Maven 3.9+","text":"<p>Maven is required for building the application.</p> macOSLinuxWindows <pre><code># Using Homebrew\nbrew install maven\n\n# Verify installation\nmvn -version\n</code></pre> <pre><code># Ubuntu/Debian\nsudo apt update\nsudo apt install maven\n\n# RHEL/Fedora\nsudo dnf install maven\n\n# Verify installation\nmvn -version\n</code></pre> <p>Download from Apache Maven</p> <ol> <li>Extract to <code>C:\\Program Files\\Maven</code></li> <li>Add <code>C:\\Program Files\\Maven\\bin</code> to PATH</li> <li>Verify in PowerShell: <pre><code>mvn -version\n</code></pre></li> </ol>"},{"location":"getting-started/prerequisites/#container-runtime-optional","title":"Container Runtime (Optional)","text":"<p>For containerized deployment, install either Podman or Docker.</p> Podman (Recommended)Docker <p>macOS: <pre><code>brew install podman\npodman machine init\npodman machine start\n</code></pre></p> <p>Linux: <pre><code># Ubuntu/Debian\nsudo apt update\nsudo apt install podman\n\n# RHEL/Fedora\nsudo dnf install podman\n</code></pre></p> <p>Verify: <pre><code>podman --version\n</code></pre></p> <p>macOS/Windows: Download Docker Desktop</p> <p>Linux: <pre><code># Ubuntu/Debian\ncurl -fsSL https://get.docker.com -o get-docker.sh\nsudo sh get-docker.sh\n\n# Add user to docker group\nsudo usermod -aG docker $USER\n</code></pre></p> <p>Verify: <pre><code>docker --version\n</code></pre></p>"},{"location":"getting-started/prerequisites/#keycloak-server","title":"Keycloak Server","text":"<p>You need access to a Keycloak server for authentication.</p> <p>Option 1: Use Existing Keycloak - URL: <code>https://keycloak.lab.home</code> - Admin access required for realm configuration</p> <p>Option 2: Run Keycloak Locally</p> Using PodmanUsing Docker <pre><code>podman run -d \\\n  --name keycloak \\\n  -p 8080:8080 \\\n  -e KEYCLOAK_ADMIN=admin \\\n  -e KEYCLOAK_ADMIN_PASSWORD=admin \\\n  quay.io/keycloak/keycloak:latest \\\n  start-dev\n</code></pre> <pre><code>docker run -d \\\n  --name keycloak \\\n  -p 8080:8080 \\\n  -e KEYCLOAK_ADMIN=admin \\\n  -e KEYCLOAK_ADMIN_PASSWORD=admin \\\n  quay.io/keycloak/keycloak:latest \\\n  start-dev\n</code></pre> <p>Access Keycloak at: <code>http://localhost:8080</code></p>"},{"location":"getting-started/prerequisites/#optional-tools","title":"Optional Tools","text":""},{"location":"getting-started/prerequisites/#git","title":"Git","text":"<p>For version control and cloning the repository.</p> macOSLinuxWindows <pre><code>brew install git\n</code></pre> <pre><code># Ubuntu/Debian\nsudo apt install git\n\n# RHEL/Fedora\nsudo dnf install git\n</code></pre> <p>Download from Git for Windows</p>"},{"location":"getting-started/prerequisites/#curl","title":"curl","text":"<p>For testing API endpoints.</p> macOS/LinuxWindows <p>Usually pre-installed. Verify with: <pre><code>curl --version\n</code></pre></p> <p>Included in Windows 10+ or download from curl.se</p>"},{"location":"getting-started/prerequisites/#jq","title":"jq","text":"<p>For formatting JSON responses.</p> macOSLinuxWindows <pre><code>brew install jq\n</code></pre> <pre><code># Ubuntu/Debian\nsudo apt install jq\n\n# RHEL/Fedora\nsudo dnf install jq\n</code></pre> <p>Download from stedolan.github.io/jq</p>"},{"location":"getting-started/prerequisites/#system-requirements","title":"System Requirements","text":""},{"location":"getting-started/prerequisites/#minimum-requirements","title":"Minimum Requirements","text":"<ul> <li>CPU: 2 cores</li> <li>RAM: 2 GB</li> <li>Disk: 1 GB free space</li> <li>OS: macOS 10.15+, Linux (any modern distro), Windows 10+</li> </ul>"},{"location":"getting-started/prerequisites/#recommended-requirements","title":"Recommended Requirements","text":"<ul> <li>CPU: 4 cores</li> <li>RAM: 4 GB</li> <li>Disk: 5 GB free space</li> <li>Network: Internet connection for downloading dependencies</li> </ul>"},{"location":"getting-started/prerequisites/#verification-checklist","title":"Verification Checklist","text":"<p>Before proceeding, verify all required tools are installed:</p> <ul> <li>[ ] Java 21+ installed (<code>java -version</code>)</li> <li>[ ] Maven 3.9+ installed (<code>mvn -version</code>)</li> <li>[ ] Container runtime installed (optional) (<code>podman --version</code> or <code>docker --version</code>)</li> <li>[ ] Keycloak server accessible</li> <li>[ ] Git installed (optional) (<code>git --version</code>)</li> <li>[ ] curl installed (optional) (<code>curl --version</code>)</li> </ul>"},{"location":"getting-started/prerequisites/#next-steps","title":"Next Steps","text":"<p>Once all prerequisites are met:</p> <ol> <li>Quick Start Guide - Get the API running quickly</li> <li>Building with Maven - Learn the build process</li> <li>Keycloak Setup - Configure authentication</li> </ol>"},{"location":"getting-started/prerequisites/#troubleshooting","title":"Troubleshooting","text":""},{"location":"getting-started/prerequisites/#java-version-issues","title":"Java Version Issues","text":"<p>If you have multiple Java versions installed:</p> <pre><code># Check all installed versions\n/usr/libexec/java_home -V  # macOS\nupdate-alternatives --config java  # Linux\n\n# Set JAVA_HOME\nexport JAVA_HOME=$(/usr/libexec/java_home -v 21)  # macOS\nexport JAVA_HOME=/usr/lib/jvm/java-21-openjdk  # Linux\n</code></pre>"},{"location":"getting-started/prerequisites/#maven-issues","title":"Maven Issues","text":"<p>If Maven can't find Java:</p> <pre><code># Set JAVA_HOME before running Maven\nexport JAVA_HOME=/path/to/java21\nmvn -version\n</code></pre>"},{"location":"getting-started/prerequisites/#container-runtime-issues","title":"Container Runtime Issues","text":"<p>If Podman machine won't start:</p> <pre><code>podman machine stop\npodman machine rm\npodman machine init\npodman machine start\n</code></pre> <p>For more help, see Troubleshooting Guide.</p>"},{"location":"getting-started/quick-start/","title":"Quick Start Guide","text":"<p>Get the Authentication Test API up and running in just a few minutes.</p>"},{"location":"getting-started/quick-start/#step-1-clone-or-download","title":"Step 1: Clone or Download","text":"<p>If you have the source code, navigate to the project directory:</p> <pre><code>cd authentication_test/API_server\n</code></pre>"},{"location":"getting-started/quick-start/#step-2-build-the-application","title":"Step 2: Build the Application","text":"<p>Build the application using Maven:</p> <pre><code>cd API_server\nmvn clean package\n</code></pre> <p>This will: - Compile the Java source code - Run tests - Package the application as a WAR file - Output: <code>target/authentication-test-api.war</code></p> <p>Expected output: <pre><code>[INFO] BUILD SUCCESS\n[INFO] Total time: 45.123 s\n</code></pre></p>"},{"location":"getting-started/quick-start/#step-3-run-with-maven-development","title":"Step 3: Run with Maven (Development)","text":"<p>The fastest way to run the application for development:</p> <pre><code>cd API_server\nmvn liberty:dev\n</code></pre> <p>This starts the server in development mode with: - Hot reload on code changes - Automatic test execution - Debug port on 7777</p> <p>Wait for: <pre><code>[INFO] CWWKF0011I: The authTestServer server is ready to run a smarter planet.\n</code></pre></p> <p>The API is now available at: - HTTP: <code>http://localhost:9080</code> - HTTPS: <code>https://localhost:9443</code></p>"},{"location":"getting-started/quick-start/#step-4-test-the-health-endpoint","title":"Step 4: Test the Health Endpoint","text":"<p>Open a new terminal and test the public health endpoint:</p> <pre><code>curl http://localhost:9080/api/v1/hello\n</code></pre> <p>Expected response: <pre><code>{\n  \"hostname\": \"your-hostname\",\n  \"serverTime\": \"2026-01-27T17:00:00Z\",\n  \"apiVersion\": \"1.0.0\",\n  \"status\": \"healthy\"\n}\n</code></pre></p> <p>\u2705 Success! The API is running.</p>"},{"location":"getting-started/quick-start/#step-5-setup-keycloak-required-for-protected-endpoints","title":"Step 5: Setup Keycloak (Required for Protected Endpoints)","text":"<p>To access the protected <code>/api/v1/schedule</code> endpoint, you need to configure Keycloak.</p>"},{"location":"getting-started/quick-start/#quick-keycloak-setup","title":"Quick Keycloak Setup","text":"<ol> <li>Start Keycloak (if not already running):</li> </ol> PodmanDocker <pre><code>podman run -d \\\n  --name keycloak \\\n  -p 8080:8080 \\\n  -e KEYCLOAK_ADMIN=admin \\\n  -e KEYCLOAK_ADMIN_PASSWORD=admin \\\n  quay.io/keycloak/keycloak:latest \\\n  start-dev\n</code></pre> <pre><code>docker run -d \\\n  --name keycloak \\\n  -p 8080:8080 \\\n  -e KEYCLOAK_ADMIN=admin \\\n  -e KEYCLOAK_ADMIN_PASSWORD=admin \\\n  quay.io/keycloak/keycloak:latest \\\n  start-dev\n</code></pre> <ol> <li>Access Keycloak Admin Console:</li> <li>URL: <code>http://localhost:8080</code></li> <li>Username: <code>admin</code></li> <li> <p>Password: <code>admin</code></p> </li> <li> <p>Follow the detailed setup:</p> </li> <li>Realm Configuration</li> <li>Client Configuration</li> <li>User Management</li> </ol>"},{"location":"getting-started/quick-start/#step-6-get-a-jwt-token","title":"Step 6: Get a JWT Token","text":"<p>Once Keycloak is configured, obtain a JWT token:</p> <pre><code>curl -X POST http://localhost:8080/realms/secure-test/protocol/openid-connect/token \\\n  -H \"Content-Type: application/x-www-form-urlencoded\" \\\n  -d \"client_id=authentication-test-api\" \\\n  -d \"client_secret=YOUR_CLIENT_SECRET\" \\\n  -d \"grant_type=password\" \\\n  -d \"username=testuser1\" \\\n  -d \"password=password123\"\n</code></pre> <p>Extract the <code>access_token</code> from the response.</p>"},{"location":"getting-started/quick-start/#step-7-test-protected-endpoint","title":"Step 7: Test Protected Endpoint","text":"<p>Use the JWT token to access the schedule endpoint:</p> <pre><code>curl http://localhost:9080/api/v1/schedule \\\n  -H \"Authorization: Bearer YOUR_JWT_TOKEN\"\n</code></pre> <p>Expected response: <pre><code>{\n  \"user\": \"testuser1\",\n  \"schedule\": [\n    {\n      \"date\": \"2026-01-28\",\n      \"time\": \"09:00\",\n      \"description\": \"Team standup meeting\"\n    },\n    {\n      \"date\": \"2026-01-28\",\n      \"time\": \"14:30\",\n      \"description\": \"Code review session\"\n    }\n  ]\n}\n</code></pre></p> <p>\u2705 Success! You've made an authenticated API call.</p>"},{"location":"getting-started/quick-start/#alternative-run-with-container","title":"Alternative: Run with Container","text":"<p>Instead of Maven, you can run the application in a container:</p>"},{"location":"getting-started/quick-start/#build-container-image","title":"Build Container Image","text":"PodmanDocker <pre><code>cd API_server\npodman build -t authentication-test-api:1.0.0 .\n</code></pre> <pre><code>cd API_server\ndocker build -t authentication-test-api:1.0.0 .\n</code></pre>"},{"location":"getting-started/quick-start/#run-container","title":"Run Container","text":"PodmanDocker <pre><code>podman run -d \\\n  --name auth-api \\\n  -p 9080:9080 \\\n  -p 9443:9443 \\\n  -e JWT_JWKS_URI=http://localhost:8080/realms/secure-test/protocol/openid-connect/certs \\\n  -e JWT_ISSUER=http://localhost:8080/realms/secure-test \\\n  authentication-test-api:1.0.0\n</code></pre> <pre><code>docker run -d \\\n  --name auth-api \\\n  -p 9080:9080 \\\n  -p 9443:9443 \\\n  -e JWT_JWKS_URI=http://localhost:8080/realms/secure-test/protocol/openid-connect/certs \\\n  -e JWT_ISSUER=http://localhost:8080/realms/secure-test \\\n  authentication-test-api:1.0.0\n</code></pre>"},{"location":"getting-started/quick-start/#view-openapi-documentation","title":"View OpenAPI Documentation","text":"<p>Access the interactive API documentation:</p> <ul> <li>Swagger UI: <code>http://localhost:9080/openapi/ui</code></li> <li>OpenAPI JSON: <code>http://localhost:9080/openapi</code></li> </ul>"},{"location":"getting-started/quick-start/#stopping-the-application","title":"Stopping the Application","text":""},{"location":"getting-started/quick-start/#maven-development-mode","title":"Maven Development Mode","text":"<p>Press <code>Ctrl+C</code> in the terminal running <code>mvn liberty:dev</code></p>"},{"location":"getting-started/quick-start/#container","title":"Container","text":"PodmanDocker <pre><code>podman stop auth-api\npodman rm auth-api\n</code></pre> <pre><code>docker stop auth-api\ndocker rm auth-api\n</code></pre>"},{"location":"getting-started/quick-start/#next-steps","title":"Next Steps","text":"<p>Now that you have the API running:</p> <ol> <li>Explore API Endpoints - Learn about all available endpoints</li> <li>Configure Keycloak - Detailed authentication setup</li> <li>Build for Production - Production build and deployment</li> <li>Troubleshooting - Solutions to common problems</li> </ol>"},{"location":"getting-started/quick-start/#common-issues","title":"Common Issues","text":""},{"location":"getting-started/quick-start/#port-already-in-use","title":"Port Already in Use","text":"<p>If port 9080 is already in use:</p> <pre><code># Find process using port 9080\nlsof -i :9080  # macOS/Linux\nnetstat -ano | findstr :9080  # Windows\n\n# Kill the process or change the port in server.xml\n</code></pre>"},{"location":"getting-started/quick-start/#keycloak-connection-failed","title":"Keycloak Connection Failed","text":"<p>Ensure Keycloak is running and accessible:</p> <pre><code>curl http://localhost:8080\n</code></pre>"},{"location":"getting-started/quick-start/#build-failures","title":"Build Failures","text":"<p>Clean and rebuild:</p> <pre><code>mvn clean install -U\n</code></pre> <p>For more help, see the Troubleshooting Guide.</p>"},{"location":"keycloak/client-setup/","title":"Client Configuration","text":"<p>This guide explains how to configure the <code>authentication-test-api</code> client in Keycloak for OAuth 2.0 authentication.</p>"},{"location":"keycloak/client-setup/#what-is-a-client","title":"What is a Client?","text":"<p>In Keycloak, a client represents an application that wants to use Keycloak for authentication. For our API, the client configuration defines:</p> <ul> <li>How the API validates JWT tokens</li> <li>Which authentication flows are allowed</li> <li>Token settings and lifespans</li> <li>Valid redirect URIs</li> </ul>"},{"location":"keycloak/client-setup/#prerequisites","title":"Prerequisites","text":"<ul> <li>Keycloak installed and running</li> <li><code>secure-test</code> realm created</li> <li>Access to Keycloak Admin Console</li> </ul>"},{"location":"keycloak/client-setup/#step-1-create-client","title":"Step 1: Create Client","text":"Admin ConsoleREST API <ol> <li>Select \"secure-test\" realm from dropdown</li> <li>Go to \"Clients\" in left menu</li> <li>Click \"Create client\"</li> <li>Enter Client Details:<ul> <li>Client type: <code>OpenID Connect</code></li> <li>Client ID: <code>authentication-test-api</code></li> </ul> </li> <li> <p>Click \"Next\"</p> </li> <li> <p>Configure Capability:</p> <ul> <li>Client authentication: \u2713 ON (confidential client)</li> <li>Authorization: \u2717 OFF</li> <li>Authentication flow:</li> <li>\u2713 Standard flow</li> <li>\u2713 Direct access grants</li> <li>\u2717 Implicit flow</li> <li>\u2717 Service accounts roles</li> </ul> </li> <li> <p>Click \"Next\"</p> </li> <li> <p>Configure Login Settings:</p> <ul> <li>Root URL: <code>http://localhost:9080</code></li> <li>Home URL: <code>http://localhost:9080</code></li> <li>Valid redirect URIs:</li> <li><code>http://localhost:9080/*</code></li> <li><code>https://localhost:9443/*</code></li> <li>Valid post logout redirect URIs: <code>+</code> (use root URL)</li> <li>Web origins:</li> <li><code>http://localhost:9080</code></li> <li><code>https://localhost:9443</code></li> </ul> </li> <li>Click \"Save\"</li> </ol> <pre><code># Get admin token\nTOKEN=$(curl -X POST http://localhost:8080/realms/master/protocol/openid-connect/token \\\n  -H \"Content-Type: application/x-www-form-urlencoded\" \\\n  -d \"username=admin\" \\\n  -d \"password=admin\" \\\n  -d \"grant_type=password\" \\\n  -d \"client_id=admin-cli\" \\\n  | jq -r '.access_token')\n\n# Create client\ncurl -X POST http://localhost:8080/admin/realms/secure-test/clients \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"clientId\": \"authentication-test-api\",\n    \"name\": \"Authentication Test API\",\n    \"description\": \"RESTful API with OAuth 2.0 authentication\",\n    \"enabled\": true,\n    \"clientAuthenticatorType\": \"client-secret\",\n    \"redirectUris\": [\n      \"http://localhost:9080/*\",\n      \"https://localhost:9443/*\"\n    ],\n    \"webOrigins\": [\n      \"http://localhost:9080\",\n      \"https://localhost:9443\"\n    ],\n    \"publicClient\": false,\n    \"protocol\": \"openid-connect\",\n    \"standardFlowEnabled\": true,\n    \"directAccessGrantsEnabled\": true,\n    \"serviceAccountsEnabled\": false\n  }'\n</code></pre>"},{"location":"keycloak/client-setup/#step-2-get-client-secret","title":"Step 2: Get Client Secret","text":"<p>The client secret is required for the API to validate tokens.</p> Admin ConsoleREST API <ol> <li>Go to \"Clients\"</li> <li>Click \"authentication-test-api\"</li> <li>Go to \"Credentials\" tab</li> <li>Copy the \"Client secret\"</li> </ol> <p>Save this secret - you'll need it for the API configuration.</p> <pre><code># Get client secret\ncurl -X GET \"http://localhost:8080/admin/realms/secure-test/clients/$(curl -X GET http://localhost:8080/admin/realms/secure-test/clients \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  | jq -r '.[] | select(.clientId==\"authentication-test-api\") | .id')/client-secret\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  | jq -r '.value'\n</code></pre>"},{"location":"keycloak/client-setup/#step-3-configure-client-settings","title":"Step 3: Configure Client Settings","text":""},{"location":"keycloak/client-setup/#settings-tab","title":"Settings Tab","text":"<ol> <li>Go to \"Clients\" \u2192 \"authentication-test-api\" \u2192 \"Settings\"</li> <li>Configure:</li> <li>Client ID: <code>authentication-test-api</code> (read-only)</li> <li>Name: <code>Authentication Test API</code></li> <li>Description: <code>RESTful API with OAuth 2.0 authentication</code></li> <li>Always display in console: \u2717</li> <li>Consent required: \u2717</li> <li>Login theme: (leave empty)</li> <li>Client authentication: \u2713 ON</li> <li> <p>Authorization: \u2717 OFF</p> </li> <li> <p>Authentication flow:</p> </li> <li>\u2713 Standard flow (Authorization Code)</li> <li>\u2713 Direct access grants (Resource Owner Password)</li> <li>\u2717 Implicit flow</li> <li>\u2717 Service accounts roles</li> <li> <p>\u2717 OAuth 2.0 Device Authorization Grant</p> </li> <li> <p>Click \"Save\"</p> </li> </ol>"},{"location":"keycloak/client-setup/#access-settings","title":"Access Settings","text":"<ol> <li>Still in \"Settings\" tab, scroll to \"Access settings\"</li> <li>Configure:</li> <li>Root URL: <code>http://localhost:9080</code></li> <li>Home URL: <code>http://localhost:9080</code></li> <li>Valid redirect URIs:      <pre><code>http://localhost:9080/*\nhttps://localhost:9443/*\n</code></pre></li> <li>Valid post logout redirect URIs: <code>+</code></li> <li>Web origins:      <pre><code>http://localhost:9080\nhttps://localhost:9443\n</code></pre></li> <li> <p>Admin URL: (leave empty)</p> </li> <li> <p>Click \"Save\"</p> </li> </ol>"},{"location":"keycloak/client-setup/#advanced-settings","title":"Advanced Settings","text":"<ol> <li>Scroll to \"Advanced\" section</li> <li>Configure Token Settings:</li> <li>Access Token Lifespan: (leave empty to use realm default)</li> <li>Client Session Idle: (leave empty)</li> <li>Client Session Max: (leave empty)</li> <li>Client Offline Session Idle: (leave empty)</li> <li> <p>Client Offline Session Max: (leave empty)</p> </li> <li> <p>OAuth 2.0 Mutual TLS Certificate Bound Access Tokens: \u2717</p> </li> <li>OIDC CIBA Grant: \u2717</li> <li>Click \"Save\"</li> </ol>"},{"location":"keycloak/client-setup/#step-4-configure-roles","title":"Step 4: Configure Roles","text":"<p>Map the realm role to the client.</p>"},{"location":"keycloak/client-setup/#client-roles-mapping","title":"Client Roles Mapping","text":"<ol> <li>Go to \"Clients\" \u2192 \"authentication-test-api\" \u2192 \"Client scopes\"</li> <li>Click \"authentication-test-api-dedicated\"</li> <li>Go to \"Mappers\" tab</li> <li>Click \"Add mapper\" \u2192 \"By configuration\"</li> <li>Select \"User Realm Role\"</li> <li>Configure:</li> <li>Name: <code>realm-roles</code></li> <li>Mapper Type: <code>User Realm Role</code></li> <li>Multivalued: \u2713 ON</li> <li>Token Claim Name: <code>realm_access.roles</code></li> <li>Claim JSON Type: <code>String</code></li> <li>Add to ID token: \u2713 ON</li> <li>Add to access token: \u2713 ON</li> <li> <p>Add to userinfo: \u2713 ON</p> </li> <li> <p>Click \"Save\"</p> </li> </ol> <p>This ensures the <code>schedule-user</code> role appears in the JWT token.</p> <p>Testing Client Configuration</p> <p>To test the client configuration with actual tokens, you'll need to create users first. See the User Management guide, then return to test token generation.</p>"},{"location":"keycloak/client-setup/#step-5-configure-api-environment","title":"Step 5: Configure API Environment","text":"<p>Update your API configuration with the client details:</p>"},{"location":"keycloak/client-setup/#environment-variables","title":"Environment Variables","text":"<pre><code>export JWT_JWKS_URI=http://localhost:8080/realms/secure-test/protocol/openid-connect/certs\nexport JWT_ISSUER=http://localhost:8080/realms/secure-test\nexport KEYCLOAK_CLIENT_ID=authentication-test-api\nexport KEYCLOAK_CLIENT_SECRET=YOUR_CLIENT_SECRET\n</code></pre>"},{"location":"keycloak/client-setup/#microprofile-config","title":"MicroProfile Config","text":"<p>Update <code>src/main/resources/META-INF/microprofile-config.properties</code>:</p> <pre><code>mp.jwt.verify.publickey.location=http://localhost:8080/realms/secure-test/protocol/openid-connect/certs\nmp.jwt.verify.issuer=http://localhost:8080/realms/secure-test\nkeycloak.client.id=authentication-test-api\n</code></pre>"},{"location":"keycloak/client-setup/#advanced-configuration","title":"Advanced Configuration","text":""},{"location":"keycloak/client-setup/#cors-configuration","title":"CORS Configuration","text":"<p>If your API needs to handle CORS:</p> <ol> <li>Go to \"Clients\" \u2192 \"authentication-test-api\" \u2192 \"Settings\"</li> <li>Scroll to \"Web origins\"</li> <li>Add allowed origins:    <pre><code>http://localhost:3000\nhttps://app.example.com\n</code></pre></li> <li>Click \"Save\"</li> </ol>"},{"location":"keycloak/client-setup/#token-lifespan","title":"Token Lifespan","text":"<p>Customize token lifespan for this client:</p> <ol> <li>Go to \"Clients\" \u2192 \"authentication-test-api\" \u2192 \"Advanced\" tab</li> <li>Set \"Access Token Lifespan\": <code>10 Minutes</code></li> <li>Click \"Save\"</li> </ol>"},{"location":"keycloak/client-setup/#audience","title":"Audience","text":"<p>Add audience claim to tokens:</p> <ol> <li>Go to \"Clients\" \u2192 \"authentication-test-api\" \u2192 \"Client scopes\"</li> <li>Click \"authentication-test-api-dedicated\"</li> <li>Go to \"Mappers\" tab</li> <li>Click \"Add mapper\" \u2192 \"By configuration\"</li> <li>Select \"Audience\"</li> <li>Configure:</li> <li>Name: <code>audience</code></li> <li>Included Client Audience: <code>authentication-test-api</code></li> <li>Add to access token: \u2713 ON</li> <li>Click \"Save\"</li> </ol>"},{"location":"keycloak/client-setup/#troubleshooting","title":"Troubleshooting","text":""},{"location":"keycloak/client-setup/#invalid-client-credentials","title":"Invalid Client Credentials","text":"<p>If you get \"invalid_client\" error:</p> <ol> <li>Verify client ID is correct</li> <li>Check client secret matches</li> <li>Ensure client authentication is enabled</li> </ol>"},{"location":"keycloak/client-setup/#token-missing-roles","title":"Token Missing Roles","text":"<p>If JWT token doesn't contain roles:</p> <ol> <li>Verify realm role mapper is configured</li> <li>Check user has the <code>schedule-user</code> role</li> <li>Ensure mapper is added to access token</li> </ol>"},{"location":"keycloak/client-setup/#cors-errors","title":"CORS Errors","text":"<p>If you get CORS errors:</p> <ol> <li>Add frontend origin to \"Web origins\"</li> <li>Ensure origin matches exactly (including protocol and port)</li> <li>Check browser console for specific CORS error</li> </ol>"},{"location":"keycloak/client-setup/#next-steps","title":"Next Steps","text":"<ul> <li>User Management - Create test users</li> <li>API Authentication - Use tokens with the API</li> <li>Troubleshooting - Common issues</li> </ul>"},{"location":"keycloak/client-setup/#additional-resources","title":"Additional Resources","text":"<ul> <li>Keycloak Client Configuration</li> <li>OAuth 2.0 Flows</li> <li>OpenID Connect</li> </ul>"},{"location":"keycloak/frontend-client-setup/","title":"Frontend Client Configuration","text":"<p>This guide explains how to configure the <code>authentication-test-frontend</code> client in Keycloak for the Next.js frontend application.</p>"},{"location":"keycloak/frontend-client-setup/#overview","title":"Overview","text":"<p>The frontend application requires its own OAuth 2.0 client in Keycloak, separate from the API server client. This client handles user authentication via the Authorization Code Flow with PKCE.</p>"},{"location":"keycloak/frontend-client-setup/#prerequisites","title":"Prerequisites","text":"<ul> <li>Keycloak installed and running</li> <li><code>secure-test</code> realm created</li> <li>Access to Keycloak Admin Console</li> <li>Admin credentials for Keycloak</li> </ul>"},{"location":"keycloak/frontend-client-setup/#client-configuration","title":"Client Configuration","text":""},{"location":"keycloak/frontend-client-setup/#step-1-create-frontend-client","title":"Step 1: Create Frontend Client","text":"Admin Console (Manual)REST API (Automated) <ol> <li> <p>Log into Keycloak Admin Console</p> <ul> <li>URL: <code>https://keycloak.lab.home/admin</code></li> <li>Select realm: secure-test</li> </ul> </li> <li> <p>Navigate to Clients</p> <ul> <li>Click Clients in the left sidebar</li> <li>Click Create client button</li> </ul> </li> <li> <p>General Settings</p> <ul> <li>Client type: <code>OpenID Connect</code></li> <li>Client ID: <code>authentication-test-frontend</code></li> <li>Click Next</li> </ul> </li> <li> <p>Capability Config</p> <ul> <li>Client authentication: \u2713 ON (Confidential client)</li> <li>Authorization: \u2717 OFF</li> <li>Authentication flow:<ul> <li>\u2713 Standard flow (Authorization Code Flow)</li> <li>\u2713 Direct access grants (Optional, for testing)</li> <li>\u2717 Implicit flow</li> <li>\u2717 Service account roles</li> </ul> </li> <li>Click Next</li> </ul> </li> <li> <p>Login Settings</p> <ul> <li>Root URL: <code>http://localhost:3000</code></li> <li>Home URL: <code>http://localhost:3000</code></li> <li>Valid redirect URIs:     <pre><code>http://localhost:3000/*\nhttp://localhost:3000/api/auth/callback/keycloak\nhttps://app.lab.home/*\nhttps://app.lab.home/api/auth/callback/keycloak\n</code></pre></li> <li>Valid post logout redirect URIs:     <pre><code>http://localhost:3000\nhttps://app.lab.home\n</code></pre></li> <li>Web origins (for CORS):     <pre><code>http://localhost:3000\nhttps://app.lab.home\n</code></pre></li> <li>Click Save</li> </ul> </li> <li> <p>Get Client Secret</p> <ul> <li>Go to Credentials tab</li> <li>Copy the Client Secret value</li> <li>Save this securely for the frontend <code>.env.local</code> file</li> </ul> </li> </ol> <pre><code># Step 1: Get admin access token\nTOKEN=$(curl -s -X POST \"https://keycloak.lab.home/realms/master/protocol/openid-connect/token\" \\\n  -H \"Content-Type: application/x-www-form-urlencoded\" \\\n  -d \"username=admin\" \\\n  -d \"password=your-admin-password\" \\\n  -d \"grant_type=password\" \\\n  -d \"client_id=admin-cli\" \\\n  | python3 -c \"import sys, json; print(json.load(sys.stdin)['access_token'])\")\n\n# Step 2: Create frontend client\ncurl -X POST \"https://keycloak.lab.home/admin/realms/secure-test/clients\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"clientId\": \"authentication-test-frontend\",\n    \"name\": \"Authentication Test Frontend\",\n    \"description\": \"Next.js frontend application for TaskFlow\",\n    \"enabled\": true,\n    \"protocol\": \"openid-connect\",\n    \"publicClient\": false,\n    \"clientAuthenticatorType\": \"client-secret\",\n    \"standardFlowEnabled\": true,\n    \"directAccessGrantsEnabled\": true,\n    \"serviceAccountsEnabled\": false,\n    \"authorizationServicesEnabled\": false,\n    \"rootUrl\": \"http://localhost:3000\",\n    \"baseUrl\": \"http://localhost:3000\",\n    \"redirectUris\": [\n      \"http://localhost:3000/*\",\n      \"http://localhost:3000/api/auth/callback/keycloak\",\n      \"https://app.lab.home/*\",\n      \"https://app.lab.home/api/auth/callback/keycloak\"\n    ],\n    \"webOrigins\": [\n      \"http://localhost:3000\",\n      \"https://app.lab.home\"\n    ],\n    \"attributes\": {\n      \"pkce.code.challenge.method\": \"S256\"\n    }\n  }'\n\n# Step 3: Get the client details including secret\nCLIENT_UUID=$(curl -s \"https://keycloak.lab.home/admin/realms/secure-test/clients?clientId=authentication-test-frontend\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  | python3 -c \"import sys, json; print(json.load(sys.stdin)[0]['id'])\")\n\n# Step 4: Retrieve client secret\ncurl -s \"https://keycloak.lab.home/admin/realms/secure-test/clients/$CLIENT_UUID/client-secret\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  | python3 -c \"import sys, json; print('Client Secret:', json.load(sys.stdin)['value'])\"\n</code></pre> <p>Automated Setup Complete</p> <p>The client has been created and configured. Copy the client secret from the output for use in your <code>.env.local</code> file.</p>"},{"location":"keycloak/frontend-client-setup/#step-2-configure-environment-variables","title":"Step 2: Configure Environment Variables","text":"<p>After creating the client and obtaining the secret, configure your frontend application:</p> <pre><code># Navigate to frontend directory\ncd Frontend\n\n# Copy environment template\ncp .env.local.example .env.local\n\n# Edit .env.local with your values\n</code></pre> <p>Update <code>.env.local</code> with the following:</p> <pre><code># Keycloak Configuration\nNEXTAUTH_URL=http://localhost:3000\nNEXTAUTH_SECRET=&lt;generate-with-openssl-rand-base64-32&gt;\n\n# Keycloak OAuth Provider\nKEYCLOAK_ID=authentication-test-frontend\nKEYCLOAK_SECRET=&lt;client-secret-from-keycloak&gt;\nKEYCLOAK_ISSUER=https://keycloak.lab.home/realms/secure-test\n\n# API Server Configuration\nNEXT_PUBLIC_API_URL=http://localhost:9080\n</code></pre>"},{"location":"keycloak/frontend-client-setup/#step-3-generate-nextauth-secret","title":"Step 3: Generate NextAuth Secret","text":"<p>Generate a secure random secret for NextAuth:</p> <pre><code>openssl rand -base64 32\n</code></pre> <p>Copy the output and set it as <code>NEXTAUTH_SECRET</code> in <code>.env.local</code>.</p>"},{"location":"keycloak/frontend-client-setup/#client-configuration-details","title":"Client Configuration Details","text":""},{"location":"keycloak/frontend-client-setup/#authentication-flow","title":"Authentication Flow","text":"<p>The frontend uses the Authorization Code Flow with PKCE (Proof Key for Code Exchange):</p> <ol> <li>User clicks \"Sign In\"</li> <li>Frontend redirects to Keycloak login page</li> <li>User enters credentials</li> <li>Keycloak validates and redirects back with authorization code</li> <li>Frontend exchanges code for access token (with PKCE verification)</li> <li>Session created with user info and tokens</li> </ol>"},{"location":"keycloak/frontend-client-setup/#pkce-proof-key-for-code-exchange","title":"PKCE (Proof Key for Code Exchange)","text":"<p>PKCE adds security to the Authorization Code Flow:</p> <ul> <li>Code Challenge: Generated by frontend before redirect</li> <li>Code Verifier: Sent when exchanging authorization code</li> <li>Method: S256 (SHA-256 hash)</li> <li>Purpose: Prevents authorization code interception attacks</li> </ul>"},{"location":"keycloak/frontend-client-setup/#token-storage","title":"Token Storage","text":"<ul> <li>Access Token: Stored in HTTP-only cookie (not accessible to JavaScript)</li> <li>Refresh Token: Stored in HTTP-only cookie</li> <li>ID Token: Stored in HTTP-only cookie</li> <li>Session: Managed by NextAuth.js</li> </ul>"},{"location":"keycloak/frontend-client-setup/#redirect-uris-explained","title":"Redirect URIs Explained","text":""},{"location":"keycloak/frontend-client-setup/#valid-redirect-uris","title":"Valid Redirect URIs","text":"<p>These URIs are where Keycloak can redirect after authentication:</p> <pre><code>http://localhost:3000/*                              # Development (wildcard)\nhttp://localhost:3000/api/auth/callback/keycloak   # NextAuth callback (specific)\nhttps://app.lab.home/*                              # Production (wildcard)\nhttps://app.lab.home/api/auth/callback/keycloak    # Production callback (specific)\n</code></pre> <p>Exact Match Required</p> <p>The callback URI must match exactly. NextAuth uses <code>/api/auth/callback/keycloak</code> by default.</p>"},{"location":"keycloak/frontend-client-setup/#web-origins-cors","title":"Web Origins (CORS)","text":"<p>These origins are allowed to make cross-origin requests:</p> <pre><code>http://localhost:3000    # Development\nhttps://app.lab.home     # Production\n</code></pre>"},{"location":"keycloak/frontend-client-setup/#verification-steps","title":"Verification Steps","text":""},{"location":"keycloak/frontend-client-setup/#1-verify-client-creation","title":"1. Verify Client Creation","text":"Admin ConsoleREST API <ol> <li>Navigate to Clients</li> <li>Find <code>authentication-test-frontend</code> in the list</li> <li>Verify Enabled is ON</li> <li>Check Client authentication is ON</li> </ol> <pre><code># Get client details\ncurl -s \"https://keycloak.lab.home/admin/realms/secure-test/clients?clientId=authentication-test-frontend\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  | python3 -m json.tool\n</code></pre>"},{"location":"keycloak/frontend-client-setup/#2-test-authentication-flow","title":"2. Test Authentication Flow","text":"<ol> <li> <p>Start frontend application:    <pre><code>cd Frontend\nnpm run dev\n</code></pre></p> </li> <li> <p>Open browser: http://localhost:3000</p> </li> <li> <p>Click \"Sign In\":</p> <ul> <li>Should redirect to Keycloak login page</li> <li>URL should be: <code>https://keycloak.lab.home/realms/secure-test/protocol/openid-connect/auth?...</code></li> </ul> </li> <li> <p>Enter credentials:</p> <ul> <li>Use a test user with <code>schedule-user</code> role</li> <li>Should redirect back to application</li> </ul> </li> <li> <p>Verify success:</p> <ul> <li>Username should appear in header</li> <li>Session should be active</li> <li>Can access <code>/app</code> page</li> </ul> </li> </ol>"},{"location":"keycloak/frontend-client-setup/#3-verify-token-contents","title":"3. Verify Token Contents","text":"<p>After successful login, check the token:</p> <pre><code># In browser console (F12)\n# Note: Tokens are in HTTP-only cookies, so you can't access them directly\n# But you can verify the session:\nfetch('/api/auth/session').then(r =&gt; r.json()).then(console.log)\n</code></pre> <p>Expected session structure: <pre><code>{\n  \"user\": {\n    \"name\": \"John Doe\",\n    \"email\": \"john.doe@example.com\"\n  },\n  \"expires\": \"2026-02-28T10:00:00.000Z\"\n}\n</code></pre></p>"},{"location":"keycloak/frontend-client-setup/#troubleshooting","title":"Troubleshooting","text":""},{"location":"keycloak/frontend-client-setup/#issue-invalid-redirect-uri","title":"Issue: \"Invalid redirect URI\"","text":"<p>Cause: Redirect URI mismatch between NextAuth and Keycloak</p> <p>Solution:</p> <ol> <li>Check the exact URI in browser when error occurs</li> <li>Add that URI to Valid redirect URIs in Keycloak</li> <li>Ensure it includes <code>/api/auth/callback/keycloak</code></li> <li>Restart frontend application</li> </ol>"},{"location":"keycloak/frontend-client-setup/#issue-cors-error","title":"Issue: \"CORS error\"","text":"<p>Cause: Frontend origin not in Web origins</p> <p>Solution:</p> <ol> <li>Add <code>http://localhost:3000</code> to Web origins</li> <li>Ensure no trailing slash</li> <li>Match protocol (http/https) exactly</li> <li>Save and test again</li> </ol>"},{"location":"keycloak/frontend-client-setup/#issue-client-authentication-failed","title":"Issue: \"Client authentication failed\"","text":"<p>Cause: Client secret mismatch</p> <p>Solution:</p> <ol> <li>Go to Keycloak \u2192 Clients \u2192 authentication-test-frontend \u2192 Credentials</li> <li>Copy the client secret</li> <li>Update <code>KEYCLOAK_SECRET</code> in <code>.env.local</code></li> <li>Restart frontend: <code>npm run dev</code></li> </ol>"},{"location":"keycloak/frontend-client-setup/#issue-session-not-persisting","title":"Issue: \"Session not persisting\"","text":"<p>Cause: NEXTAUTH_SECRET not set or invalid</p> <p>Solution:</p> <ol> <li>Generate new secret: <code>openssl rand -base64 32</code></li> <li>Set <code>NEXTAUTH_SECRET</code> in <code>.env.local</code></li> <li>Clear browser cookies</li> <li>Restart frontend</li> <li>Try logging in again</li> </ol>"},{"location":"keycloak/frontend-client-setup/#issue-token-expired-errors","title":"Issue: \"Token expired\" errors","text":"<p>Cause: Token lifespan too short</p> <p>Solution:</p> <ol> <li>Go to Keycloak \u2192 Realm Settings \u2192 Tokens</li> <li>Increase Access Token Lifespan (default: 5 minutes)</li> <li>Increase SSO Session Idle (default: 30 minutes)</li> <li>Save and test again</li> </ol>"},{"location":"keycloak/frontend-client-setup/#advanced-configuration","title":"Advanced Configuration","text":""},{"location":"keycloak/frontend-client-setup/#custom-token-lifespan","title":"Custom Token Lifespan","text":"<p>To customize token lifespan for this client:</p> <ol> <li>Go to Clients \u2192 authentication-test-frontend \u2192 Advanced tab</li> <li>Set Access Token Lifespan: <code>15 Minutes</code></li> <li>Set Client Session Idle: <code>30 Minutes</code></li> <li>Set Client Session Max: <code>10 Hours</code></li> <li>Click Save</li> </ol>"},{"location":"keycloak/frontend-client-setup/#add-custom-claims","title":"Add Custom Claims","text":"<p>To add custom claims to tokens:</p> <ol> <li>Go to Clients \u2192 authentication-test-frontend \u2192 Client scopes</li> <li>Click authentication-test-frontend-dedicated</li> <li>Go to Mappers tab</li> <li>Click Add mapper \u2192 By configuration</li> <li>Select mapper type (e.g., User Attribute)</li> <li>Configure and save</li> </ol>"},{"location":"keycloak/frontend-client-setup/#audience-validation","title":"Audience Validation","text":"<p>To add audience claim:</p> <ol> <li>Go to Client scopes \u2192 authentication-test-frontend-dedicated \u2192 Mappers</li> <li>Click Add mapper \u2192 By configuration</li> <li>Select Audience</li> <li>Configure:<ul> <li>Name: <code>audience</code></li> <li>Included Client Audience: <code>authentication-test-frontend</code></li> <li>Add to access token: \u2713 ON</li> </ul> </li> <li>Click Save</li> </ol>"},{"location":"keycloak/frontend-client-setup/#production-deployment","title":"Production Deployment","text":""},{"location":"keycloak/frontend-client-setup/#update-for-production","title":"Update for Production","text":"<p>When deploying to production:</p> <ol> <li> <p>Update Keycloak client:</p> <ul> <li>Add production redirect URIs</li> <li>Add production web origins</li> <li>Update root/home URLs</li> </ul> </li> <li> <p>Update frontend environment:     <pre><code>NEXTAUTH_URL=https://app.lab.home\nKEYCLOAK_ISSUER=https://keycloak.lab.home/realms/secure-test\n</code></pre></p> </li> <li> <p>Security checklist:</p> <ul> <li>[ ] Use HTTPS for all URLs</li> <li>[ ] Generate new NEXTAUTH_SECRET for production</li> <li>[ ] Use different client secret than development</li> <li>[ ] Enable rate limiting</li> <li>[ ] Monitor authentication logs</li> <li>[ ] Set up session timeout alerts</li> </ul> </li> </ol>"},{"location":"keycloak/frontend-client-setup/#environment-specific-clients","title":"Environment-Specific Clients","text":"<p>Consider creating separate clients for each environment:</p> <ul> <li><code>authentication-test-frontend-dev</code> - Development</li> <li><code>authentication-test-frontend-staging</code> - Staging</li> <li><code>authentication-test-frontend-prod</code> - Production</li> </ul> <p>Benefits: - Separate secrets per environment - Different token lifespans - Isolated configuration - Better security</p>"},{"location":"keycloak/frontend-client-setup/#security-best-practices","title":"Security Best Practices","text":""},{"location":"keycloak/frontend-client-setup/#1-client-secret-management","title":"1. Client Secret Management","text":"<ul> <li>Never commit client secrets to version control</li> <li>Use environment variables or secret management systems</li> <li>Rotate secrets periodically (every 90 days)</li> <li>Use different secrets for dev/staging/production</li> </ul>"},{"location":"keycloak/frontend-client-setup/#2-redirect-uri-security","title":"2. Redirect URI Security","text":"<ul> <li>Use specific URIs when possible (avoid wildcards in production)</li> <li>Always use HTTPS in production</li> <li>Validate redirect URIs on both client and server</li> <li>Never allow open redirects</li> </ul>"},{"location":"keycloak/frontend-client-setup/#3-token-security","title":"3. Token Security","text":"<ul> <li>Tokens stored in HTTP-only cookies (not accessible to JavaScript)</li> <li>Automatic token refresh before expiration</li> <li>Logout clears all session data</li> <li>Short token lifespans (5-15 minutes for access tokens)</li> </ul>"},{"location":"keycloak/frontend-client-setup/#4-cors-configuration","title":"4. CORS Configuration","text":"<ul> <li>Restrict web origins to specific domains</li> <li>Never use wildcard (*) in production</li> <li>Match protocol and port exactly</li> <li>Review origins regularly</li> </ul>"},{"location":"keycloak/frontend-client-setup/#next-steps","title":"Next Steps","text":"<p>After configuring the frontend client:</p> <ol> <li>Frontend Setup Guide - Install and run the application</li> <li>Frontend Configuration - Detailed environment setup</li> <li>Authentication Flow - Understand the auth process</li> <li>API Integration - Connect to backend API</li> </ol>"},{"location":"keycloak/frontend-client-setup/#additional-resources","title":"Additional Resources","text":"<ul> <li>Keycloak Client Configuration</li> <li>OAuth 2.0 Authorization Code Flow</li> <li>PKCE Specification</li> <li>NextAuth.js Documentation</li> <li>OpenID Connect Specification</li> </ul>"},{"location":"keycloak/groups-mapper/","title":"Groups Claim Mapper Configuration","text":"<p>This guide explains how to configure Keycloak to add a <code>groups</code> claim to JWT tokens, which is required for MicroProfile JWT role-based authorization.</p>"},{"location":"keycloak/groups-mapper/#why-is-this-needed","title":"Why is This Needed?","text":"<p>The MicroProfile JWT specification expects roles to be in a <code>groups</code> claim in the JWT token. By default, Keycloak places roles in the <code>realm_access.roles</code> claim. OpenLiberty's <code>@RolesAllowed</code> annotation checks the <code>groups</code> claim for authorization decisions.</p> <p>Without this mapper, you'll receive 403 Forbidden errors even with a valid JWT token because the authorization system cannot find the required roles.</p>"},{"location":"keycloak/groups-mapper/#prerequisites","title":"Prerequisites","text":"<ul> <li>Keycloak installed and running</li> <li><code>secure-test</code> realm created</li> <li><code>authentication-test-api</code> client configured</li> <li>Users created with <code>schedule-user</code> role assigned</li> </ul>"},{"location":"keycloak/groups-mapper/#understanding-the-problem","title":"Understanding the Problem","text":"<p>When you obtain a JWT token from Keycloak, it contains roles in this structure:</p> <pre><code>{\n  \"realm_access\": {\n    \"roles\": [\"schedule-user\", \"offline_access\", \"uma_authorization\"]\n  }\n}\n</code></pre> <p>But MicroProfile JWT expects:</p> <pre><code>{\n  \"groups\": [\"schedule-user\", \"offline_access\", \"uma_authorization\"]\n}\n</code></pre>"},{"location":"keycloak/groups-mapper/#solution-add-groups-mapper","title":"Solution: Add Groups Mapper","text":"<p>We need to add a Protocol Mapper to the Keycloak client that maps <code>realm_access.roles</code> to a <code>groups</code> claim.</p>"},{"location":"keycloak/groups-mapper/#step-1-access-client-scopes","title":"Step 1: Access Client Scopes","text":"<ol> <li>Login to Keycloak Admin Console: <code>https://keycloak.lab.home/admin</code> (or your Keycloak URL)</li> <li>Select the <code>secure-test</code> realm from the dropdown</li> <li>Go to \"Clients\" in the left menu</li> <li>Click on <code>authentication-test-api</code></li> <li>Go to the \"Client scopes\" tab</li> <li>Click on <code>authentication-test-api-dedicated</code> (the dedicated scope for this client)</li> </ol>"},{"location":"keycloak/groups-mapper/#step-2-add-the-mapper","title":"Step 2: Add the Mapper","text":"User Realm Role (Recommended)Hardcoded Claim <p>This is the simplest approach for dynamic role assignment:</p> <ol> <li>Click \"Add mapper\" \u2192 \"By configuration\"</li> <li>Select \"User Realm Role\"</li> <li>Configure the mapper:<ul> <li>Name: <code>groups-mapper</code></li> <li>Mapper Type: <code>User Realm Role</code></li> <li>Token Claim Name: <code>groups</code></li> <li>Claim JSON Type: <code>String</code></li> <li>Add to ID token: \u2713 ON</li> <li>Add to access token: \u2713 ON</li> <li>Add to userinfo: \u2713 ON</li> <li>Multivalued: \u2713 ON</li> </ul> </li> <li>Click \"Save\"</li> </ol> <p>Use this if you want to assign specific roles to all users:</p> <ol> <li>Click \"Add mapper\" \u2192 \"By configuration\"</li> <li>Select \"Hardcoded claim\"</li> <li>Configure:<ul> <li>Name: <code>groups-hardcoded</code></li> <li>Token Claim Name: <code>groups</code></li> <li>Claim value: <code>schedule-user</code> (or comma-separated list)</li> <li>Claim JSON Type: <code>String</code></li> <li>Add to ID token: \u2713 ON</li> <li>Add to access token: \u2713 ON</li> <li>Add to userinfo: \u2713 ON</li> </ul> </li> <li>Click \"Save\"</li> </ol> <p>Limitation</p> <p>This approach gives all users the same roles. Use \"User Realm Role\" for dynamic role assignment based on actual user roles.</p>"},{"location":"keycloak/groups-mapper/#step-3-verify-the-configuration","title":"Step 3: Verify the Configuration","text":""},{"location":"keycloak/groups-mapper/#get-a-new-token","title":"Get a New Token","text":"<p>After adding the mapper, obtain a new JWT token:</p> <pre><code>TOKEN=$(curl -s -k -X POST https://keycloak.lab.home/realms/secure-test/protocol/openid-connect/token \\\n  -H \"Content-Type: application/x-www-form-urlencoded\" \\\n  -d \"client_id=authentication-test-api\" \\\n  -d \"client_secret=YOUR_CLIENT_SECRET\" \\\n  -d \"grant_type=password\" \\\n  -d \"username=testuser2\" \\\n  -d \"password=YOUR_PASSWORD\" | jq -r '.access_token')\n</code></pre>"},{"location":"keycloak/groups-mapper/#decode-and-check-for-groups-claim","title":"Decode and Check for Groups Claim","text":"<p>Decode the JWT token to verify it contains the <code>groups</code> claim:</p> Command Linejwt.io <pre><code># Decode the token payload\npython3 -c \"import sys, json, base64; \\\npayload = sys.argv[1].split('.')[1]; \\\npayload += '=' * (4 - len(payload) % 4); \\\nclaims = json.loads(base64.b64decode(payload)); \\\nprint('Username:', claims.get('preferred_username')); \\\nprint('Groups:', json.dumps(claims.get('groups', []), indent=2))\" \"$TOKEN\"\n</code></pre> <p>Expected output:</p> <pre><code>Username: testuser2\nGroups: [\n  \"schedule-user\",\n  \"offline_access\",\n  \"uma_authorization\",\n  \"default-roles-secure-test\"\n]\n</code></pre> <ol> <li>Copy the token</li> <li>Go to https://jwt.io</li> <li>Paste the token in the \"Encoded\" section</li> <li>Check the \"Payload\" section for the <code>groups</code> claim</li> </ol>"},{"location":"keycloak/groups-mapper/#step-4-update-openliberty-configuration","title":"Step 4: Update OpenLiberty Configuration","text":"<p>Ensure your <code>server.xml</code> is configured to use the <code>groups</code> claim:</p> <pre><code>&lt;mpJwt id=\"jwtConfig\"\n       jwksUri=\"${env.JWT_JWKS_URI}\"\n       issuer=\"${env.JWT_ISSUER}\"\n       audiences=\"authentication-test-api\"\n       groupNameAttribute=\"groups\"\n       userNameAttribute=\"preferred_username\"\n       sslRef=\"jwtSSLConfig\"/&gt;\n</code></pre> <p>The key setting is <code>groupNameAttribute=\"groups\"</code>.</p>"},{"location":"keycloak/groups-mapper/#step-5-test-the-api","title":"Step 5: Test the API","text":"<p>Now test the API with the new token:</p> <pre><code># Get token\nTOKEN=$(curl -s -k -X POST https://keycloak.lab.home/realms/secure-test/protocol/openid-connect/token \\\n  -H \"Content-Type: application/x-www-form-urlencoded\" \\\n  -d \"client_id=authentication-test-api\" \\\n  -d \"client_secret=YOUR_CLIENT_SECRET\" \\\n  -d \"grant_type=password\" \\\n  -d \"username=testuser2\" \\\n  -d \"password=YOUR_PASSWORD\" | jq -r '.access_token')\n\n# Test API\ncurl -s http://localhost:9080/api/v1/schedule \\\n  -H \"Authorization: Bearer $TOKEN\" | jq .\n</code></pre> <p>Expected result: 200 OK with schedule data</p> <pre><code>{\n  \"user\": \"testuser2\",\n  \"schedule\": [\n    {\n      \"date\": \"2026-01-28\",\n      \"time\": \"12:00\",\n      \"description\": \"Team standup meeting\"\n    }\n  ]\n}\n</code></pre>"},{"location":"keycloak/groups-mapper/#troubleshooting","title":"Troubleshooting","text":""},{"location":"keycloak/groups-mapper/#still-getting-403-forbidden","title":"Still Getting 403 Forbidden","text":"<p>Possible causes:</p> <ol> <li>Token doesn't have groups claim</li> <li>Clear browser cache and get a new token</li> <li>Verify the mapper is enabled</li> <li> <p>Check that the mapper is in the correct client scope</p> </li> <li> <p>Groups claim is empty</p> </li> <li>Verify the user has the <code>schedule-user</code> role assigned</li> <li>Check realm roles vs client roles (use realm roles)</li> <li> <p>Verify the mapper is configured for realm roles</p> </li> <li> <p>OpenLiberty not reading groups</p> </li> <li>Check <code>groupNameAttribute=\"groups\"</code> in server.xml</li> <li>Verify the role name matches exactly: <code>schedule-user</code></li> <li>Check server logs for role extraction messages</li> </ol>"},{"location":"keycloak/groups-mapper/#token-still-doesnt-have-groups-claim","title":"Token Still Doesn't Have Groups Claim","text":"<ol> <li> <p>Restart Keycloak (if needed):    <pre><code># If using Docker/Podman\npodman restart keycloak\n</code></pre></p> </li> <li> <p>Clear token cache:</p> </li> <li>Logout from all sessions</li> <li>Get a completely new token</li> <li> <p>Don't reuse old tokens</p> </li> <li> <p>Verify mapper is in access token:</p> </li> <li>Go to mapper configuration</li> <li>Ensure \"Add to access token\" is checked</li> <li>Save the configuration again</li> </ol>"},{"location":"keycloak/groups-mapper/#groups-claim-exists-but-authorization-fails","title":"Groups Claim Exists But Authorization Fails","text":"<p>Check OpenLiberty logs for detailed information:</p> <pre><code>tail -f target/liberty/wlp/usr/servers/authTestServer/logs/messages.log | grep -i \"group\\|role\"\n</code></pre> <p>Look for messages like: - <code>groupIds=[]</code> - Groups not being extracted - <code>Authorization failed</code> - Role check failing</p>"},{"location":"keycloak/groups-mapper/#using-rest-api","title":"Using REST API","text":"<p>You can also configure the mapper via Keycloak's REST API:</p> <pre><code># Get admin token\nADMIN_TOKEN=$(curl -s -X POST https://keycloak.lab.home/realms/master/protocol/openid-connect/token \\\n  -H \"Content-Type: application/x-www-form-urlencoded\" \\\n  -d \"username=admin\" \\\n  -d \"password=admin\" \\\n  -d \"grant_type=password\" \\\n  -d \"client_id=admin-cli\" | jq -r '.access_token')\n\n# Get client scope ID\nSCOPE_ID=$(curl -s -k -X GET \"https://keycloak.lab.home/admin/realms/secure-test/client-scopes\" \\\n  -H \"Authorization: Bearer $ADMIN_TOKEN\" \\\n  | jq -r '.[] | select(.name==\"authentication-test-api-dedicated\") | .id')\n\n# Add mapper\ncurl -k -X POST \"https://keycloak.lab.home/admin/realms/secure-test/client-scopes/$SCOPE_ID/protocol-mappers/models\" \\\n  -H \"Authorization: Bearer $ADMIN_TOKEN\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"name\": \"groups-mapper\",\n    \"protocol\": \"openid-connect\",\n    \"protocolMapper\": \"oidc-usermodel-realm-role-mapper\",\n    \"config\": {\n      \"claim.name\": \"groups\",\n      \"jsonType.label\": \"String\",\n      \"id.token.claim\": \"true\",\n      \"access.token.claim\": \"true\",\n      \"userinfo.token.claim\": \"true\",\n      \"multivalued\": \"true\"\n    }\n  }'\n</code></pre>"},{"location":"keycloak/groups-mapper/#next-steps","title":"Next Steps","text":"<ul> <li>Test API Endpoints - Test all API functionality</li> <li>Troubleshooting - Common issues and solutions</li> <li>API Authentication - Learn more about JWT authentication</li> </ul>"},{"location":"keycloak/groups-mapper/#references","title":"References","text":"<ul> <li>MicroProfile JWT Specification</li> <li>Keycloak Protocol Mappers</li> <li>OpenLiberty MicroProfile JWT</li> </ul>"},{"location":"keycloak/installation/","title":"Keycloak Installation","text":"<p>This guide covers installing and running Keycloak for the Authentication Test API.</p>"},{"location":"keycloak/installation/#what-is-keycloak","title":"What is Keycloak?","text":"<p>Keycloak is an open-source Identity and Access Management solution that provides:</p> <ul> <li>OAuth 2.0 and OpenID Connect support</li> <li>User authentication and authorization</li> <li>Single Sign-On (SSO)</li> <li>User management</li> <li>Role-based access control</li> </ul>"},{"location":"keycloak/installation/#installation-options","title":"Installation Options","text":"Container (Recommended)Standalone ServerProduction with PostgreSQL <p>The easiest way to run Keycloak for development and testing.</p> PodmanDocker <pre><code>podman run -d \\\n  --name keycloak \\\n  -p 8080:8080 \\\n  -e KEYCLOAK_ADMIN=admin \\\n  -e KEYCLOAK_ADMIN_PASSWORD=admin \\\n  quay.io/keycloak/keycloak:latest \\\n  start-dev\n</code></pre> <pre><code>docker run -d \\\n  --name keycloak \\\n  -p 8080:8080 \\\n  -e KEYCLOAK_ADMIN=admin \\\n  -e KEYCLOAK_ADMIN_PASSWORD=admin \\\n  quay.io/keycloak/keycloak:latest \\\n  start-dev\n</code></pre> <p>Wait for Keycloak to start (about 30 seconds):</p> <pre><code># Check logs\npodman logs -f keycloak  # or docker logs -f keycloak\n</code></pre> <p>Look for: <code>Keycloak 23.0.0 started</code></p> <p>Access Keycloak:</p> <ul> <li>URL: <code>http://localhost:8080</code></li> <li>Admin Username: <code>admin</code></li> <li>Admin Password: <code>admin</code></li> </ul> <p>Download and run Keycloak as a standalone server.</p> <p>Download:</p> <pre><code># Download Keycloak\nwget https://github.com/keycloak/keycloak/releases/download/23.0.0/keycloak-23.0.0.zip\n\n# Extract\nunzip keycloak-23.0.0.zip\ncd keycloak-23.0.0\n</code></pre> <p>Start Server:</p> <pre><code># Set admin credentials\nexport KEYCLOAK_ADMIN=admin\nexport KEYCLOAK_ADMIN_PASSWORD=admin\n\n# Start in development mode\nbin/kc.sh start-dev\n</code></pre> <p>Access at: <code>http://localhost:8080</code></p> <p>For production, use a proper database and HTTPS.</p> PodmanDocker <pre><code># Create network\npodman network create keycloak-network\n\n# Start PostgreSQL\npodman run -d \\\n  --name postgres \\\n  --network keycloak-network \\\n  -e POSTGRES_DB=keycloak \\\n  -e POSTGRES_USER=keycloak \\\n  -e POSTGRES_PASSWORD=password \\\n  postgres:15\n\n# Start Keycloak\npodman run -d \\\n  --name keycloak \\\n  --network keycloak-network \\\n  -p 8443:8443 \\\n  -e KEYCLOAK_ADMIN=admin \\\n  -e KEYCLOAK_ADMIN_PASSWORD=admin \\\n  -e KC_DB=postgres \\\n  -e KC_DB_URL=jdbc:postgresql://postgres:5432/keycloak \\\n  -e KC_DB_USERNAME=keycloak \\\n  -e KC_DB_PASSWORD=password \\\n  -e KC_HOSTNAME=keycloak.example.com \\\n  quay.io/keycloak/keycloak:latest \\\n  start --optimized\n</code></pre> <pre><code># Create network\ndocker network create keycloak-network\n\n# Start PostgreSQL\ndocker run -d \\\n  --name postgres \\\n  --network keycloak-network \\\n  -e POSTGRES_DB=keycloak \\\n  -e POSTGRES_USER=keycloak \\\n  -e POSTGRES_PASSWORD=password \\\n  postgres:15\n\n# Start Keycloak\ndocker run -d \\\n  --name keycloak \\\n  --network keycloak-network \\\n  -p 8443:8443 \\\n  -e KEYCLOAK_ADMIN=admin \\\n  -e KEYCLOAK_ADMIN_PASSWORD=admin \\\n  -e KC_DB=postgres \\\n  -e KC_DB_URL=jdbc:postgresql://postgres:5432/keycloak \\\n  -e KC_DB_USERNAME=keycloak \\\n  -e KC_DB_PASSWORD=password \\\n  -e KC_HOSTNAME=keycloak.example.com \\\n  quay.io/keycloak/keycloak:latest \\\n  start --optimized\n</code></pre>"},{"location":"keycloak/installation/#verifying-installation","title":"Verifying Installation","text":""},{"location":"keycloak/installation/#check-keycloak-is-running","title":"Check Keycloak is Running","text":"<pre><code>curl http://localhost:8080\n</code></pre> <p>You should see the Keycloak welcome page HTML.</p>"},{"location":"keycloak/installation/#access-admin-console","title":"Access Admin Console","text":"<ol> <li>Open browser: <code>http://localhost:8080</code></li> <li>Click \"Administration Console\"</li> <li>Login with:</li> <li>Username: <code>admin</code></li> <li>Password: <code>admin</code></li> </ol> <p>You should see the Keycloak admin dashboard.</p>"},{"location":"keycloak/installation/#initial-configuration","title":"Initial Configuration","text":""},{"location":"keycloak/installation/#change-admin-password","title":"Change Admin Password","text":"<p>Security</p> <p>Change the default admin password immediately!</p> <ol> <li>Click \"Admin\" in top-right corner</li> <li>Select \"Manage account\"</li> <li>Go to \"Password\" tab</li> <li>Enter new password</li> <li>Click \"Save\"</li> </ol>"},{"location":"keycloak/installation/#enable-https-production","title":"Enable HTTPS (Production)","text":"<p>For production, always use HTTPS:</p> <pre><code># Generate self-signed certificate (development only)\nkeytool -genkeypair -storepass password -storetype PKCS12 \\\n  -keyalg RSA -keysize 2048 -dname \"CN=server\" \\\n  -alias server -ext \"SAN:c=DNS:localhost,IP:127.0.0.1\" \\\n  -keystore conf/server.keystore\n</code></pre> <p>Start with HTTPS:</p> <pre><code>bin/kc.sh start-dev \\\n  --https-certificate-file=conf/server.crt \\\n  --https-certificate-key-file=conf/server.key\n</code></pre>"},{"location":"keycloak/installation/#container-management","title":"Container Management","text":""},{"location":"keycloak/installation/#stop-keycloak","title":"Stop Keycloak","text":"PodmanDocker <pre><code>podman stop keycloak\n</code></pre> <pre><code>docker stop keycloak\n</code></pre>"},{"location":"keycloak/installation/#start-keycloak","title":"Start Keycloak","text":"PodmanDocker <pre><code>podman start keycloak\n</code></pre> <pre><code>docker start keycloak\n</code></pre>"},{"location":"keycloak/installation/#restart-keycloak","title":"Restart Keycloak","text":"PodmanDocker <pre><code>podman restart keycloak\n</code></pre> <pre><code>docker restart keycloak\n</code></pre>"},{"location":"keycloak/installation/#view-logs","title":"View Logs","text":"PodmanDocker <pre><code>podman logs -f keycloak\n</code></pre> <pre><code>docker logs -f keycloak\n</code></pre>"},{"location":"keycloak/installation/#remove-keycloak","title":"Remove Keycloak","text":"PodmanDocker <pre><code>podman stop keycloak\npodman rm keycloak\n</code></pre> <pre><code>docker stop keycloak\ndocker rm keycloak\n</code></pre>"},{"location":"keycloak/installation/#persistent-data","title":"Persistent Data","text":""},{"location":"keycloak/installation/#with-volume-mount","title":"With Volume Mount","text":"<p>To persist Keycloak data across container restarts:</p> PodmanDocker <pre><code># Create volume\npodman volume create keycloak-data\n\n# Run with volume\npodman run -d \\\n  --name keycloak \\\n  -p 8080:8080 \\\n  -v keycloak-data:/opt/keycloak/data:Z \\\n  -e KEYCLOAK_ADMIN=admin \\\n  -e KEYCLOAK_ADMIN_PASSWORD=admin \\\n  quay.io/keycloak/keycloak:latest \\\n  start-dev\n</code></pre> <pre><code># Create volume\ndocker volume create keycloak-data\n\n# Run with volume\ndocker run -d \\\n  --name keycloak \\\n  -p 8080:8080 \\\n  -v keycloak-data:/opt/keycloak/data \\\n  -e KEYCLOAK_ADMIN=admin \\\n  -e KEYCLOAK_ADMIN_PASSWORD=admin \\\n  quay.io/keycloak/keycloak:latest \\\n  start-dev\n</code></pre>"},{"location":"keycloak/installation/#troubleshooting","title":"Troubleshooting","text":""},{"location":"keycloak/installation/#port-8080-already-in-use","title":"Port 8080 Already in Use","text":"<p>Change the port:</p> PodmanDocker <pre><code>podman run -d \\\n  --name keycloak \\\n  -p 8081:8080 \\\n  -e KEYCLOAK_ADMIN=admin \\\n  -e KEYCLOAK_ADMIN_PASSWORD=admin \\\n  quay.io/keycloak/keycloak:latest \\\n  start-dev\n</code></pre> <pre><code>docker run -d \\\n  --name keycloak \\\n  -p 8081:8080 \\\n  -e KEYCLOAK_ADMIN=admin \\\n  -e KEYCLOAK_ADMIN_PASSWORD=admin \\\n  quay.io/keycloak/keycloak:latest \\\n  start-dev\n</code></pre> <p>Access at: <code>http://localhost:8081</code></p>"},{"location":"keycloak/installation/#container-wont-start","title":"Container Won't Start","text":"<p>Check logs for errors:</p> PodmanDocker <pre><code>podman logs keycloak\n</code></pre> <pre><code>docker logs keycloak\n</code></pre>"},{"location":"keycloak/installation/#cant-access-admin-console","title":"Can't Access Admin Console","text":"<ol> <li> <p>Verify Keycloak is running:    <pre><code>curl http://localhost:8080\n</code></pre></p> </li> <li> <p>Check firewall settings</p> </li> <li> <p>Try accessing from localhost only</p> </li> </ol>"},{"location":"keycloak/installation/#database-connection-issues","title":"Database Connection Issues","text":"<p>If using external database, verify:</p> <ol> <li>Database is running</li> <li>Connection string is correct</li> <li>Credentials are valid</li> <li>Network connectivity</li> </ol>"},{"location":"keycloak/installation/#next-steps","title":"Next Steps","text":"<p>Now that Keycloak is installed:</p> <ol> <li>Create Realm - Setup the secure-test realm</li> <li>Configure Client - Setup the API client</li> <li>Add Users - Create test users</li> </ol>"},{"location":"keycloak/installation/#additional-resources","title":"Additional Resources","text":"<ul> <li>Keycloak Documentation</li> <li>Keycloak Server Installation</li> <li>Keycloak Container Images</li> </ul>"},{"location":"keycloak/realm-setup/","title":"Realm Configuration","text":"<p>This guide walks you through creating and configuring the <code>secure-test</code> realm in Keycloak for the Authentication Test API.</p>"},{"location":"keycloak/realm-setup/#what-is-a-realm","title":"What is a Realm?","text":"<p>A realm in Keycloak is an isolated space that manages:</p> <ul> <li>Users and groups</li> <li>Roles and permissions</li> <li>Clients (applications)</li> <li>Authentication settings</li> </ul>"},{"location":"keycloak/realm-setup/#prerequisites","title":"Prerequisites","text":"<ul> <li>Keycloak installed and running</li> <li>Access to Keycloak Admin Console</li> <li>Admin credentials</li> </ul>"},{"location":"keycloak/realm-setup/#step-1-access-admin-console","title":"Step 1: Access Admin Console","text":"<ol> <li>Open browser: <code>http://localhost:8080</code></li> <li>Click \"Administration Console\"</li> <li>Login with admin credentials</li> </ol>"},{"location":"keycloak/realm-setup/#step-2-create-realm","title":"Step 2: Create Realm","text":"Admin ConsoleREST API <ol> <li>Hover over \"Master\" in the top-left corner</li> <li>Click \"Create Realm\"</li> <li>Enter Realm Details:<ul> <li>Realm name: <code>secure-test</code></li> <li>Enabled: \u2713 (checked)</li> </ul> </li> <li>Click \"Create\"</li> </ol> <p>You should now see \"secure-test\" in the realm selector.</p> <p>Create the realm via API:</p> <pre><code># Get admin token\nTOKEN=$(curl -X POST http://localhost:8080/realms/master/protocol/openid-connect/token \\\n  -H \"Content-Type: application/x-www-form-urlencoded\" \\\n  -d \"username=admin\" \\\n  -d \"password=admin\" \\\n  -d \"grant_type=password\" \\\n  -d \"client_id=admin-cli\" \\\n  | jq -r '.access_token')\n\n# Create realm\ncurl -X POST http://localhost:8080/admin/realms \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"realm\": \"secure-test\",\n    \"enabled\": true,\n    \"displayName\": \"Secure Test Realm\",\n    \"displayNameHtml\": \"&lt;b&gt;Secure Test&lt;/b&gt;\"\n  }'\n</code></pre>"},{"location":"keycloak/realm-setup/#step-3-configure-realm-settings","title":"Step 3: Configure Realm Settings","text":""},{"location":"keycloak/realm-setup/#general-settings","title":"General Settings","text":"<ol> <li>Select \"secure-test\" realm from dropdown</li> <li>Go to \"Realm settings\"</li> <li>Configure General tab:</li> <li>Display name: <code>Secure Test Realm</code></li> <li>HTML Display name: <code>&lt;b&gt;Secure Test&lt;/b&gt;</code></li> <li>Frontend URL: Leave empty for development</li> <li> <p>Require SSL: <code>none</code> (development) or <code>external requests</code> (production)</p> </li> <li> <p>Click \"Save\"</p> </li> </ol>"},{"location":"keycloak/realm-setup/#login-settings","title":"Login Settings","text":"<ol> <li>Go to \"Realm settings\" \u2192 \"Login\" tab</li> <li>Configure:</li> <li>User registration: \u2717 (unchecked for security)</li> <li>Forgot password: \u2713 (optional)</li> <li>Remember me: \u2713 (optional)</li> <li>Email as username: \u2717 (use separate username)</li> <li>Login with email: \u2713 (allow email login)</li> <li>Duplicate emails: \u2717 (prevent duplicate emails)</li> <li> <p>Verify email: \u2717 (disable for testing)</p> </li> <li> <p>Click \"Save\"</p> </li> </ol>"},{"location":"keycloak/realm-setup/#token-settings","title":"Token Settings","text":"<ol> <li>Go to \"Realm settings\" \u2192 \"Tokens\" tab</li> <li>Configure Token Lifespans:</li> <li>Access Token Lifespan: <code>5 Minutes</code> (default)</li> <li>Access Token Lifespan For Implicit Flow: <code>15 Minutes</code></li> <li>Client login timeout: <code>1 Minutes</code></li> <li>Login timeout: <code>30 Minutes</code></li> <li> <p>Login action timeout: <code>5 Minutes</code></p> </li> <li> <p>Click \"Save\"</p> </li> </ol> <p>Token Lifespan</p> <p>For development, you can increase token lifespan to avoid frequent re-authentication. For production, keep tokens short-lived for security.</p>"},{"location":"keycloak/realm-setup/#email-settings-optional","title":"Email Settings (Optional)","text":"<p>For password reset and email verification:</p> <ol> <li>Go to \"Realm settings\" \u2192 \"Email\" tab</li> <li>Configure SMTP:</li> <li>Host: <code>smtp.gmail.com</code> (or your SMTP server)</li> <li>Port: <code>587</code></li> <li>From: <code>noreply@example.com</code></li> <li>Enable SSL: \u2717</li> <li>Enable StartTLS: \u2713</li> <li>Enable Authentication: \u2713</li> <li>Username: Your email</li> <li> <p>Password: Your email password</p> </li> <li> <p>Click \"Save\"</p> </li> <li>Click \"Test connection\" to verify</li> </ol>"},{"location":"keycloak/realm-setup/#step-4-create-realm-role","title":"Step 4: Create Realm Role","text":"<p>Create the <code>schedule-user</code> role required by the API.</p> Admin ConsoleREST API <ol> <li>Go to \"Realm roles\" in left menu</li> <li>Click \"Create role\"</li> <li>Enter Role Details:<ul> <li>Role name: <code>schedule-user</code></li> <li>Description: <code>Role for accessing schedule API</code></li> </ul> </li> <li>Click \"Save\"</li> </ol> <pre><code># Get admin token (if not already set)\nTOKEN=$(curl -X POST http://localhost:8080/realms/master/protocol/openid-connect/token \\\n  -H \"Content-Type: application/x-www-form-urlencoded\" \\\n  -d \"username=admin\" \\\n  -d \"password=admin\" \\\n  -d \"grant_type=password\" \\\n  -d \"client_id=admin-cli\" \\\n  | jq -r '.access_token')\n\n# Create role\ncurl -X POST http://localhost:8080/admin/realms/secure-test/roles \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"name\": \"schedule-user\",\n    \"description\": \"Role for accessing schedule API\"\n  }'\n</code></pre>"},{"location":"keycloak/realm-setup/#step-5-configure-security-settings","title":"Step 5: Configure Security Settings","text":""},{"location":"keycloak/realm-setup/#brute-force-detection","title":"Brute Force Detection","text":"<p>Protect against brute force attacks:</p> <ol> <li>Go to \"Realm settings\" \u2192 \"Security defenses\" tab</li> <li>Configure Brute Force Detection:</li> <li>Enabled: \u2713</li> <li>Permanent Lockout: \u2717</li> <li>Max Login Failures: <code>5</code></li> <li>Wait Increment: <code>60 Seconds</code></li> <li>Quick Login Check Milli Seconds: <code>1000</code></li> <li>Minimum Quick Login Wait: <code>60 Seconds</code></li> <li>Max Wait: <code>900 Seconds</code></li> <li> <p>Failure Reset Time: <code>43200 Seconds</code> (12 hours)</p> </li> <li> <p>Click \"Save\"</p> </li> </ol>"},{"location":"keycloak/realm-setup/#password-policy","title":"Password Policy","text":"<p>Set password requirements:</p> <ol> <li>Go to \"Realm settings\" \u2192 \"Security defenses\" \u2192 \"Password policy\" tab</li> <li>Add Policies:</li> <li>Minimum Length: <code>8</code></li> <li>Not Username: \u2713</li> <li>Uppercase Characters: <code>1</code></li> <li>Lowercase Characters: <code>1</code></li> <li>Digits: <code>1</code></li> <li> <p>Special Characters: <code>1</code></p> </li> <li> <p>Click \"Save\"</p> </li> </ol>"},{"location":"keycloak/realm-setup/#step-6-verify-realm-configuration","title":"Step 6: Verify Realm Configuration","text":""},{"location":"keycloak/realm-setup/#check-realm-endpoints","title":"Check Realm Endpoints","text":"<p>Get the OpenID Connect configuration:</p> <pre><code>curl http://localhost:8080/realms/secure-test/.well-known/openid-configuration | jq\n</code></pre> <p>You should see:</p> <pre><code>{\n  \"issuer\": \"http://localhost:8080/realms/secure-test\",\n  \"authorization_endpoint\": \"http://localhost:8080/realms/secure-test/protocol/openid-connect/auth\",\n  \"token_endpoint\": \"http://localhost:8080/realms/secure-test/protocol/openid-connect/token\",\n  \"jwks_uri\": \"http://localhost:8080/realms/secure-test/protocol/openid-connect/certs\",\n  ...\n}\n</code></pre>"},{"location":"keycloak/realm-setup/#verify-jwks-endpoint","title":"Verify JWKS Endpoint","text":"<p>Check the JSON Web Key Set:</p> <pre><code>curl http://localhost:8080/realms/secure-test/protocol/openid-connect/certs | jq\n</code></pre> <p>You should see public keys used for JWT signature verification.</p> <p>Testing with Users</p> <p>To test token generation, you'll need to create users first. See the User Management guide for creating test users.</p>"},{"location":"keycloak/realm-setup/#export-realm-configuration","title":"Export Realm Configuration","text":"Admin ConsoleCLI <ol> <li>Go to \"Realm settings\"</li> <li>Click \"Action\" \u2192 \"Partial export\"</li> <li>Select what to export:<ul> <li>\u2713 Export groups and roles</li> <li>\u2713 Export clients</li> <li>\u2717 Export users (for security)</li> </ul> </li> <li>Click \"Export\"</li> </ol> <p>Download: <code>secure-test-realm.json</code></p> <p>```bash</p>"},{"location":"keycloak/realm-setup/#export-realm","title":"Export realm","text":""},{"location":"keycloak/user-management/","title":"User Management","text":"<p>This guide explains how to create and manage users in Keycloak for testing the Authentication Test API.</p>"},{"location":"keycloak/user-management/#prerequisites","title":"Prerequisites","text":"<ul> <li>Keycloak installed and running</li> <li><code>secure-test</code> realm created</li> <li><code>schedule-user</code> role created</li> <li><code>authentication-test-api</code> client configured</li> </ul>"},{"location":"keycloak/user-management/#creating-test-users","title":"Creating Test Users","text":"<p>We'll create two test users as specified in the requirements:</p> <ol> <li>testuser1 - User with schedule-user role</li> <li>testuser2 - User with schedule-user role</li> </ol>"},{"location":"keycloak/user-management/#step-1-create-first-user-testuser1","title":"Step 1: Create First User (testuser1)","text":"Admin ConsoleREST API <p>Create User:</p> <ol> <li>Select \"secure-test\" realm from dropdown</li> <li>Go to \"Users\" in left menu</li> <li>Click \"Create new user\"</li> <li>Enter User Details:</li> <li>Username: <code>testuser1</code> (required)</li> <li>Email: <code>testuser1@example.com</code></li> <li>Email verified: \u2713 ON</li> <li>First name: <code>Test</code></li> <li>Last name: <code>User One</code></li> <li>Enabled: \u2713 ON (user can login)</li> <li>Required user actions: (leave empty)</li> <li>Click \"Create\"</li> </ol> <p>Set Password:</p> <ol> <li>Go to \"Credentials\" tab</li> <li>Click \"Set password\"</li> <li>Enter Password Details:</li> <li>Password: <code>password123</code></li> <li>Password confirmation: <code>password123</code></li> <li>Temporary: \u2717 OFF (user won't need to change password)</li> <li>Click \"Save\"</li> <li>Confirm by clicking \"Save password\"</li> </ol> <p>Assign Role:</p> <ol> <li>Go to \"Role mapping\" tab</li> <li>Click \"Assign role\"</li> <li>Filter by realm roles</li> <li>Select \"schedule-user\"</li> <li>Click \"Assign\"</li> </ol> <p>You should see <code>schedule-user</code> in the \"Assigned roles\" list.</p> <pre><code># Get admin token\nTOKEN=$(curl -X POST http://localhost:8080/realms/master/protocol/openid-connect/token \\\n  -H \"Content-Type: application/x-www-form-urlencoded\" \\\n  -d \"username=admin\" \\\n  -d \"password=admin\" \\\n  -d \"grant_type=password\" \\\n  -d \"client_id=admin-cli\" \\\n  | jq -r '.access_token')\n\n# Create user\ncurl -X POST http://localhost:8080/admin/realms/secure-test/users \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"username\": \"testuser1\",\n    \"email\": \"testuser1@example.com\",\n    \"emailVerified\": true,\n    \"firstName\": \"Test\",\n    \"lastName\": \"User One\",\n    \"enabled\": true,\n    \"credentials\": [{\n      \"type\": \"password\",\n      \"value\": \"password123\",\n      \"temporary\": false\n    }]\n  }'\n\n# Get user ID\nUSER_ID=$(curl -X GET \"http://localhost:8080/admin/realms/secure-test/users?username=testuser1\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  | jq -r '.[0].id')\n\n# Get role ID\nROLE_ID=$(curl -X GET http://localhost:8080/admin/realms/secure-test/roles/schedule-user \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  | jq -r '.id')\n\n# Assign role to user\ncurl -X POST \"http://localhost:8080/admin/realms/secure-test/users/$USER_ID/role-mappings/realm\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H \"Content-Type: application/json\" \\\n  -d \"[{\n    \\\"id\\\": \\\"$ROLE_ID\\\",\n    \\\"name\\\": \\\"schedule-user\\\"\n  }]\"\n</code></pre>"},{"location":"keycloak/user-management/#step-2-create-second-user-testuser2","title":"Step 2: Create Second User (testuser2)","text":"Admin ConsoleREST API <p>Repeat the same process for the second user:</p> <ol> <li>Go to \"Users\" \u2192 \"Create new user\"</li> <li>Enter User Details:</li> <li>Username: <code>testuser2</code></li> <li>Email: <code>testuser2@example.com</code></li> <li>Email verified: \u2713 ON</li> <li>First name: <code>Test</code></li> <li>Last name: <code>User Two</code></li> <li>Enabled: \u2713 ON</li> <li>Click \"Create\"</li> <li>Set Password:</li> <li>Password: <code>password123</code></li> <li>Temporary: \u2717 OFF</li> <li>Assign Role:</li> <li>Assign <code>schedule-user</code> role</li> </ol> <pre><code># Create second user\ncurl -X POST http://localhost:8080/admin/realms/secure-test/users \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"username\": \"testuser2\",\n    \"email\": \"testuser2@example.com\",\n    \"emailVerified\": true,\n    \"firstName\": \"Test\",\n    \"lastName\": \"User Two\",\n    \"enabled\": true,\n    \"credentials\": [{\n      \"type\": \"password\",\n      \"value\": \"password123\",\n      \"temporary\": false\n    }]\n  }'\n</code></pre>"},{"location":"keycloak/user-management/#get-user-id-and-assign-role-same-as-testuser1","title":"Get user ID and assign role (same as testuser1)","text":"<p>USER_ID=$(curl -X GET \"http://localhost:8080/admin/realms/secure-test/users?username=testuser2\" \\   -H \"Authorization: Bearer $TOKEN\" \\   | jq -r '.[0].id')</p> <p>curl -X POST \"http://localhost:8080/admin/realms/secure-test/users/$USER_ID/role-mappings/realm\" \\   -H \"Authorization: Bearer $TOKEN\" \\   -H \"Content-Type: application/json\" \\   -d \"[{     \\\"id\\\": \\\"$ROLE_ID\\\",     \\\"name\\\": \\\"schedule-user\\\"   }]\" <pre><code>## Step 3: Verify Users\n\n### List All Users\n\n=== \"Admin Console\"\n    1. Go to \"Users\"\n    2. You should see both testuser1 and testuser2\n\n=== \"REST API\"\n    ```bash\n    curl -X GET http://localhost:8080/admin/realms/secure-test/users \\\n      -H \"Authorization: Bearer $TOKEN\" \\\n      | jq '.[] | {username, email, enabled}'\n    ```\n\n### Test User Login\n\nTest that users can authenticate:\n\n```bash\n# Test testuser1\ncurl -X POST http://localhost:8080/realms/secure-test/protocol/openid-connect/token \\\n  -H \"Content-Type: application/x-www-form-urlencoded\" \\\n  -d \"client_id=authentication-test-api\" \\\n  -d \"client_secret=YOUR_CLIENT_SECRET\" \\\n  -d \"grant_type=password\" \\\n  -d \"username=testuser1\" \\\n  -d \"password=password123\" \\\n  | jq\n\n# Test testuser2\ncurl -X POST http://localhost:8080/realms/secure-test/protocol/openid-connect/token \\\n  -H \"Content-Type: application/x-www-form-urlencoded\" \\\n  -d \"client_id=authentication-test-api\" \\\n  -d \"client_secret=YOUR_CLIENT_SECRET\" \\\n  -d \"grant_type=password\" \\\n  -d \"username=testuser2\" \\\n  -d \"password=password123\" \\\n  | jq\n</code></pre></p> <p>Both should return access tokens.</p>"},{"location":"keycloak/user-management/#verify-role-assignment","title":"Verify Role Assignment","text":"<p>Check that users have the schedule-user role:</p> <pre><code># Get user's roles\nUSER_ID=$(curl -X GET \"http://localhost:8080/admin/realms/secure-test/users?username=testuser1\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  | jq -r '.[0].id')\n\ncurl -X GET \"http://localhost:8080/admin/realms/secure-test/users/$USER_ID/role-mappings/realm\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  | jq '.[] | {name, description}'\n</code></pre> <p>Should show <code>schedule-user</code> role.</p>"},{"location":"keycloak/user-management/#user-management-operations","title":"User Management Operations","text":""},{"location":"keycloak/user-management/#update-user-information","title":"Update User Information","text":"Admin ConsoleREST API <ol> <li>Go to \"Users\"</li> <li>Click on username</li> <li>Edit fields</li> <li>Click \"Save\"</li> </ol> <pre><code>curl -X PUT \"http://localhost:8080/admin/realms/secure-test/users/$USER_ID\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"firstName\": \"Updated\",\n    \"lastName\": \"Name\"\n  }'\n</code></pre>"},{"location":"keycloak/user-management/#reset-password","title":"Reset Password","text":"Admin ConsoleREST API <ol> <li>Go to \"Users\" \u2192 Select user</li> <li>Go to \"Credentials\" tab</li> <li>Click \"Reset password\"</li> <li>Enter new password</li> <li>Set \"Temporary\" if user should change it</li> <li>Click \"Save\"</li> </ol> <pre><code>curl -X PUT \"http://localhost:8080/admin/realms/secure-test/users/$USER_ID/reset-password\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"type\": \"password\",\n    \"value\": \"newpassword123\",\n    \"temporary\": false\n  }'\n</code></pre>"},{"location":"keycloak/user-management/#disable-user","title":"Disable User","text":"Admin ConsoleREST API <ol> <li>Go to \"Users\" \u2192 Select user</li> <li>Toggle \"Enabled\" to OFF</li> <li>Click \"Save\"</li> </ol> <pre><code>curl -X PUT \"http://localhost:8080/admin/realms/secure-test/users/$USER_ID\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"enabled\": false\n  }'\n</code></pre>"},{"location":"keycloak/user-management/#delete-user","title":"Delete User","text":"Admin ConsoleREST API <ol> <li>Go to \"Users\" \u2192 Select user</li> <li>Click \"Delete\"</li> <li>Confirm deletion</li> </ol> <pre><code>curl -X DELETE \"http://localhost:8080/admin/realms/secure-test/users/$USER_ID\" \\\n  -H \"Authorization: Bearer $TOKEN\"\n</code></pre>"},{"location":"keycloak/user-management/#user-attributes","title":"User Attributes","text":""},{"location":"keycloak/user-management/#add-custom-attributes","title":"Add Custom Attributes","text":"<p>You can add custom attributes to users:</p> Admin ConsoleREST API <ol> <li>Go to \"Users\" \u2192 Select user</li> <li>Go to \"Attributes\" tab</li> <li>Click \"Add attribute\"</li> <li>Enter key and value</li> <li>Click \"Save\"</li> </ol> <pre><code>curl -X PUT \"http://localhost:8080/admin/realms/secure-test/users/$USER_ID\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"attributes\": {\n      \"department\": [\"Engineering\"],\n      \"employee_id\": [\"EMP001\"]\n    }\n  }'\n</code></pre>"},{"location":"keycloak/user-management/#groups-optional","title":"Groups (Optional)","text":""},{"location":"keycloak/user-management/#create-group","title":"Create Group","text":"<ol> <li>Go to \"Groups\"</li> <li>Click \"Create group\"</li> <li>Enter:</li> <li>Name: <code>api-users</code></li> <li>Click \"Create\"</li> </ol>"},{"location":"keycloak/user-management/#assign-users-to-group","title":"Assign Users to Group","text":"<ol> <li>Go to \"Users\" \u2192 Select user</li> <li>Go to \"Groups\" tab</li> <li>Click \"Join group\"</li> <li>Select \"api-users\"</li> <li>Click \"Join\"</li> </ol>"},{"location":"keycloak/user-management/#assign-role-to-group","title":"Assign Role to Group","text":"<ol> <li>Go to \"Groups\" \u2192 Select \"api-users\"</li> <li>Go to \"Role mapping\" tab</li> <li>Assign \"schedule-user\" role</li> </ol> <p>Now all users in the group automatically get the role.</p>"},{"location":"keycloak/user-management/#testing-with-api","title":"Testing with API","text":""},{"location":"keycloak/user-management/#get-token-for-testuser1","title":"Get Token for testuser1","text":"<pre><code>TOKEN1=$(curl -X POST http://localhost:8080/realms/secure-test/protocol/openid-connect/token \\\n  -H \"Content-Type: application/x-www-form-urlencoded\" \\\n  -d \"client_id=authentication-test-api\" \\\n  -d \"client_secret=YOUR_CLIENT_SECRET\" \\\n  -d \"grant_type=password\" \\\n  -d \"username=testuser1\" \\\n  -d \"password=password123\" \\\n  | jq -r '.access_token')\n</code></pre>"},{"location":"keycloak/user-management/#call-api","title":"Call API","text":"<pre><code>curl http://localhost:9080/api/v1/schedule \\\n  -H \"Authorization: Bearer $TOKEN1\" \\\n  | jq\n</code></pre> <p>Expected response:</p> <pre><code>{\n  \"user\": \"testuser1\",\n  \"schedule\": [\n    {\n      \"date\": \"2026-01-28\",\n      \"time\": \"09:00\",\n      \"description\": \"Team standup meeting\"\n    }\n  ]\n}\n</code></pre>"},{"location":"keycloak/user-management/#test-with-testuser2","title":"Test with testuser2","text":"<pre><code>TOKEN2=$(curl -X POST http://localhost:8080/realms/secure-test/protocol/openid-connect/token \\\n  -H \"Content-Type: application/x-www-form-urlencoded\" \\\n  -d \"client_id=authentication-test-api\" \\\n  -d \"client_secret=YOUR_CLIENT_SECRET\" \\\n  -d \"grant_type=password\" \\\n  -d \"username=testuser2\" \\\n  -d \"password=password123\" \\\n  | jq -r '.access_token')\n\ncurl http://localhost:9080/api/v1/schedule \\\n  -H \"Authorization: Bearer $TOKEN2\" \\\n  | jq\n</code></pre> <p>Each user should see their own schedule.</p>"},{"location":"keycloak/user-management/#bulk-user-creation","title":"Bulk User Creation","text":""},{"location":"keycloak/user-management/#using-script","title":"Using Script","text":"<p>Create multiple users with a script:</p> <pre><code>#!/bin/bash\n\n# Get admin token\nTOKEN=$(curl -s -X POST http://localhost:8080/realms/master/protocol/openid-connect/token \\\n  -H \"Content-Type: application/x-www-form-urlencoded\" \\\n  -d \"username=admin\" \\\n  -d \"password=admin\" \\\n  -d \"grant_type=password\" \\\n  -d \"client_id=admin-cli\" \\\n  | jq -r '.access_token')\n\n# Get role ID\nROLE_ID=$(curl -s -X GET http://localhost:8080/admin/realms/secure-test/roles/schedule-user \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  | jq -r '.id')\n\n# Create users\nfor i in {3..10}; do\n  echo \"Creating testuser$i...\"\n\n  # Create user\n  curl -s -X POST http://localhost:8080/admin/realms/secure-test/users \\\n    -H \"Authorization: Bearer $TOKEN\" \\\n    -H \"Content-Type: application/json\" \\\n    -d \"{\n      \\\"username\\\": \\\"testuser$i\\\",\n      \\\"email\\\": \\\"testuser$i@example.com\\\",\n      \\\"emailVerified\\\": true,\n      \\\"firstName\\\": \\\"Test\\\",\n      \\\"lastName\\\": \\\"User $i\\\",\n      \\\"enabled\\\": true,\n      \\\"credentials\\\": [{\n        \\\"type\\\": \\\"password\\\",\n        \\\"value\\\": \\\"password123\\\",\n        \\\"temporary\\\": false\n      }]\n    }\"\n\n  # Get user ID\n  USER_ID=$(curl -s -X GET \"http://localhost:8080/admin/realms/secure-test/users?username=testuser$i\" \\\n    -H \"Authorization: Bearer $TOKEN\" \\\n    | jq -r '.[0].id')\n\n  # Assign role\n  curl -s -X POST \"http://localhost:8080/admin/realms/secure-test/users/$USER_ID/role-mappings/realm\" \\\n    -H \"Authorization: Bearer $TOKEN\" \\\n    -H \"Content-Type: application/json\" \\\n    -d \"[{\n      \\\"id\\\": \\\"$ROLE_ID\\\",\n      \\\"name\\\": \\\"schedule-user\\\"\n    }]\"\n\n  echo \"Created testuser$i\"\ndone\n\necho \"Done!\"\n</code></pre>"},{"location":"keycloak/user-management/#troubleshooting","title":"Troubleshooting","text":""},{"location":"keycloak/user-management/#user-cant-login","title":"User Can't Login","text":"<ol> <li>Check user is enabled</li> <li>Verify password is correct</li> <li>Check user has required role</li> <li>Verify client configuration</li> </ol>"},{"location":"keycloak/user-management/#token-missing-username","title":"Token Missing Username","text":"<p>Ensure <code>preferred_username</code> mapper is enabled:</p> <ol> <li>Go to \"Client scopes\" \u2192 \"profile\"</li> <li>Go to \"Mappers\" tab</li> <li>Verify \"username\" mapper exists</li> </ol>"},{"location":"keycloak/user-management/#role-not-in-token","title":"Role Not in Token","text":"<ol> <li>Verify user has the role assigned</li> <li>Check role mapper configuration in client</li> <li>Ensure mapper adds role to access token</li> </ol>"},{"location":"keycloak/user-management/#next-steps","title":"Next Steps","text":"<ul> <li>API Authentication - Use tokens with the API</li> <li>API Endpoints - Test all API endpoints</li> <li>Troubleshooting - Common issues</li> </ul>"},{"location":"keycloak/user-management/#additional-resources","title":"Additional Resources","text":"<ul> <li>Keycloak User Management</li> <li>Keycloak REST API</li> </ul>"},{"location":"orchestrate/installation/","title":"watsonx Orchestrate Developer Edition Setup","text":"<p>This guide explains how to set up the IBM watsonx Orchestrate Developer Edition for local development and testing.</p>"},{"location":"orchestrate/installation/#what-is-watsonx-orchestrate","title":"What is watsonx Orchestrate?","text":"<p>IBM watsonx Orchestrate is an AI-powered automation platform that enables you to:</p> <ul> <li>Build and deploy AI agents</li> <li>Create custom tools and skills</li> <li>Orchestrate complex workflows</li> <li>Integrate with external APIs and services</li> </ul>"},{"location":"orchestrate/installation/#prerequisites","title":"Prerequisites","text":"<ul> <li>Operating System: macOS, Windows, or Linux</li> <li>Python: 3.8 or higher</li> <li>Package Manager:</li> <li>Homebrew (macOS)</li> <li>Chocolatey or Scoop (Windows)</li> <li>apt/yum (Linux)</li> <li>IBM Cloud account with watsonx access</li> <li>watsonx Orchestrate entitlement key</li> </ul>"},{"location":"orchestrate/installation/#installation-options","title":"Installation Options","text":"macOS (Lima)Windows (WSL2)Windows (Docker Desktop)Docker (All Platforms)Native Linux <p>Lima provides a lightweight VM environment for running watsonx Orchestrate on macOS.</p> <p>Step 1: Install Lima</p> <pre><code># Install Lima using Homebrew\nbrew install lima\n</code></pre> <p>Step 2: Verify Installation</p> <pre><code># Check Lima version\nlima --version\n</code></pre> <p>Windows Subsystem for Linux 2 (WSL2) provides a Linux environment on Windows.</p> <p>Step 1: Install WSL2</p> <p>Open PowerShell as Administrator:</p> <pre><code># Install WSL2\nwsl --install\n</code></pre> <p>Step 2: Install Ubuntu</p> <pre><code># Install Ubuntu distribution\nwsl --install -d Ubuntu\n</code></pre> <p>Step 3: Set WSL2 as Default</p> <pre><code>wsl --set-default-version 2\n</code></pre> <p>Step 4: Launch Ubuntu</p> <pre><code># Start Ubuntu\nwsl\n</code></pre> <p>Continue with the Linux setup instructions within WSL2.</p> <p>Docker Desktop provides container support on Windows.</p> <p>Step 1: Install Docker Desktop</p> <ol> <li>Download Docker Desktop for Windows</li> <li>Run the installer</li> <li>Enable WSL2 backend during installation</li> <li>Restart your computer</li> </ol> <p>Step 2: Verify Installation</p> <pre><code># Check Docker version\ndocker --version\n</code></pre> <p>For Docker-based installation on any platform, refer to the official watsonx Orchestrate documentation.</p> <p>For native Linux installation, refer to the official watsonx Orchestrate documentation.</p>"},{"location":"orchestrate/installation/#configuration","title":"Configuration","text":""},{"location":"orchestrate/installation/#step-1-create-project-directory","title":"Step 1: Create Project Directory","text":"<p>Navigate to the orchestrate directory in your project:</p> <pre><code>cd orchestrate\n</code></pre>"},{"location":"orchestrate/installation/#step-2-set-up-python-environment","title":"Step 2: Set Up Python Environment","text":"<p>Create and activate a virtual environment:</p> macOS/LinuxWindows (PowerShell)Windows (Command Prompt) <pre><code># Create virtual environment\npython3 -m venv .venv\n\n# Activate virtual environment\nsource .venv/bin/activate\n</code></pre> <pre><code># Create virtual environment\npython -m venv .venv\n\n# Activate virtual environment\n.\\.venv\\Scripts\\Activate.ps1\n</code></pre> <pre><code># Create virtual environment\npython -m venv .venv\n\n# Activate virtual environment\n.venv\\Scripts\\activate.bat\n</code></pre>"},{"location":"orchestrate/installation/#step-3-install-dependencies","title":"Step 3: Install Dependencies","text":"<p>Install the required Python packages:</p> <pre><code>pip install -r requirements.txt\n</code></pre> <p>The <code>requirements.txt</code> includes:</p> <pre><code>ibm-watsonx-orchestrate==2.2.0\n</code></pre>"},{"location":"orchestrate/installation/#step-4-configure-environment-variables","title":"Step 4: Configure Environment Variables","text":"<p>Create or update the <code>.env</code> file with your credentials:</p> macOS/LinuxWindows (PowerShell)Windows (Command Prompt) <p>Create <code>.env</code> file:</p> <pre><code>cat &gt; .env &lt;&lt; EOF\n# watsonx API Configuration\nWATSONX_APIKEY=your_watsonx_api_key_here\nWATSONX_SPACE_ID=your_space_id_here\n\n# watsonx Orchestrate Configuration\nWO_ENTITLEMENT_KEY=your_entitlement_key_here\nWO_DEVELOPER_EDITION_SOURCE=myibm\nEOF\n</code></pre> <p>Create <code>.env</code> file:</p> <pre><code>@\"\n# watsonx API Configuration\nWATSONX_APIKEY=your_watsonx_api_key_here\nWATSONX_SPACE_ID=your_space_id_here\n\n# watsonx Orchestrate Configuration\nWO_ENTITLEMENT_KEY=your_entitlement_key_here\nWO_DEVELOPER_EDITION_SOURCE=myibm\n\"@ | Out-File -FilePath .env -Encoding UTF8\n</code></pre> <p>Create <code>.env</code> file manually using Notepad:</p> <pre><code>notepad .env\n</code></pre> <p>Add the following content:</p> <pre><code># watsonx API Configuration\nWATSONX_APIKEY=your_watsonx_api_key_here\nWATSONX_SPACE_ID=your_space_id_here\n\n# watsonx Orchestrate Configuration\nWO_ENTITLEMENT_KEY=your_entitlement_key_here\nWO_DEVELOPER_EDITION_SOURCE=myibm\n</code></pre> <p>Security</p> <p>Never commit the <code>.env</code> file to version control. It contains sensitive credentials.</p>"},{"location":"orchestrate/installation/#getting-your-credentials","title":"Getting Your Credentials","text":"<p>watsonx API Key:</p> <ol> <li>Log in to IBM Cloud</li> <li>Navigate to \"Manage\" \u2192 \"Access (IAM)\"</li> <li>Select \"API keys\"</li> <li>Click \"Create an IBM Cloud API key\"</li> <li>Copy the API key</li> </ol> <p>watsonx Space ID:</p> <ol> <li>Log in to watsonx.ai</li> <li>Navigate to your deployment space</li> <li>Copy the Space ID from the URL or space settings</li> </ol> <p>Orchestrate Entitlement Key:</p> <ol> <li>Log in to IBM Marketplace</li> <li>Navigate to your watsonx Orchestrate entitlement</li> <li>Copy the entitlement key</li> </ol>"},{"location":"orchestrate/installation/#step-5-verify-configuration","title":"Step 5: Verify Configuration","text":"<p>Check that your environment is properly configured:</p> macOS/LinuxWindows (PowerShell)Windows (Command Prompt) <pre><code># Load environment variables\nsource .env\n\n# Verify variables are set\necho $WATSONX_APIKEY\necho $WATSONX_SPACE_ID\necho $WO_ENTITLEMENT_KEY\n</code></pre> <pre><code># Load environment variables\nGet-Content .env | ForEach-Object {\n    if ($_ -match '^([^=]+)=(.*)$') {\n        [Environment]::SetEnvironmentVariable($matches[1], $matches[2], 'Process')\n    }\n}\n\n# Verify variables are set\n$env:WATSONX_APIKEY\n$env:WATSONX_SPACE_ID\n$env:WO_ENTITLEMENT_KEY\n</code></pre> <pre><code># Load environment variables from .env file\nfor /f \"tokens=1,2 delims==\" %%a in (.env) do set %%a=%%b\n\n# Verify variables are set\necho %WATSONX_APIKEY%\necho %WATSONX_SPACE_ID%\necho %WO_ENTITLEMENT_KEY%\n</code></pre>"},{"location":"orchestrate/installation/#starting-watsonx-orchestrate","title":"Starting watsonx Orchestrate","text":""},{"location":"orchestrate/installation/#start-the-server","title":"Start the Server","text":"<p>Start the watsonx Orchestrate Developer Edition server:</p> macOS/LinuxWindows (PowerShell)Windows (Command Prompt) <pre><code># Ensure you're in the orchestrate directory\ncd orchestrate\n\n# Activate virtual environment\nsource .venv/bin/activate\n\n# Start watsonx Orchestrate server\norchestrate server start -e .env\n</code></pre> <pre><code># Ensure you're in the orchestrate directory\ncd orchestrate\n\n# Activate virtual environment\n.\\.venv\\Scripts\\Activate.ps1\n\n# Start watsonx Orchestrate server\norchestrate server start -e .env\n</code></pre> <pre><code># Ensure you're in the orchestrate directory\ncd orchestrate\n\n# Activate virtual environment\n.venv\\Scripts\\activate.bat\n\n# Start watsonx Orchestrate server\norchestrate server start -e .env\n</code></pre>"},{"location":"orchestrate/installation/#optional-features","title":"Optional Features","text":"<p>Enable additional features when starting the server:</p> <pre><code># Enable Langfuse for observability\norchestrate server start -e .env --with-langfuse\n\n# Enable document processing\norchestrate server start -e .env --with-doc-processing\n\n# Enable AI Builder\norchestrate server start -e .env --with-ai-builder\n\n# Enable voice support\norchestrate server start -e .env --with-voice\n\n# Enable multiple features\norchestrate server start -e .env --with-langfuse --with-ai-builder --with-doc-processing\n</code></pre>"},{"location":"orchestrate/installation/#access-the-services","title":"Access the Services","text":"<p>Once started, the following services are available:</p> <ul> <li>API Base URL: <code>http://localhost:4321/api/v1</code></li> <li>OpenAPI Docs: <code>http://localhost:4321/docs</code></li> <li>UI: <code>http://localhost:3000</code> (requires separate start command)</li> </ul>"},{"location":"orchestrate/installation/#start-the-ui","title":"Start the UI","text":"<p>The UI is not started automatically. To start it:</p> <pre><code>orchestrate chat start\n</code></pre>"},{"location":"orchestrate/installation/#managing-the-server","title":"Managing the Server","text":""},{"location":"orchestrate/installation/#stop-the-server","title":"Stop the Server","text":"<pre><code>orchestrate server stop\n</code></pre>"},{"location":"orchestrate/installation/#reset-the-server","title":"Reset the Server","text":"<p>Reset the environment (removes containers and clears data):</p> <pre><code>orchestrate server reset\n</code></pre>"},{"location":"orchestrate/installation/#view-logs","title":"View Logs","text":"<pre><code>orchestrate server logs\n</code></pre>"},{"location":"orchestrate/installation/#check-server-status","title":"Check Server Status","text":"<pre><code>orchestrate server status\n</code></pre>"},{"location":"orchestrate/installation/#project-structure","title":"Project Structure","text":"<pre><code>orchestrate/\n\u251c\u2500\u2500 .env                 # Environment variables (not in git)\n\u251c\u2500\u2500 .venv/              # Python virtual environment\n\u2514\u2500\u2500 requirements.txt    # Python dependencies\n</code></pre>"},{"location":"orchestrate/installation/#troubleshooting","title":"Troubleshooting","text":""},{"location":"orchestrate/installation/#port-already-in-use","title":"Port Already in Use","text":"<p>If port 8080 is already in use:</p> <pre><code># Find process using port 8080\nlsof -i :8080\n\n# Kill the process\nkill -9 &lt;PID&gt;\n</code></pre>"},{"location":"orchestrate/installation/#environment-variables-not-loading","title":"Environment Variables Not Loading","text":"<p>Ensure you're loading the <code>.env</code> file correctly:</p> macOS/LinuxWindows (PowerShell)Windows (Command Prompt) <pre><code># Load environment variables\nset -a\nsource .env\nset +a\n</code></pre> <pre><code># Load environment variables\nGet-Content .env | ForEach-Object {\n    if ($_ -match '^([^=]+)=(.*)$') {\n        [Environment]::SetEnvironmentVariable($matches[1], $matches[2], 'Process')\n    }\n}\n</code></pre> <pre><code># Load environment variables\nfor /f \"tokens=1,2 delims==\" %%a in (.env) do set %%a=%%b\n</code></pre>"},{"location":"orchestrate/installation/#lima-vm-issues","title":"Lima VM Issues","text":"<p>If using Lima and experiencing issues:</p> <pre><code># Stop Lima VM\nlimactl stop default\n\n# Start Lima VM\nlimactl start default\n\n# Check Lima status\nlimactl list\n</code></pre>"},{"location":"orchestrate/installation/#python-package-issues","title":"Python Package Issues","text":"<p>If you encounter package installation issues:</p> <pre><code># Upgrade pip\npip install --upgrade pip\n\n# Reinstall requirements\npip install --force-reinstall -r requirements.txt\n</code></pre>"},{"location":"orchestrate/installation/#next-steps","title":"Next Steps","text":"<ul> <li>Creating Agents - Build your first AI agent</li> <li>Adding Tools - Extend functionality with custom tools</li> <li>API Integration - Connect to external APIs</li> </ul>"},{"location":"orchestrate/installation/#additional-resources","title":"Additional Resources","text":"<ul> <li>watsonx Orchestrate Documentation</li> <li>watsonx Orchestrate Developer Guide</li> <li>IBM watsonx Platform</li> </ul>"},{"location":"troubleshooting/common-issues/","title":"Common Issues","text":"<p>Solutions to frequently encountered problems.</p>"},{"location":"troubleshooting/common-issues/#authentication-issues","title":"Authentication Issues","text":""},{"location":"troubleshooting/common-issues/#401-unauthorized-error","title":"401 Unauthorized Error","text":"<p>Problem: API returns 401 when calling <code>/schedule</code></p> <p>Solutions: 1. Verify JWT token is valid and not expired 2. Check token is sent in <code>Authorization: Bearer &lt;token&gt;</code> header 3. Ensure Keycloak JWKS URI is accessible from API server</p>"},{"location":"troubleshooting/common-issues/#403-forbidden-error","title":"403 Forbidden Error","text":"<p>Problem: Valid token but access denied</p> <p>Solutions: 1. Verify user has <code>schedule-user</code> role in Keycloak 2. Check role mapping in client configuration 3. Ensure role appears in JWT token claims</p>"},{"location":"troubleshooting/common-issues/#connection-issues","title":"Connection Issues","text":""},{"location":"troubleshooting/common-issues/#cant-connect-to-keycloak","title":"Can't Connect to Keycloak","text":"<p>Solutions: 1. Verify Keycloak is running: <code>curl http://localhost:8080</code> 2. Check network connectivity 3. Verify firewall settings 4. Check JWT_JWKS_URI environment variable</p>"},{"location":"troubleshooting/common-issues/#port-already-in-use","title":"Port Already in Use","text":"<p>Problem: Can't start server on port 9080</p> <p>Solutions: <pre><code># Find process using port\nlsof -i :9080\n\n# Kill process or change port in server.xml\n</code></pre></p>"},{"location":"troubleshooting/common-issues/#build-issues","title":"Build Issues","text":""},{"location":"troubleshooting/common-issues/#maven-build-fails","title":"Maven Build Fails","text":"<p>Solutions: <pre><code># Clean and rebuild\nmvn clean install -U\n\n# Clear local repository\nrm -rf ~/.m2/repository/com/example\nmvn clean install\n</code></pre></p>"},{"location":"troubleshooting/common-issues/#container-issues","title":"Container Issues","text":""},{"location":"troubleshooting/common-issues/#container-wont-start","title":"Container Won't Start","text":"<p>Solutions: <pre><code># Check logs\npodman logs auth-api\n\n# Verify image exists\npodman images | grep authentication-test-api\n</code></pre></p>"},{"location":"troubleshooting/common-issues/#next-steps","title":"Next Steps","text":"<ul> <li>Debugging Guide</li> <li>API Endpoints</li> </ul>"},{"location":"troubleshooting/debugging/","title":"Debugging Guide","text":"<p>Tips and techniques for debugging the Authentication Test API.</p>"},{"location":"troubleshooting/debugging/#enable-debug-logging","title":"Enable Debug Logging","text":"<p>Set log level to DEBUG:</p> <pre><code>export LOG_LEVEL=DEBUG\nmvn liberty:dev\n</code></pre>"},{"location":"troubleshooting/debugging/#debug-with-ide","title":"Debug with IDE","text":""},{"location":"troubleshooting/debugging/#intellij-idea-vs-code","title":"IntelliJ IDEA / VS Code","text":"<ol> <li>Start server in debug mode: <code>mvn liberty:dev</code></li> <li>Attach debugger to port 7777</li> <li>Set breakpoints in code</li> <li>Make API request to trigger breakpoint</li> </ol>"},{"location":"troubleshooting/debugging/#view-logs","title":"View Logs","text":""},{"location":"troubleshooting/debugging/#development-mode","title":"Development Mode","text":"<p>Logs appear in console when running <code>mvn liberty:dev</code></p>"},{"location":"troubleshooting/debugging/#container-logs","title":"Container Logs","text":"<pre><code>podman logs -f auth-api\n</code></pre>"},{"location":"troubleshooting/debugging/#decode-jwt-token","title":"Decode JWT Token","text":"<pre><code># Extract and decode token payload\necho \"YOUR_TOKEN\" | cut -d'.' -f2 | base64 -d | jq\n</code></pre>"},{"location":"troubleshooting/debugging/#test-keycloak-connectivity","title":"Test Keycloak Connectivity","text":"<pre><code># Test JWKS endpoint\ncurl https://keycloak.lab.home/realms/secure-test/protocol/openid-connect/certs | jq\n</code></pre>"},{"location":"troubleshooting/debugging/#next-steps","title":"Next Steps","text":"<ul> <li>Common Issues</li> <li>API Endpoints</li> </ul>"}]}